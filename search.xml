<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[react-navigation ä½¿ç”¨è¯¦è§£]]></title>
    <url>%2F2018%2F04%2F12%2Freact-navigation-detail%2F</url>
    <content type="text"><![CDATA[è½¬è‡ª: è¿™é‡Œ ä¸€ã€å¼€æºåº“ä»‹ç»ä»Šå¹´1æœˆä»½ï¼Œæ–°å¼€æºçš„react-natvigationåº“å¤‡å—çž©ç›®ã€‚åœ¨çŸ­çŸ­ä¸åˆ°3ä¸ªæœˆçš„æ—¶é—´ï¼Œgithubä¸Šæ˜Ÿæ•°å·²è¾¾4000+ã€‚FbæŽ¨èä½¿ç”¨åº“ï¼Œå¹¶ä¸”åœ¨React Nativeå½“å‰æœ€æ–°ç‰ˆæœ¬0.44ä¸­å°†Navigatoråˆ é™¤ã€‚react-navigationæ®ç§°æœ‰åŽŸç”Ÿèˆ¬çš„æ€§èƒ½ä½“éªŒæ•ˆæžœã€‚ å¯èƒ½ä¼šæˆä¸ºæœªæ¥React Nativeå¯¼èˆªç»„ä»¶çš„ä¸»æµå†›ã€‚æœ¬ç¯‡å†…å®¹åŸºäºŽã€ ^1.0.0-beta.9 ã€‘ç‰ˆæœ¬æ¥ä»‹ç»å…³äºŽè¯¥åº“çš„ä½¿ç”¨å’Œå®žæˆ˜æŠ€å·§ã€‚å¯ä»¥çœ‹åˆ°ï¼Œè™½ç„¶æ˜¯betaç‰ˆæœ¬ï¼Œä¸è¿‡åŸºæœ¬ç¨³å®šï¼Œå¤§å®¶å¯æ”¾å¿ƒåœ¨é¡¹ç›®ä¸­ä½¿ç”¨ã€‚ è¯¥åº“åŒ…å«ä¸‰ç±»ç»„ä»¶ï¼š ï¼ˆ1ï¼‰StackNavigatorï¼šç”¨æ¥è·³è½¬é¡µé¢å’Œä¼ é€’å‚æ•°ï¼ˆ2ï¼‰TabNavigatorï¼šç±»ä¼¼åº•éƒ¨å¯¼èˆªæ ï¼Œç”¨æ¥åœ¨åŒä¸€å±å¹•ä¸‹åˆ‡æ¢ä¸åŒç•Œé¢ï¼ˆ3ï¼‰DrawerNavigatorï¼šä¾§æ»‘èœå•å¯¼èˆªæ ï¼Œç”¨äºŽè½»æ¾è®¾ç½®å¸¦æŠ½å±‰å¯¼èˆªçš„å±å¹• äºŒã€react-navigationä½¿ç”¨å…·ä½“å†…å®¹å¤§è‡´åˆ†ä¸ºå¦‚ä¸‹ï¼š ï¼ˆ1ï¼‰react-navigationåº“å±žæ€§ä»‹ç» ï¼ˆ2ï¼‰StackNavigatorã€TabNavigatorå®žçŽ°ç•Œé¢é—´è·³è½¬ï¼ŒTabåˆ‡æ¢ ï¼ˆ3ï¼‰StackNavigatorç•Œé¢é—´è·³è½¬ã€ä¼ å€¼ã€å–å€¼ ï¼ˆ4ï¼‰DrawerNavigatorå®žçŽ°æŠ½å±‰å¯¼èˆªèœå• ï¼ˆ5ï¼‰DrawerNavigatoræ‰©å±•åŠŸèƒ½ 1ã€StackNavigatorå±žæ€§ä»‹ç» navigationOptionsï¼šé…ç½®StackNavigatorçš„ä¸€äº›å±žæ€§ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344titleï¼šæ ‡é¢˜ï¼Œå¦‚æžœè®¾ç½®äº†è¿™ä¸ªå¯¼èˆªæ å’Œæ ‡ç­¾æ çš„titleå°±ä¼šå˜æˆä¸€æ ·çš„ï¼Œä¸æŽ¨èä½¿ç”¨ headerï¼šå¯ä»¥è®¾ç½®ä¸€äº›å¯¼èˆªçš„å±žæ€§ï¼Œå¦‚æžœéšè—é¡¶éƒ¨å¯¼èˆªæ åªè¦å°†è¿™ä¸ªå±žæ€§è®¾ç½®ä¸ºnull headerTitleï¼šè®¾ç½®å¯¼èˆªæ æ ‡é¢˜ï¼ŒæŽ¨è headerBackTitleï¼šè®¾ç½®è·³è½¬é¡µé¢å·¦ä¾§è¿”å›žç®­å¤´åŽé¢çš„æ–‡å­—ï¼Œé»˜è®¤æ˜¯ä¸Šä¸€ä¸ªé¡µé¢çš„æ ‡é¢˜ã€‚å¯ä»¥è‡ªå®šä¹‰ï¼Œä¹Ÿå¯ä»¥è®¾ç½®ä¸ºnull headerTruncatedBackTitleï¼šè®¾ç½®å½“ä¸Šä¸ªé¡µé¢æ ‡é¢˜ä¸ç¬¦åˆè¿”å›žç®­å¤´åŽçš„æ–‡å­—æ—¶ï¼Œé»˜è®¤æ”¹æˆ&quot;è¿”å›ž&quot; headerRightï¼šè®¾ç½®å¯¼èˆªæ¡å³ä¾§ã€‚å¯ä»¥æ˜¯æŒ‰é’®æˆ–è€…å…¶ä»–è§†å›¾æŽ§ä»¶ headerLeftï¼šè®¾ç½®å¯¼èˆªæ¡å·¦ä¾§ã€‚å¯ä»¥æ˜¯æŒ‰é’®æˆ–è€…å…¶ä»–è§†å›¾æŽ§ä»¶ headerStyleï¼šè®¾ç½®å¯¼èˆªæ¡çš„æ ·å¼ã€‚èƒŒæ™¯è‰²ï¼Œå®½é«˜ç­‰ headerTitleStyleï¼šè®¾ç½®å¯¼èˆªæ æ–‡å­—æ ·å¼ headerBackTitleStyleï¼šè®¾ç½®å¯¼èˆªæ â€˜è¿”å›žâ€™æ–‡å­—æ ·å¼ headerTintColorï¼šè®¾ç½®å¯¼èˆªæ é¢œè‰² headerPressColorAndroidï¼šå®‰å“ç‹¬æœ‰çš„è®¾ç½®é¢œè‰²çº¹ç†ï¼Œéœ€è¦å®‰å“ç‰ˆæœ¬å¤§äºŽ5.0 gesturesEnabledï¼šæ˜¯å¦æ”¯æŒæ»‘åŠ¨è¿”å›žæ‰‹åŠ¿ï¼ŒiOSé»˜è®¤æ”¯æŒï¼Œå®‰å“é»˜è®¤å…³é—­ screenï¼šå¯¹åº”ç•Œé¢åç§°ï¼Œéœ€è¦å¡«å…¥importä¹‹åŽçš„é¡µé¢ modeï¼šå®šä¹‰è·³è½¬é£Žæ ¼ cardï¼šä½¿ç”¨iOSå’Œå®‰å“é»˜è®¤çš„é£Žæ ¼ modalï¼šiOSç‹¬æœ‰çš„ä½¿å±å¹•ä»Žåº•éƒ¨ç”»å‡ºã€‚ç±»ä¼¼iOSçš„presentæ•ˆæžœ headerModeï¼šè¿”å›žä¸Šçº§é¡µé¢æ—¶åŠ¨ç”»æ•ˆæžœ floatï¼šiOSé»˜è®¤çš„æ•ˆæžœ screenï¼šæ»‘åŠ¨è¿‡ç¨‹ä¸­ï¼Œæ•´ä¸ªé¡µé¢éƒ½ä¼šè¿”å›ž noneï¼šæ— åŠ¨ç”» cardStyleï¼šè‡ªå®šä¹‰è®¾ç½®è·³è½¬æ•ˆæžœ transitionConfigï¼š è‡ªå®šä¹‰è®¾ç½®æ»‘åŠ¨è¿”å›žçš„é…ç½® onTransitionStartï¼šå½“è½¬æ¢åŠ¨ç”»å³å°†å¼€å§‹æ—¶è¢«è°ƒç”¨çš„åŠŸèƒ½ onTransitionEndï¼šå½“è½¬æ¢åŠ¨ç”»å®Œæˆï¼Œå°†è¢«è°ƒç”¨çš„åŠŸèƒ½ pathï¼šè·¯ç”±ä¸­è®¾ç½®çš„è·¯å¾„çš„è¦†ç›–æ˜ å°„é…ç½® initialRouteNameï¼šè®¾ç½®é»˜è®¤çš„é¡µé¢ç»„ä»¶ï¼Œå¿…é¡»æ˜¯ä¸Šé¢å·²æ³¨å†Œçš„é¡µé¢ç»„ä»¶ initialRouteParamsï¼šåˆå§‹è·¯ç”±å‚æ•° æ³¨ï¼šå¤§å®¶å¯èƒ½å¯¹äºŽpathä¸å¤ªç†è§£ã€‚pathå±žæ€§é€‚ç”¨äºŽå…¶ä»–appæˆ–æµè§ˆå™¨ä½¿ç”¨urlæ‰“å¼€æœ¬appå¹¶è¿›å…¥æŒ‡å®šé¡µé¢ã€‚pathå±žæ€§ç”¨äºŽå£°æ˜Žä¸€ä¸ªç•Œé¢è·¯å¾„ï¼Œä¾‹å¦‚ï¼šã€/pages/Homeã€‘ã€‚æ­¤æ—¶æˆ‘ä»¬å¯ä»¥åœ¨æ‰‹æœºæµè§ˆå™¨ä¸­è¾“å…¥ï¼šappåç§°://pages/Homeæ¥å¯åŠ¨è¯¥Appï¼Œå¹¶è¿›å…¥Homeç•Œé¢ã€‚ 2ã€TabNavigatorå±žæ€§ä»‹ç» 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162screenï¼šå’Œå¯¼èˆªçš„åŠŸèƒ½æ˜¯ä¸€æ ·çš„ï¼Œå¯¹åº”ç•Œé¢åç§°ï¼Œå¯ä»¥åœ¨å…¶ä»–é¡µé¢é€šè¿‡è¿™ä¸ªscreenä¼ å€¼å’Œè·³è½¬ã€‚ navigationOptionsï¼šé…ç½®TabNavigatorçš„ä¸€äº›å±žæ€§ titleï¼šæ ‡é¢˜ï¼Œä¼šåŒæ—¶è®¾ç½®å¯¼èˆªæ¡å’Œæ ‡ç­¾æ çš„title tabBarVisibleï¼šæ˜¯å¦éšè—æ ‡ç­¾æ ã€‚é»˜è®¤ä¸éšè—(true) tabBarIconï¼šè®¾ç½®æ ‡ç­¾æ çš„å›¾æ ‡ã€‚éœ€è¦ç»™æ¯ä¸ªéƒ½è®¾ç½® tabBarLabelï¼šè®¾ç½®æ ‡ç­¾æ çš„titleã€‚æŽ¨è å¯¼èˆªæ é…ç½® tabBarPositionï¼šè®¾ç½®tabbarçš„ä½ç½®ï¼ŒiOSé»˜è®¤åœ¨åº•éƒ¨ï¼Œå®‰å“é»˜è®¤åœ¨é¡¶éƒ¨ã€‚ï¼ˆå±žæ€§å€¼ï¼š&apos;top&apos;ï¼Œ&apos;bottom&apos;ï¼‰ swipeEnabledï¼šæ˜¯å¦å…è®¸åœ¨æ ‡ç­¾ä¹‹é—´è¿›è¡Œæ»‘åŠ¨ animationEnabledï¼šæ˜¯å¦åœ¨æ›´æ”¹æ ‡ç­¾æ—¶æ˜¾ç¤ºåŠ¨ç”» lazyï¼šæ˜¯å¦æ ¹æ®éœ€è¦æ‡’æƒ°å‘ˆçŽ°æ ‡ç­¾ï¼Œè€Œä¸æ˜¯æå‰ï¼Œæ„æ€æ˜¯åœ¨appæ‰“å¼€çš„æ—¶å€™å°†åº•éƒ¨æ ‡ç­¾æ å…¨éƒ¨åŠ è½½ï¼Œé»˜è®¤false,æŽ¨èä¸ºtrue trueinitialRouteNameï¼š è®¾ç½®é»˜è®¤çš„é¡µé¢ç»„ä»¶ backBehaviorï¼šæŒ‰ back é”®æ˜¯å¦è·³è½¬åˆ°ç¬¬ä¸€ä¸ªTab(é¦–é¡µ)ï¼Œ none ä¸ºä¸è·³è½¬ tabBarOptionsï¼šé…ç½®æ ‡ç­¾æ çš„ä¸€äº›å±žæ€§iOSå±žæ€§ activeTintColorï¼šlabelå’Œiconçš„å‰æ™¯è‰² æ´»è·ƒçŠ¶æ€ä¸‹ activeBackgroundColorï¼šlabelå’Œiconçš„èƒŒæ™¯è‰² æ´»è·ƒçŠ¶æ€ä¸‹ inactiveTintColorï¼šlabelå’Œiconçš„å‰æ™¯è‰² ä¸æ´»è·ƒçŠ¶æ€ä¸‹ inactiveBackgroundColorï¼šlabelå’Œiconçš„èƒŒæ™¯è‰² ä¸æ´»è·ƒçŠ¶æ€ä¸‹ showLabelï¼šæ˜¯å¦æ˜¾ç¤ºlabelï¼Œé»˜è®¤å¼€å¯ styleï¼štabbarçš„æ ·å¼ labelStyleï¼šlabelçš„æ ·å¼å®‰å“å±žæ€§ activeTintColorï¼šlabelå’Œiconçš„å‰æ™¯è‰² æ´»è·ƒçŠ¶æ€ä¸‹ inactiveTintColorï¼šlabelå’Œiconçš„å‰æ™¯è‰² ä¸æ´»è·ƒçŠ¶æ€ä¸‹ showIconï¼šæ˜¯å¦æ˜¾ç¤ºå›¾æ ‡ï¼Œé»˜è®¤å…³é—­ showLabelï¼šæ˜¯å¦æ˜¾ç¤ºlabelï¼Œé»˜è®¤å¼€å¯ styleï¼štabbarçš„æ ·å¼ labelStyleï¼šlabelçš„æ ·å¼ upperCaseLabelï¼šæ˜¯å¦ä½¿æ ‡ç­¾å¤§å†™ï¼Œé»˜è®¤ä¸ºtrue pressColorï¼šmaterialæ¶Ÿæ¼ªæ•ˆæžœçš„é¢œè‰²ï¼ˆå®‰å“ç‰ˆæœ¬éœ€è¦å¤§äºŽ5.0ï¼‰ pressOpacityï¼šæŒ‰åŽ‹æ ‡ç­¾çš„é€æ˜Žåº¦å˜åŒ–ï¼ˆå®‰å“ç‰ˆæœ¬éœ€è¦å°äºŽ5.0ï¼‰ scrollEnabledï¼šæ˜¯å¦å¯ç”¨å¯æ»šåŠ¨é€‰é¡¹å¡ tabStyleï¼štabçš„æ ·å¼ indicatorStyleï¼šæ ‡ç­¾æŒ‡ç¤ºå™¨çš„æ ·å¼å¯¹è±¡ï¼ˆé€‰é¡¹å¡åº•éƒ¨çš„è¡Œï¼‰ã€‚å®‰å“åº•éƒ¨ä¼šå¤šå‡ºä¸€æ¡çº¿ï¼Œå¯ä»¥å°†heightè®¾ç½®ä¸º0æ¥æš‚æ—¶è§£å†³è¿™ä¸ªé—®é¢˜ labelStyleï¼šlabelçš„æ ·å¼ iconStyleï¼šå›¾æ ‡æ ·å¼ 3ã€DrawerNavigatorå±žæ€§ä»‹ç»123456789101112131415161718192021DrawerNavigatorConfig drawerWidth - æŠ½å±‰çš„å®½åº¦ drawerPosition - é€‰é¡¹æ˜¯å·¦æˆ–å³ã€‚ é»˜è®¤ä¸ºå·¦ä¾§ä½ç½® contentComponent - ç”¨äºŽå‘ˆçŽ°æŠ½å±‰å†…å®¹çš„ç»„ä»¶ï¼Œä¾‹å¦‚å¯¼èˆªé¡¹ã€‚ æŽ¥æ”¶æŠ½å±‰çš„å¯¼èˆªã€‚ é»˜è®¤ä¸ºDrawerItems contentOptions - é…ç½®æŠ½å±‰å†…å®¹ initialRouteName - åˆå§‹è·¯ç”±çš„routeName order - å®šä¹‰æŠ½å±‰é¡¹ç›®é¡ºåºçš„routeNamesæ•°ç»„ã€‚ è·¯å¾„ - æä¾›routeNameåˆ°è·¯å¾„é…ç½®çš„æ˜ å°„ï¼Œå®ƒè¦†ç›–routeConfigsä¸­è®¾ç½®çš„è·¯å¾„ã€‚ backBehavior - åŽé€€æŒ‰é’®æ˜¯å¦ä¼šåˆ‡æ¢åˆ°åˆå§‹è·¯ç”±ï¼Ÿ å¦‚æžœæ˜¯ï¼Œè®¾ç½®ä¸ºinitialRouteï¼Œå¦åˆ™ä¸ºnoneã€‚ é»˜è®¤ä¸ºinitialRouteè¡Œä¸º DrawerItemsçš„contentOptionså±žæ€§ activeTintColor - æ´»åŠ¨æ ‡ç­¾çš„æ ‡ç­¾å’Œå›¾æ ‡é¢œè‰² activeBackgroundColor - æ´»åŠ¨æ ‡ç­¾çš„èƒŒæ™¯é¢œè‰² inactiveTintColor - éžæ´»åŠ¨æ ‡ç­¾çš„æ ‡ç­¾å’Œå›¾æ ‡é¢œè‰² inactiveBackgroundColor - éžæ´»åŠ¨æ ‡ç­¾çš„èƒŒæ™¯é¢œè‰² å†…å®¹éƒ¨åˆ†çš„æ ·å¼æ ·å¼å¯¹è±¡ labelStyle - å½“æ‚¨çš„æ ‡ç­¾æ˜¯å­—ç¬¦ä¸²æ—¶ï¼Œè¦è¦†ç›–å†…å®¹éƒ¨åˆ†ä¸­çš„æ–‡æœ¬æ ·å¼çš„æ ·å¼å¯¹è±¡ä»Žä¸Šè¿°ä¸­å¤§è‡´äº†è§£äº†react-navigationä¸‰ç§ç»„ä»¶çš„ä¸€äº›åŸºæœ¬å±žæ€§ï¼Œæ‰€ä»¥åˆ°æˆ‘ä»¬ç”©èµ·è¢–å­æ’¸ä»£ç è§è¯ä¸‹å¥‡è¿¹äº†ã€‚4ã€ä½¿ç”¨StackNavigator + TabNavigatorå®žçŽ°Tabç•Œé¢åˆ‡æ¢ã€ç•Œé¢é—´å¯¼èˆª APIå®šä¹‰ï¼šStackNavigator(RouteConfigs, StackNavigatorConfig)ã€TabNavigator(RouteConfigs, TabNavigatorConfig) ï¼ˆ1ï¼‰é›†æˆ react-navigationï¼šåœ¨ç»ˆç«¯æ‰§è¡Œ ã€ npm install react-navigation â€“save ã€‘ ï¼ˆ2ï¼‰ç•Œé¢ä¸­å¯¼å…¥å¿…è¦ç»„ä»¶ï¼š 123import &#123;StackNavigator,TabNavigator,TabBarBottom&#125; from &apos;react-navigation&apos;; import HomeScreen from &apos;./pages/HomePage&apos;; import MineScreen from &apos;./pages/MinePage&apos;; ï¼ˆ3ï¼‰å®šä¹‰TabNavigatorï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051const Tab = TabNavigator( &#123; Home:&#123; screen:HomeScreen, navigationOptions:(&#123;navigation&#125;) =&gt; (&#123; tabBarLabel:'é¦–é¡µ', tabBarIcon:(&#123;focused,tintColor&#125;) =&gt; ( &lt;TabBarItem tintColor=&#123;tintColor&#125; focused=&#123;focused&#125; normalImage=&#123;require('./imgs/nav_fav@2x.png')&#125; selectedImage=&#123;require('./imgs/nav_fav_actived@3x.png')&#125; /&gt; ) &#125;), &#125;, Mine:&#123; screen:MineScreen, navigationOptions:(&#123;navigation&#125;) =&gt; (&#123; tabBarLabel:'æˆ‘', tabBarIcon:(&#123;focused,tintColor&#125;) =&gt; ( &lt;TabBarItem tintColor=&#123;tintColor&#125; focused=&#123;focused&#125; normalImage=&#123;require('./imgs/tab_me_nor@3x.png')&#125; selectedImage=&#123;require('./imgs/tab_me_selected@2x.png')&#125; /&gt; ) &#125;), &#125;, &#125;, &#123; tabBarComponent:TabBarBottom, tabBarPosition:'bottom', swipeEnabled:false, animationEnabled:false, lazy:true, tabBarOptions:&#123; activeTintColor:'#06c1ae', inactiveTintColor:'#979797', style:&#123;backgroundColor:'#ffffff',&#125;, labelStyle: &#123; fontSize: 20, // æ–‡å­—å¤§å° &#125;, &#125; &#125; ); TabBarItemä¸ºå°è£…çš„ç»„ä»¶ï¼š 1234567891011121314import React,&#123;Component&#125; from 'react'; import &#123;Image&#125; from 'react-native'; export default class TabBarItem extends Component &#123; render() &#123; return( &lt;Image source=&#123; this.props.focused ? this.props.selectedImage : this.props.normalImage &#125; style=&#123; &#123; tintColor:this.props.tintColor,width:25,height:25 &#125; &#125; /&gt; ) &#125; &#125; å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªåç§°ä¸ºã€Tabã€‘çš„TabNavigatorçš„å¯¼èˆªç»„ä»¶ã€‚åœ¨ç»„ä»¶ä¸­ï¼Œåˆ†ä¸ºä¸¤å±‚å‚æ•°ï¼š ï¼ˆ1ï¼‰ç¬¬ä¸€å±‚å‚æ•°å®šä¹‰äº†è¦åˆ‡æ¢çš„ç•Œé¢ï¼Œå³ã€é¦–é¡µã€‘ã€ã€æˆ‘ã€‘ä¸¤ä¸ªç•Œé¢ç»„ä»¶ï¼Œé€šè¿‡screenå±žæ€§æŒ‡å®šã€‚å¹¶ä¸”é€šè¿‡navigationOptionså±žæ€§è®¾ç½®ç›¸å…³å±žæ€§å‚æ•°ã€‚ ï¼ˆ2ï¼‰è®¾ç½®å¯¼èˆªæ çš„å±žæ€§å‚æ•°ã€‚ TabNavigatorå®šä¹‰å¥½ä¹‹åŽï¼Œéœ€è¦ç”¨StackNavigatorï¼Œé¡¾åæ€ä¹‰ï¼ŒStackNavigatorå°±æ˜¯ä»¥æ ˆçš„æ–¹å¼æ¥å­˜æ”¾æ•´ä¸ªç•Œé¢çš„ï¼Œè€ŒTabNavigatoræ˜¯ä½œä¸ºä¸€ä¸ªç•Œé¢å†…ä¸åŒå­ç•Œé¢ä¹‹é—´åˆ‡æ¢ã€‚æ‰€ä»¥è¿˜éœ€è¦æˆ‘ä»¬å®šä¹‰StackNavigatorï¼š 123456789101112131415161718const Navigator = StackNavigator( &#123; Tab:&#123;screen:Tab&#125;, Product:&#123;screen:ProductScreen&#125; &#125;, &#123; navigationOptions:&#123; headerBackTitle:null, headerTintColor:'#333333', showIcon:true, swipeEnabled:false, animationEnabled:false, &#125;, mode:'card', &#125;); çœ‹èµ·æ¥å’ŒTabNavigatorå¾ˆç›¸ä¼¼ï¼ŒåŒæ ·æ˜¯æŒ‡å®šäº†ä¸¤ä¸ªå‚æ•°ï¼š ï¼ˆ1ï¼‰æŒ‡å®šè¦è·³è½¬çš„ç•Œé¢ç»„ä»¶ã€‚åŒæ ·æ˜¯screenå±žæ€§æ ‡è¯†ç•Œé¢ç»„ä»¶ï¼Œä¸å¤šèµ˜è¿°ã€‚ ï¼ˆ2ï¼‰å®šä¹‰è·³è½¬å±žæ€§å‚æ•°ï¼Œå³é¡¶éƒ¨å¯¼èˆªæ çš„ä¸€äº›å‚æ•°è®¾ç½®å’Œè·³è½¬æ–¹å¼ã€‚ å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å°†Tabä½œä¸ºä¸€ä¸ªç•Œé¢è®¾ç½®åˆ°äº†StackNavigatorã€‚è¿™æ ·å°±å¯ä»¥å®žçŽ°Tabå¯¼èˆªå’Œç•Œé¢é—´è·³è½¬çš„æ•ˆæžœäº†ã€‚ æœ€åŽå°±æ˜¯åœ¨renderä¸­å¼•ç”¨StackNavigatorï¼š 12345678export default class Demo extends Component &#123; render() &#123; return ( &lt;Navigator /&gt; ); &#125; &#125; StackNavigatorè¿˜æä¾›äº†onNavigationStateChangeå›žè°ƒæ–¹æ³•ï¼Œç”¨æ¥ç›‘å¬å¯¼èˆªçŠ¶æ€çš„æ”¹å˜ã€‚å…·ä½“ä¸å†èµ˜è¿°ã€‚å®žçŽ°äº†ç•Œé¢è·³è½¬å’Œåˆ‡æ¢ï¼Œé‚£ä¹ˆå°±è¯¥æ¥å¢žåŠ ä¸‹ç•Œé¢ä¹‹é—´çš„æ„Ÿæƒ…äº†ï¼Œæ¥çœ‹çœ‹å¦‚ä½•å®žçŽ°ç•Œé¢ä¹‹é—´çš„ä¼ å€¼å’Œå–å€¼ã€‚ 5ã€ç•Œé¢é—´è·³è½¬ã€ä¼ å€¼ã€å–å€¼ åœ¨ç•Œé¢ç»„ä»¶æ³¨å…¥åˆ°StackNavigatorä¸­æ—¶ï¼Œç•Œé¢ç»„ä»¶å°±è¢«èµ‹äºˆäº†navigationå±žæ€§ï¼Œå³åœ¨ç•Œé¢ç»„ä»¶ä¸­å¯ä»¥é€šè¿‡ã€this.props.navigationã€‘èŽ·å–å¹¶è¿›è¡Œä¸€äº›æ“ä½œã€‚ navigationå±žæ€§ä¸­æä¾›äº†å¾ˆå¤šçš„å‡½æ•°ç®€åŒ–ç•Œé¢é—´æ“ä½œï¼Œç®€å•åˆ—ä¸¾å‡ ç‚¹ï¼š ï¼ˆ1ï¼‰é€šè¿‡navigateå‡½æ•°å®žçŽ°ç•Œé¢ä¹‹é—´è·³è½¬ï¼š 1this.props.navigation.navigate(&apos;Mine&apos;); å‚æ•°ä¸ºæˆ‘ä»¬åœ¨StackNavigatoræ³¨å†Œç•Œé¢ç»„ä»¶æ—¶çš„åç§°ã€‚åŒæ ·ä¹Ÿå¯ä»¥ä»Žå½“å‰é¡µé¢è¿”å›žåˆ°ä¸Šä¸€é¡µï¼š 12// è¿”å›žä¸Šä¸€é¡µ this.props.navigation.goBack(); ï¼ˆ2ï¼‰è·³è½¬æ—¶ä¼ å€¼ï¼š 1this.props.navigation.navigate(&apos;Mine&apos;,&#123;info:&apos;ä¼ å€¼è¿‡åŽ»&apos;&#125;); ç¬¬ä¸€ä¸ªå‚æ•°åŒæ ·ä¸ºè¦è·³è½¬çš„ç•Œé¢ç»„ä»¶åç§°ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºè¦ä¼ é€’çš„å‚æ•°ï¼Œinfoå¯ä»¥ç†è§£ä¸ºkeyï¼ŒåŽé¢å³ä¼ é€’çš„å‚æ•°ã€‚ ï¼ˆ3ï¼‰èŽ·å–å€¼ï¼š 1&#123;this.props.navigation.state.params.info&#125; é€šè¿‡state.paramsæ¥èŽ·å–ä¼ æ¥çš„å‚æ•°ï¼ŒåŽé¢ä¸ºkeyå€¼ã€‚æ­¤å¤„ä¸ºinfoã€‚ ä»¥ä¸Šå®žçŽ°å®Œæˆï¼Œæˆ‘ä»¬å°±å¯ä»¥æ„‰å¿«çš„çŽ©è€å•¦~~ ä»€ä¹ˆï¼Ÿå¿½ç„¶å‘çŽ°åœ¨Androidä¸Šçš„æ•ˆæžœå’ŒIOSæ•ˆæžœä¸ä¸€æ ·ã€‚è€æ¿è¦ç•Œé¢ä¸€è‡´å“‡~ æ€Žä¹ˆåŠžï¼Ÿé‚£å°±éœ€è¦æˆ‘ä»¬è¿›è¡Œç®€å•çš„é€‚é…äº†ã€‚ ä¸‰ã€DrawerNavigatorå®žçŽ°æŠ½å±‰å¯¼èˆª1ã€å¯¼èˆªå®žçŽ° APIå®šä¹‰ï¼šDrawerNavigatorï¼ˆRouteConfigsï¼ŒDrawerNavigatorConfigï¼‰ ï¼ˆ1ï¼‰ç•Œé¢ä¸­å®šä¹‰DrawerNavigatorï¼š 123456789101112131415161718192021222324252627import &#123;StackNavigator,TabNavigator,DrawerNavigator&#125; from 'react-navigation'; import HomeScreen from './pages/HomePage'; import MineScreen from './pages/MinePage'; export default class Demo extends Component &#123; render() &#123; return ( &lt;Navigator /&gt; ); &#125; &#125; const Navigator = DrawerNavigator(&#123; Home:&#123;screen:HomeScreen&#125;, Mine:&#123;screen:MineScreen&#125;, &#125;); const styles = StyleSheet.create(&#123; container: &#123; flex: 1, &#125;, &#125;); AppRegistry.registerComponent('Demo', () =&gt; Demo); å®šä¹‰æ–¹å¼å’ŒStackNavigatoråŸºæœ¬ç±»ä¼¼ï¼Œä¸å†èµ˜è¿°ã€‚ ï¼ˆ2ï¼‰HomeScreenç•Œé¢å’ŒMineScreenç•Œé¢ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152export default class HomePage extends Component &#123; static navigationOptions = &#123; drawerLabel: 'é¦–é¡µ', drawerIcon:(&#123;tintColor&#125;) =&gt; ( &lt;Image source=&#123;require('./../imgs/ic_happy.png')&#125; style=&#123;[styles.icon, &#123;tintColor: tintColor&#125;]&#125;/&gt; ), &#125;; render() &#123; return( &lt;View style=&#123;&#123;flex:1&#125;&#125;&gt; &lt;Text onPress=&#123;this._skip.bind(this)&#125;&gt;ç‚¹å‡»è·³è½¬&lt;/Text&gt; &lt;/View&gt; ); &#125; _skip() &#123; this.props.navigation.navigate("Mine"); &#125; &#125; export default class MinePage extends Component &#123; static navigationOptions = &#123; drawerLabel:'æˆ‘', drawerIcon: (&#123; tintColor &#125;) =&gt; ( &lt;Image source=&#123;require('./../imgs/ic_h.png')&#125; style=&#123;[styles.icon, &#123;tintColor: tintColor&#125;]&#125; /&gt; ), &#125;; render() &#123; return( &lt;View style=&#123;&#123;flex:1&#125;&#125;&gt; &lt;Text onPress=&#123;this._skip.bind(this)&#125;&gt;è¿”å›žä¸Šä¸€ç•Œé¢&lt;/Text&gt; &lt;/View&gt; ); &#125; /** * è·³è½¬ */ _skip() &#123; this.props.navigation.goBack(); &#125; &#125; ä»£ç å¾ˆç®€å•ï¼Œå®žçŽ°äº†ç•Œé¢ä¹‹é—´çš„è·³è½¬ã€‚ 2ã€æ‰©å±•åŠŸèƒ½ ï¼ˆ1ï¼‰é»˜è®¤DrawerViewä¸å¯æ»šåŠ¨ã€‚è¦å®žçŽ°å¯æ»šåŠ¨è§†å›¾ï¼Œå¿…é¡»ä½¿ç”¨contentComponentè‡ªå®šä¹‰å®¹å™¨ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 12345&#123; drawerWidthï¼š200ï¼Œ æŠ½å±‰ä½ç½®ï¼šâ€œå¯¹â€ contentComponentï¼šprops =&gt; &lt;ScrollView&gt; &lt;DrawerItems &#123;... props&#125; /&gt; &lt;/ ScrollView&gt; &#125; ï¼ˆ2ï¼‰å¯ä»¥è¦†ç›–å¯¼èˆªä½¿ç”¨çš„é»˜è®¤ç»„ä»¶ï¼Œä½¿ç”¨DrawerItemsè‡ªå®šä¹‰å¯¼èˆªç»„ä»¶ï¼š 1234567import &#123;DrawerItems&#125; from &apos;react-navigation&apos;; const CustomDrawerContentComponent = (props) =&gt; ( &lt;View style = &#123;style.container&#125;&gt; &lt;DrawerItems &#123;... props&#125; /&gt; &lt;/View&gt; ); ï¼ˆ3ï¼‰åµŒå¥—æŠ½å±‰å¯¼èˆª å¦‚æžœæ‚¨åµŒå¥—DrawerNavigationï¼ŒæŠ½å±‰å°†æ˜¾ç¤ºåœ¨çˆ¶å¯¼èˆªä¸‹æ–¹ã€‚ äº”ã€æ•ˆæžœå›¾æŠ½å±‰å¯¼èˆªï¼š ä»¥ä¸Šå°±æ˜¯æˆ‘ä»¬å®žæˆ˜ä¸­å¸¸ç”¨çš„å±žæ€§å’ŒæŠ€å·§ã€‚å…·ä½“çš„æ“ä½œè¿˜éœ€è¦å¤§å®¶åœ¨å®žè·µè¿‡ç¨‹ä¸­æµ‹è¯•ä½“ä¼šã€‚ æºç å‚è€ƒ]]></content>
      <categories>
        <category>react-nativeå­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>navigator</tag>
        <tag>tabNavigator</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Method Swizzling å’Œ AOP å®žè·µ]]></title>
    <url>%2F2018%2F04%2F03%2FMethod_Swizzling_and_AOP%2F</url>
    <content type="text"><![CDATA[è½¬è‡ª: http://tech.glowing.com/cn/method-swizzling-aop/ ä¸Šä¸€ç¯‡ä»‹ç»äº† Objective-C Messagingã€‚åˆ©ç”¨ Objective-C çš„ Runtime ç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ç»™è¯­è¨€åšæ‰©å±•ï¼Œå¸®åŠ©è§£å†³é¡¹ç›®å¼€å‘ä¸­çš„ä¸€äº›è®¾è®¡å’ŒæŠ€æœ¯é—®é¢˜ã€‚è¿™ä¸€ç¯‡ï¼Œæˆ‘ä»¬æ¥æŽ¢ç´¢ä¸€äº›åˆ©ç”¨ Objective-C Runtime çš„é»‘è‰²æŠ€å·§ã€‚è¿™äº›æŠ€å·§ä¸­æœ€å…·äº‰è®®çš„æˆ–è®¸å°±æ˜¯ Method Swizzling ã€‚ ä»‹ç»ä¸€ä¸ªæŠ€å·§ï¼Œæœ€å¥½çš„æ–¹å¼å°±æ˜¯æå‡ºå…·ä½“çš„éœ€æ±‚ï¼Œç„¶åŽç”¨å®ƒè·Ÿå…¶ä»–çš„è§£å†³æ–¹æ³•åšæ¯”è¾ƒã€‚ æ‰€ä»¥ï¼Œå…ˆæ¥çœ‹çœ‹æˆ‘ä»¬çš„éœ€æ±‚ï¼šå¯¹ App çš„ç”¨æˆ·è¡Œä¸ºè¿›è¡Œè¿½è¸ªå’Œåˆ†æžã€‚ç®€å•è¯´ï¼Œå°±æ˜¯å½“ç”¨æˆ·çœ‹åˆ°æŸä¸ª View æˆ–è€…ç‚¹å‡»æŸä¸ª Button çš„æ—¶å€™ï¼Œå°±æŠŠè¿™ä¸ªäº‹ä»¶è®°ä¸‹æ¥ã€‚ æ‰‹åŠ¨æ·»åŠ æœ€ç›´æŽ¥ç²—æš´çš„æ–¹å¼å°±æ˜¯åœ¨æ¯ä¸ª viewDidAppear é‡Œæ·»åŠ è®°å½•äº‹ä»¶çš„ä»£ç ã€‚ 1234567891011121314151617181920@implementation MyViewController ()- (void)viewDidAppear:(BOOL)animated&#123; [super viewDidAppear:animated]; // Custom code // Logging [Logging logWithEventName:@â€œmy view did appearâ€];&#125;- (void)myButtonClicked:(id)sender&#123; // Custom code // Logging [Logging logWithEventName:@â€œmy button clickedâ€];&#125; è¿™ç§æ–¹å¼çš„ç¼ºç‚¹ä¹Ÿå¾ˆæ˜Žæ˜¾ï¼šå®ƒç ´åäº†ä»£ç çš„å¹²å‡€æ•´æ´ã€‚å› ä¸º Logging çš„ä»£ç æœ¬èº«å¹¶ä¸å±žäºŽ ViewController é‡Œçš„ä¸»è¦é€»è¾‘ã€‚éšç€é¡¹ç›®æ‰©å¤§ã€ä»£ç é‡å¢žåŠ ï¼Œä½ çš„ ViewController é‡Œä¼šåˆ°å¤„æ•£å¸ƒç€ Logging çš„ä»£ç ã€‚è¿™æ—¶ï¼Œè¦æ‰¾åˆ°ä¸€æ®µäº‹ä»¶è®°å½•çš„ä»£ç ä¼šå˜å¾—å›°éš¾ï¼Œä¹Ÿå¾ˆå®¹æ˜“å¿˜è®°æ·»åŠ äº‹ä»¶è®°å½•çš„ä»£ç ã€‚ ä½ å¯èƒ½ä¼šæƒ³åˆ°ç”¨ç»§æ‰¿æˆ–ç±»åˆ«ï¼Œåœ¨é‡å†™çš„æ–¹æ³•é‡Œæ·»åŠ äº‹ä»¶è®°å½•çš„ä»£ç ã€‚ä»£ç å¯ä»¥æ˜¯é•¿çš„è¿™ä¸ªæ ·å­ï¼š 123456789101112131415161718192021@implementation UIViewController ()- (void)myViewDidAppear:(BOOL)animated&#123; [super viewDidAppear:animated]; // Custom code // Logging [Logging logWithEventName:NSStringFromClass([self class])];&#125;- (void)myButtonClicked:(id)sender&#123; // Custom code // Logging NSString *name = [NSString stringWithFormat:@â€œmy button in %@ is clickedâ€, NSStringFromClass([self class])]; [Logging logWithEventName:name];&#125; Loggingçš„ä»£ç éƒ½å¾ˆç›¸ä¼¼ï¼Œé€šè¿‡ç»§æ‰¿æˆ–ç±»åˆ«é‡å†™ç›¸å…³æ–¹æ³•æ˜¯å¯ä»¥æŠŠå®ƒä»Žä¸»è¦é€»è¾‘ä¸­å‰¥ç¦»å‡ºæ¥ã€‚ä½†åŒæ—¶ä¹Ÿå¸¦æ¥æ–°çš„é—®é¢˜ï¼š ä½ éœ€è¦ç»§æ‰¿ UIViewController, UITableViewController,UICollectionViewController æ‰€æœ‰è¿™äº› ViewController ï¼Œæˆ–è€…ç»™ä»–ä»¬æ·»åŠ ç±»åˆ«ï¼› æ¯ä¸ª ViewController é‡Œçš„ ButtonClick æ–¹æ³•å‘½åä¸å¯èƒ½éƒ½ä¸€æ ·ï¼› ä½ ä¸èƒ½æŽ§åˆ¶åˆ«äººå¦‚ä½•åŽ»å®žä¾‹åŒ–ä½ çš„å­ç±»ï¼› å¯¹äºŽç±»åˆ«ï¼Œä½ æ²¡åŠžæ³•è°ƒç”¨åˆ°åŽŸæ¥çš„æ–¹æ³•å®žçŽ°ã€‚å¤§å¤šæ—¶å€™ï¼Œæˆ‘ä»¬é‡å†™ä¸€ä¸ªæ–¹æ³•åªæ˜¯ä¸ºäº†æ·»åŠ ä¸€äº›ä»£ç ï¼Œè€Œä¸æ˜¯å®Œå…¨å–ä»£å®ƒã€‚ å¦‚æžœæœ‰ä¸¤ä¸ªç±»åˆ«éƒ½å®žçŽ°äº†ç›¸åŒçš„æ–¹æ³•ï¼Œè¿è¡Œæ—¶æ²¡æ³•ä¿è¯å“ªä¸€ä¸ªç±»åˆ«çš„æ–¹æ³•ä¼šç»™è°ƒç”¨ã€‚ Method SwizzlingMethod Swizzling åˆ©ç”¨ Runtime ç‰¹æ€§æŠŠä¸€ä¸ªæ–¹æ³•çš„å®žçŽ°ä¸Žå¦ä¸€ä¸ªæ–¹æ³•çš„å®žçŽ°è¿›è¡Œæ›¿æ¢ã€‚ ä¸Šä¸€ç¯‡æ–‡ç«  æœ‰è®²åˆ°æ¯ä¸ªç±»é‡Œéƒ½æœ‰ä¸€ä¸ª Dispatch Table ï¼Œå°†æ–¹æ³•çš„åå­—ï¼ˆSELï¼‰è·Ÿæ–¹æ³•çš„å®žçŽ°ï¼ˆIMPï¼ŒæŒ‡å‘ C å‡½æ•°çš„æŒ‡é’ˆï¼‰ä¸€ä¸€å¯¹åº”ã€‚Swizzle ä¸€ä¸ªæ–¹æ³•å…¶å®žå°±æ˜¯åœ¨ç¨‹åºè¿è¡Œæ—¶åœ¨ Dispatch Table é‡Œåšç‚¹æ”¹åŠ¨ï¼Œè®©è¿™ä¸ªæ–¹æ³•çš„åå­—ï¼ˆSELï¼‰å¯¹åº”åˆ°å¦ä¸ªIMP ã€‚ é¦–å…ˆå®šä¹‰ä¸€ä¸ªç±»åˆ«ï¼Œæ·»åŠ å°†è¦ Swizzled çš„æ–¹æ³•ï¼š 12345678910@implementation UIViewController (Logging)- (void)swizzled_viewDidAppear:(BOOL)animated&#123; // call original implementation [self swizzled_viewDidAppear:animated]; // Logging [Logging logWithEventName:NSStringFromClass([self class])];&#125; ä»£ç çœ‹èµ·æ¥å¯èƒ½æœ‰ç‚¹å¥‡æ€ªï¼Œåƒé€’å½’ä¸æ˜¯ä¹ˆã€‚å½“ç„¶ä¸ä¼šæ˜¯é€’å½’ï¼Œå› ä¸ºåœ¨ runtime çš„æ—¶å€™ï¼Œå‡½æ•°å®žçŽ°å·²ç»è¢«äº¤æ¢äº†ã€‚è°ƒç”¨ viewDidAppear: ä¼šè°ƒç”¨ä½ å®žçŽ°çš„ swizzled_viewDidAppear:ï¼Œè€Œåœ¨ swizzled_viewDidAppear: é‡Œè°ƒç”¨ swizzled_viewDidAppear: å®žé™…ä¸Šè°ƒç”¨çš„æ˜¯åŽŸæ¥çš„ viewDidAppear: ã€‚ æŽ¥ä¸‹æ¥å®žçŽ° swizzle çš„æ–¹æ³• ï¼š 12345678910111213141516171819@implementation UIViewController (Logging)void swizzleMethod(Class class, SEL originalSelector, SEL swizzledSelector) &#123; // the method might not exist in the class, but in its superclass Method originalMethod = class_getInstanceMethod(class, originalSelector); Method swizzledMethod = class_getInstanceMethod(class, swizzledSelector); // class_addMethod will fail if original method already exists BOOL didAddMethod = class_addMethod(class, originalSelector, method_getImplementation(swizzledMethod), method_getTypeEncoding(swizzledMethod)); // the method doesnâ€™t exist and we just added one if (didAddMethod) &#123; class_replaceMethod(class, swizzledSelector, method_getImplementation(originalMethod), method_getTypeEncoding(originalMethod)); &#125; else &#123; method_exchangeImplementations(originalMethod, swizzledMethod); &#125;&#125; è¿™é‡Œå”¯ä¸€å¯èƒ½éœ€è¦è§£é‡Šçš„æ˜¯ class_addMethod ã€‚è¦å…ˆå°è¯•æ·»åŠ åŽŸ selector æ˜¯ä¸ºäº†åšä¸€å±‚ä¿æŠ¤ï¼Œå› ä¸ºå¦‚æžœè¿™ä¸ªç±»æ²¡æœ‰å®žçŽ° originalSelector ï¼Œä½†å…¶çˆ¶ç±»å®žçŽ°äº†ï¼Œé‚£ class_getInstanceMethod ä¼šè¿”å›žçˆ¶ç±»çš„æ–¹æ³•ã€‚è¿™æ · method_exchangeImplementations æ›¿æ¢çš„æ˜¯çˆ¶ç±»çš„é‚£ä¸ªæ–¹æ³•ï¼Œè¿™å½“ç„¶ä¸æ˜¯ä½ æƒ³è¦çš„ã€‚æ‰€ä»¥æˆ‘ä»¬å…ˆå°è¯•æ·»åŠ  orginalSelector ï¼Œå¦‚æžœå·²ç»å­˜åœ¨ï¼Œå†ç”¨ method_exchangeImplementations æŠŠåŽŸæ–¹æ³•çš„å®žçŽ°è·Ÿæ–°çš„æ–¹æ³•å®žçŽ°ç»™äº¤æ¢æŽ‰ã€‚ æœ€åŽï¼Œæˆ‘ä»¬åªéœ€è¦ç¡®ä¿åœ¨ç¨‹åºå¯åŠ¨çš„æ—¶å€™è°ƒç”¨ swizzleMethod æ–¹æ³•ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¹‹å‰ UIViewController çš„ Logging ç±»åˆ«é‡Œæ·»åŠ  +load: æ–¹æ³•ï¼Œç„¶åŽåœ¨ +load: é‡ŒæŠŠ viewDidAppear ç»™æ›¿æ¢æŽ‰ï¼š 123456@implementation UIViewController (Logging)+ (void)load&#123; swizzleMethod([self class], @selector(viewDidAppear:), @selector(swizzled_viewDidAppear:));&#125; ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç±»åˆ«é‡Œçš„æ–¹æ³•ä¼šé‡å†™æŽ‰ä¸»ç±»é‡Œç›¸åŒå‘½åçš„æ–¹æ³•ã€‚å¦‚æžœæœ‰ä¸¤ä¸ªç±»åˆ«å®žçŽ°äº†ç›¸åŒå‘½åçš„æ–¹æ³•ï¼Œåªæœ‰ä¸€ä¸ªæ–¹æ³•ä¼šè¢«è°ƒç”¨ã€‚ä½† +load: æ˜¯ä¸ªç‰¹ä¾‹ï¼Œå½“ä¸€ä¸ªç±»è¢«è¯»åˆ°å†…å­˜çš„æ—¶å€™ï¼Œ runtime ä¼šç»™è¿™ä¸ªç±»åŠå®ƒçš„æ¯ä¸€ä¸ªç±»åˆ«éƒ½å‘é€ä¸€ä¸ª +load: æ¶ˆæ¯ã€‚ å…¶å®žï¼Œè¿™é‡Œè¿˜å¯ä»¥æ›´ç®€åŒ–ç‚¹ï¼šç›´æŽ¥ç”¨æ–°çš„ IMPå–ä»£åŽŸ IMP ï¼Œè€Œä¸æ˜¯æ›¿æ¢ã€‚åªéœ€è¦æœ‰å…¨å±€çš„å‡½æ•°æŒ‡é’ˆæŒ‡å‘åŽŸIMP å°±å¯ä»¥ã€‚ 1234567891011121314151617181920void (gOriginalViewDidAppear)(id, SEL, BOOL);void newViewDidAppear(UIViewController *self, SEL _cmd, BOOL animated) &#123; // call original implementation gOriginalViewDidAppear(self, _cmd, animated); // Logging [Logging logWithEventName:NSStringFromClass([self class])];&#125;+ (void)load&#123; Method originalMethod = class_getInstanceMethod(self, @selector(viewDidAppear:)); gOriginalViewDidAppear = (void *)method_getImplementation(originalMethod); if(!class_addMethod(self, @selector(viewDidAppear:), (IMP) newViewDidAppear, method_getTypeEncoding(originalMethod))) &#123; method_setImplementation(originalMethod, (IMP) newViewDidAppear); &#125;&#125; é€šè¿‡ Method Swizzling ï¼Œæˆ‘ä»¬æˆåŠŸæŠŠé€»è¾‘ä»£ç è·Ÿå¤„ç†äº‹ä»¶è®°å½•çš„ä»£ç è§£è€¦ã€‚å½“ç„¶é™¤äº† Logging ï¼Œè¿˜æœ‰å¾ˆå¤šç±»ä¼¼çš„äº‹åŠ¡ï¼Œå¦‚ Authentication å’Œ Cachingã€‚è¿™äº›äº‹åŠ¡çç¢Žï¼Œè·Ÿä¸»è¦ä¸šåŠ¡é€»è¾‘æ— å…³ï¼Œåœ¨å¾ˆå¤šåœ°æ–¹éƒ½æœ‰ï¼Œåˆå¾ˆéš¾æŠ½è±¡å‡ºæ¥å•ç‹¬çš„æ¨¡å—ã€‚è¿™ç§ç¨‹åºè®¾è®¡é—®é¢˜ï¼Œä¸šç•Œä¹Ÿç»™äº†ä»–ä»¬ä¸€ä¸ªåå­— - Cross Cutting Concernsã€‚ è€Œåƒä¸Šé¢ä¾‹å­ç”¨ Method Swizzling åŠ¨æ€ç»™æŒ‡å®šçš„æ–¹æ³•æ·»åŠ ä»£ç ï¼Œä»¥è§£å†³ Cross Cutting Concerns çš„ç¼–ç¨‹æ–¹å¼å«ï¼šAspect Oriented Programming Aspect Oriented Programming ï¼ˆé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼‰Wikipedia é‡Œå¯¹ AOP æ˜¯è¿™ä¹ˆä»‹ç»çš„: An aspect can alter the behavior of the base code by applying advice(additional behavior) at various join points (points in a program)specified in a quantification or query called a pointcut (that detectswhether a given join point matches). åœ¨ Objective-C çš„ä¸–ç•Œé‡Œï¼Œè¿™å¥è¯æ„æ€å°±æ˜¯åˆ©ç”¨ Runtime ç‰¹æ€§ç»™æŒ‡å®šçš„æ–¹æ³•æ·»åŠ è‡ªå®šä¹‰ä»£ç ã€‚æœ‰å¾ˆå¤šæ–¹å¼å¯ä»¥å®žçŽ° AOP ï¼ŒMethod Swizzling å°±æ˜¯å…¶ä¸­ä¹‹ä¸€ã€‚è€Œä¸”å¹¸è¿çš„æ˜¯ï¼Œç›®å‰å·²ç»æœ‰ä¸€äº›ç¬¬ä¸‰æ–¹åº“å¯ä»¥è®©ä½ ä¸éœ€è¦äº†è§£ Runtime ï¼Œå°±èƒ½ç›´æŽ¥å¼€å§‹ä½¿ç”¨ AOP ã€‚ Aspects å°±æ˜¯ä¸€ä¸ªä¸é”™çš„ AOP åº“ï¼Œå°è£…äº† Runtime ï¼Œ Method Swizzling è¿™äº›é»‘è‰²æŠ€å·§ï¼Œåªæä¾›ä¸¤ä¸ªç®€å•çš„APIï¼š 12345678+ (id&lt;AspectToken&gt;)aspect_hookSelector:(SEL)selector withOptions:(AspectOptions)options usingBlock:(id)block error:(NSError **)error;- (id&lt;AspectToken&gt;)aspect_hookSelector:(SEL)selector withOptions:(AspectOptions)options usingBlock:(id)block error:(NSError **)error; ä½¿ç”¨ Aspects æä¾›çš„APIï¼Œæˆ‘ä»¬ä¹‹å‰çš„ä¾‹å­ä¼šè¿›åŒ–æˆè¿™ä¸ªæ ·å­ï¼š 1234567891011@implementation UIViewController (Logging)+ (void)load&#123; [UIViewController aspect_hookSelector:@selector(viewDidAppear:) withOptions:AspectPositionAfter usingBlock:^(id&lt;AspectInfo&gt; aspectInfo) &#123; NSString *className = NSStringFromClass([[aspectInfo instance] class]); [Logging logWithEventName:className]; &#125; error:NULL];&#125; ä½ å¯ä»¥ç”¨åŒæ ·çš„æ–¹å¼åœ¨ä»»ä½•ä½ æ„Ÿå…´è¶£çš„æ–¹æ³•é‡Œæ·»åŠ è‡ªå®šä¹‰ä»£ç ï¼Œæ¯”å¦‚ IBAction çš„æ–¹æ³•é‡Œã€‚æ›´å¥½çš„æ–¹å¼ï¼Œä½ æä¾›ä¸€ä¸ª Logging çš„é…ç½®æ–‡ä»¶ä½œä¸ºå”¯ä¸€å¤„ç†äº‹ä»¶è®°å½•çš„åœ°æ–¹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263@implementation AppDelegate (Logging)+ (void)setupLogging&#123; NSDictionary *config = @&#123; @&quot;MainViewController&quot;: @&#123; GLLoggingPageImpression: @&quot;page imp - main page&quot;, GLLoggingTrackedEvents: @[ @&#123; GLLoggingEventName: @&quot;button one clicked&quot;, GLLoggingEventSelectorName: @&quot;buttonOneClicked:&quot;, GLLoggingEventHandlerBlock: ^(id&lt;AspectInfo&gt; aspectInfo) &#123; [Logging logWithEventName:@&quot;button one clicked&quot;]; &#125;, &#125;, @&#123; GLLoggingEventName: @&quot;button two clicked&quot;, GLLoggingEventSelectorName: @&quot;buttonTwoClicked:&quot;, GLLoggingEventHandlerBlock: ^(id&lt;AspectInfo&gt; aspectInfo) &#123; [Logging logWithEventName:@&quot;button two clicked&quot;]; &#125;, &#125;, ], &#125;, @&quot;DetailViewController&quot;: @&#123; GLLoggingPageImpression: @&quot;page imp - detail page&quot;, &#125; &#125;; [AppDelegate setupWithConfiguration:config];&#125;+ (void)setupWithConfiguration:(NSDictionary *)configs&#123; // Hook Page Impression [UIViewController aspect_hookSelector:@selector(viewDidAppear:) withOptions:AspectPositionAfter usingBlock:^(id&lt;AspectInfo&gt; aspectInfo) &#123; NSString *className = NSStringFromClass([[aspectInfo instance] class]); [Logging logWithEventName:className]; &#125; error:NULL]; // Hook Events for (NSString *className in configs) &#123; Class clazz = NSClassFromString(className); NSDictionary *config = configs[className]; if (config[GLLoggingTrackedEvents]) &#123; for (NSDictionary *event in config[GLLoggingTrackedEvents]) &#123; SEL selekor = NSSelectorFromString(event[GLLoggingEventSelectorName]); AspectHandlerBlock block = event[GLLoggingEventHandlerBlock]; [clazz aspect_hookSelector:selekor withOptions:AspectPositionAfter usingBlock:^(id&lt;AspectInfo&gt; aspectInfo) &#123; block(aspectInfo); &#125; error:NULL]; &#125; &#125; &#125;&#125; ç„¶åŽåœ¨ -application:didFinishLaunchingWithOptions: é‡Œè°ƒç”¨ setupLoggingï¼š 123456- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions &#123; // Override point for customization after application launch. [self setupLogging]; return YES;&#125; æœ€åŽçš„è¯åˆ©ç”¨ objective-C Runtime ç‰¹æ€§å’Œ Aspect Oriented Programming ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠçç¢Žäº‹åŠ¡çš„é€»è¾‘ä»Žä¸»é€»è¾‘ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œä½œä¸ºå•ç‹¬çš„æ¨¡å—ã€‚å®ƒæ˜¯å¯¹é¢å‘å¯¹è±¡ç¼–ç¨‹æ¨¡å¼çš„ä¸€ä¸ªè¡¥å……ã€‚Logging æ˜¯ä¸ªç»å…¸çš„åº”ç”¨ï¼Œè¿™é‡Œåšä¸ªæŠ›ç –å¼•çŽ‰ï¼Œå‘æŒ¥æƒ³è±¡åŠ›ï¼Œå¯ä»¥åšå‡ºå…¶ä»–æœ‰è¶£çš„åº”ç”¨ã€‚ ä½¿ç”¨ Aspects å®Œæ•´çš„ä¾‹å­å¯ä»¥ä»Žè¿™é‡ŒèŽ·å¾—ï¼šAspectsDemoã€‚]]></content>
      <categories>
        <category>iOS ä¹‹ runtime</category>
      </categories>
      <tags>
        <tag>runtime</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Android ä¹‹ç®€æ˜“æ¶‚é¸¦æ¿]]></title>
    <url>%2F2017%2F06%2F08%2Fandroid-canvas%2F</url>
    <content type="text"><![CDATA[æ²¡æœ‰åºŸè¯ï¼Œç®€å•ç²—æš´ã€‚ 1.åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰ viewåˆ›å»ºä¸€ä¸ª DrawViewï¼Œç»§æ‰¿è‡ª android.view.View ç±»ã€‚åœ¨è¿™ä¸ªç±»ä¸­ï¼Œå…ˆå®šä¹‰æ‰€éœ€çš„å±žæ€§ï¼Œå†åˆ›å»ºä¸€ä¸ªæž„é€ æ–¹æ³•ã€‚ 12345678910111213141516171819202122232425public class DrawView extends View &#123; private int view_width = 0;//ç”»æ¿å®½åº¦ private int view_height = 0;//ç”»æ¿é«˜åº¦ private float preX;//èµ·å§‹ç‚¹çš„ x åæ ‡ private float preY;//èµ·å§‹ç‚¹çš„ y åæ ‡ private Path path;//è·¯å¾„ public Paint paint = null;//ç”»ç¬” Bitmap cacheBitmap = null;//å®šä¹‰ä¸€ä¸ªå†…å­˜ä¸­çš„å›¾ç‰‡ï¼Œè¯¥å›¾ç‰‡ä½œä¸ºç¼“å†²åŒº Canvas cacheCanvas = null;//å®šä¹‰ cacheBitmap ä¸Šçš„ Canvas å¯¹è±¡ /*æž„é€ æ–¹æ³•*/ public DrawView(Context context, AttributeSet set)&#123; super(context,set); &#125; /*é‡å†™ onDraw æ–¹æ³•*/ @Override protected void onDraw(Canvas canvas) &#123; super.onDraw(canvas); &#125;&#125; 2.ä¿®æ”¹ xml æ–‡ä»¶ä¿®æ”¹ activity_main.xml æ–‡ä»¶ï¼Œå¹¶å°†è‡ªå®šä¹‰çš„ DrawView æ·»åŠ åˆ°å¸ƒå±€ç®¡ç†å™¨ä¸­ã€‚ 123456789101112&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;FrameLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot; android:layout_width=&quot;fill_parent&quot; android:layout_height=&quot;fill_parent&quot; android:orientation=&quot;vertical&quot; &gt; &lt;com.example.test.DrawView android:id=&quot;@+id/drawView1&quot; android:layout_width=&quot;match_parent&quot; android:layout_height=&quot;match_parent&quot; /&gt;&lt;/FrameLayout&gt; 3.DrawView çš„æž„é€ æ–¹æ³•åœ¨ DrawView çš„æž„é€ æ–¹æ³•ä¸­ï¼Œé¦–å…ˆèŽ·å–å±å¹•çš„å®½åº¦å’Œé«˜åº¦ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªä¸Žè¯¥ view ç›¸åŒå¤§å°çš„ç¼“å­˜åŒºï¼Œç„¶åŽåˆ›å»ºä¸€ä¸ªæ–°çš„ç”»é¢ï¼Œå¹¶å®žä¾‹åŒ–ä¸€ä¸ªè·¯å¾„ï¼Œå†è®²å†…å­˜ä¸­çš„ä½å›¾ç»˜åˆ¶åˆ° cacheCanvas ä¸­ï¼Œæœ€åŽå®žä¾‹åŒ–ä¸€ä¸ªç”»ç¬”ï¼Œå¹¶è®¾ç½®ç”»ç¬”çš„ç›¸å…³å±žæ€§ã€‚ 12345678910111213141516171819202122232425262728//èŽ·å–å±å¹•å®½åº¦ view_width = context.getResources().getDisplayMetrics().widthPixels; //èŽ·å–å±å¹•é«˜åº¦ view_height = context.getResources().getDisplayMetrics().heightPixels; cacheBitmap = Bitmap.createBitmap(view_width,view_height, Bitmap.Config.ARGB_8888); //åˆ›å»ºä¸€ä¸ªæ–°çš„ç”»å¸ƒ cacheCanvas = new Canvas(); path = new Path(); //åœ¨ cacheCanvas ä¸Šç»˜åˆ¶ cacheBitmap cacheCanvas.setBitmap(cacheBitmap); paint = new Paint(Paint.DITHER_FLAG); //è®¾ç½®é»˜è®¤çš„ç”»ç¬”é¢œè‰² paint.setColor(Color.RED); //è®¾ç½®å¡«å……æ–¹å¼ä¸ºæè¾¹ paint.setStyle(Paint.Style.STROKE); //è®¾ç½®ç¬”åˆ·çš„å›¾å½¢æ ·å¼ paint.setStrokeJoin(Paint.Join.ROUND); //è®¾ç½®ç”»ç¬”è½¬å¼¯å¤„çš„è¿žæŽ¥é£Žæ ¼ paint.setStrokeCap(Paint.Cap.ROUND); //è®¾ç½®é»˜è®¤çš„ç”»ç¬”çš„å®½åº¦ paint.setStrokeWidth(1); //ä½¿ç”¨æŠ—é”¯é½¿åŠŸèƒ½ paint.setAntiAlias(true); //ä½¿ç”¨æŠ–åŠ¨æ•ˆæžœ paint.setDither(true); 4.é‡å†™ onDraw æ–¹æ³•åœ¨ DrawView çš„ onDraw æ–¹æ³•ä¸­ï¼Œè®¾ç½®èƒŒæ™¯é¢œè‰²ï¼Œç»˜åˆ¶ cacheBitmapï¼Œç»˜åˆ¶è·¯å¾„ä»¥åŠä¿å­˜å½“å‰çš„çŠ¶æ€åˆ°æ ˆä¸­ï¼Œå¹¶è°ƒç”¨ restore()æ–¹æ³•æ¢å¤æ‰€ä¿å­˜çš„çŠ¶æ€ã€‚ 12345678910111213//è®¾ç½®èƒŒæ™¯é¢œè‰² canvas.drawColor(0xFFFFFFFF); //é‡‡ç”¨é»˜è®¤è®¾ç½®åˆ›å»ºä¸€ä¸ªç”»ç¬” Paint bmpPaint = new Paint(); //ç»˜åˆ¶cacheBitmap canvas.drawBitmap(cacheBitmap,0,0,bmpPaint); //ç»˜åˆ¶è·¯å¾„ canvas.drawPath(path,paint); //ä¿å­˜ canvas çŠ¶æ€ canvas.save(Canvas.ALL_SAVE_FLAG); //æ¢å¤ canvas ä¹‹å‰çš„ä¿å­˜çŠ¶æ€ï¼Œé˜²æ­¢ä¿å­˜åŽå¯¹ canvas æ‰§è¡Œçš„æ“ä½œæœ€åŽç»­çš„ç»˜åˆ¶æœ‰å½±å“ canvas.restore(); 5.é‡å†™ onTouchEvent æ–¹æ³•åœ¨ DrawView ç±»ä¸­ï¼Œé‡å†™onTouchEvent() æ–¹æ³•ï¼Œä¸ºè¯¥è§†å›¾æ·»åŠ è§¦æ‘¸æ—¶é—´ç›‘å¬å™¨ï¼Œåœ¨è¯¥æ–¹æ³•ä¸­ï¼Œé¦–å…ˆèŽ·å–è§¦æ‘¸æ—¶é—´å‘ç”Ÿçš„ä½ç½®ï¼Œç„¶åŽåº”ç”¨ switch å¯¹æ—¶é—´çš„ä¸åŒçŠ¶æ€æ·»åŠ å“åº”ä»£ç ï¼Œæœ€åŽè°ƒç”¨invalidate()æ–¹æ³•æ›´æ–°è§†å›¾ã€‚ 12345678910111213141516171819202122232425262728293031323334353637@Override public boolean onTouchEvent(MotionEvent event) &#123; //èŽ·å–è§¦æ‘¸æ—¶é—´å‘ç”Ÿçš„ä½ç½® float x = event.getX(); float y = event.getY(); switch (event.getAction())&#123; case MotionEvent.ACTION_DOWN: //å°†ç»˜å›¾çš„èµ·å§‹ç‚¹ç§»åˆ°ï¼ˆxï¼Œyï¼‰çš„åæ ‡ä½ç½® path.moveTo(x,y); preX = x; preY = y; break; case MotionEvent.ACTION_MOVE: float dx = Math.abs(x-preX); float dy = Math.abs(y-preY); //åˆ¤æ–­æ˜¯å¦åœ¨å…è®¸çš„èŒƒå›´å†… if (dx&gt;=5 || dy &gt;= 5)&#123; path.quadTo(preX,preY,(x+preX)/2,(y+preY)/2); preX = x; preY = y; &#125; break; case MotionEvent.ACTION_UP: //ç»˜åˆ¶è·¯å¾„ cacheCanvas.drawPath(path,paint); path.reset(); break; &#125; invalidate(); //è¿”å›ž trueï¼Œè¡¨ç¤ºå¤„ç†æ–¹æ³•å·²ç»å¤„ç†è¯¥äº‹ä»¶ return true; &#125; 6.ç¼–å†™ clear() æ–¹æ³•å†™ä¸€ä¸ª clear() æ–¹æ³•ï¼Œç”¨æ¥å®žçŽ°æ©¡çš®æ“¦åŠŸèƒ½ã€‚ 1234567public void clear() &#123; //è®¾ç½®å›¾å½¢é‡å æ—¶çš„å¤„ç†æ–¹å¼ paint.setXfermode(new PorterDuffXfermode(PorterDuff.Mode.CLEAR)); //è®¾ç½®æ©¡çš®æ“¦çš„å®½åº¦ paint.setStrokeWidth(50); &#125; 7.ç¼–å†™ save() æ–¹æ³•å†™ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨æ¥ä¿å­˜å½“å‰çš„ç»˜å›¾ã€‚ 12345678910111213141516171819202122232425public void save() &#123; try &#123; saveBitmap(&quot;myPicture&quot;); &#125;catch (IOException e)&#123; e.printStackTrace(); &#125; &#125;private void saveBitmap(String filename) throws IOException &#123; //åˆ›å»ºæ–‡ä»¶å¯¹è±¡ File file = new File(&quot;/sdcard/pictures/&quot;+filename+&quot;.png&quot;); //åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ file.createNewFile(); //åˆ›å»ºä¸€ä¸ªæ–‡ä»¶è¾“å‡ºæµå¯¹è±¡ FileOutputStream out = new FileOutputStream(file); //å°†ç»˜å›¾å†…å®¹åŽ‹ç¼©æˆ PNG æ ¼å¼è¾“å‡ºåˆ°è¾“å‡ºæµå¯¹è±¡ä¸­ cacheBitmap.compress(Bitmap.CompressFormat.PNG,100,out); //å°†ç¼“å†²åŒºçš„æ•°æ®å…¨éƒ¨å†™å‡ºåˆ°è¾“å‡ºæµä¸­ out.flush(); //å…³é—­æ–‡ä»¶è¾“å‡ºæµå¯¹è±¡ out.close(); &#125; 8.è®¾ç½®æƒé™12&lt;uses-permission android:name=&quot;android.permission.MOUNT_UNMOUNT_FILESYSTEMS&quot;/&gt; &lt;uses-permission android:name=&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot;/&gt; 9.åˆ›å»º menu èµ„æºæ–‡ä»¶åœ¨ res ç›®å½•ä¸‹ï¼Œåˆ›å»ºmenu æ–‡ä»¶å¤¹ï¼Œåœ¨ menu æ–‡ä»¶å¤¹ä¸‹ï¼Œåˆ›å»º toolsmenu.xml èµ„æºæ–‡ä»¶ã€‚ 1234567891011121314151617181920212223242526&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;menu xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot; &gt; &lt;item android:title=&quot;@string/color&quot;&gt; &lt;menu &gt; &lt;!-- å®šä¹‰ä¸€ç»„å•é€‰èœå•é¡¹ --&gt; &lt;group android:checkableBehavior=&quot;single&quot; &gt; &lt;!-- å®šä¹‰å­èœå• --&gt; &lt;item android:id=&quot;@+id/red&quot; android:title=&quot;@string/color_red&quot;/&gt; &lt;item android:id=&quot;@+id/green&quot; android:title=&quot;@string/color_green&quot;/&gt; &lt;item android:id=&quot;@+id/blue&quot; android:title=&quot;@string/color_blue&quot;/&gt; &lt;/group&gt; &lt;/menu&gt; &lt;/item&gt; &lt;item android:title=&quot;@string/width&quot;&gt; &lt;menu &gt; &lt;!-- å®šä¹‰å­èœå• --&gt; &lt;group&gt; &lt;item android:id=&quot;@+id/width_1&quot; android:title=&quot;@string/width_1&quot;/&gt; &lt;item android:id=&quot;@+id/width_2&quot; android:title=&quot;@string/width_2&quot;/&gt; &lt;item android:id=&quot;@+id/width_3&quot; android:title=&quot;@string/width_3&quot;/&gt; &lt;/group&gt; &lt;/menu&gt; &lt;/item&gt; &lt;item android:id=&quot;@+id/clear&quot; android:title=&quot;@string/clear&quot;/&gt; &lt;item android:id=&quot;@+id/save&quot; android:title=&quot;@string/save&quot;/&gt;&lt;/menu&gt; 10.æ·»åŠ é€‰é¡¹èœå•é‡å†™onCreateOptionsMenuæ–¹æ³•åœ¨ activity æ–‡ä»¶ä¸­ï¼Œé‡å†™onCreateOptionsMenu()æ–¹æ³•ï¼Œåœ¨è¯¥æ–¹æ³•ä¸­ï¼Œå®žä¾‹åŒ–ä¸€ä¸ªMenuInflaterå¯¹è±¡ï¼Œå¹¶è§£æžèœå•èµ„æºæ–‡ä»¶ã€‚ 123456@Override public boolean onCreateOptionsMenu(Menu menu) &#123; MenuInflater menuInflater = new MenuInflater(this); menuInflater.inflate(R.menu.toolsmenu,menu); return super.onCreateOptionsMenu(menu); &#125; é‡å†™onOptionsItemSelectedæ–¹æ³•é‡å†™onOptionsItemSelected() æ–¹æ³•ï¼Œåˆ†åˆ«å¯¹å„ä¸ªèœå•é¡¹è¢«é€‰æ‹©æ—¶åšå‡ºç›¸åº”çš„å¤„ç†ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051@Override public boolean onOptionsItemSelected(MenuItem item) &#123; //èŽ·å–è‡ªå®šä¹‰è§†å›¾ DrawView drawView = (DrawView)findViewById(R.id.drawView1); //å–æ¶ˆæ“¦é™¤æ•ˆæžœ drawView.paint.setXfermode(null); //åˆå§‹åŒ–ç”»ç¬”çš„å®½åº¦ drawView.paint.setStrokeWidth(1); switch (item.getItemId())&#123; //è®¾ç½®ç”»ç¬”çš„é¢œè‰²ä¸ºçº¢è‰² case R.id.red: drawView.paint.setColor(Color.RED); item.setChecked(true); break; //è®¾ç½®ç”»ç¬”çš„é¢œè‰²ä¸ºç»¿è‰² case R.id.green: drawView.paint.setColor(Color.GREEN); item.setChecked(true); break; //è®¾ç½®ç”»ç¬”çš„é¢œè‰²ä¸ºè“è‰² case R.id.blue: drawView.paint.setColor(Color.BLUE); item.setChecked(true); break; //è®¾ç½®ç”»ç¬”çš„å®½åº¦ä¸º1 case R.id.width_1: drawView.paint.setStrokeWidth(1); break; //è®¾ç½®ç”»ç¬”çš„å®½åº¦ä¸º5 case R.id.width_2: drawView.paint.setStrokeWidth(5); break; //è®¾ç½®ç”»ç¬”çš„å®½åº¦ä¸º10 case R.id.width_3: drawView.paint.setStrokeWidth(10); break; //æ“¦é™¤ç»˜ç”» case R.id.clear: drawView.clear(); break; //ä¿å­˜ç»˜ç”» case R.id.save: drawView.save(); break; &#125; return true; &#125; è¿è¡Œï¼Œå°±ä¼šå¾—åˆ°ä¸€ä¸ªç®€æ˜“çš„æ¶‚é¸¦æ¿ï¼Œå¯ä»¥æ”¹å˜ç”»ç¬”é¢œè‰²ï¼Œç”»ç¬”å®½åº¦ï¼Œæ“¦é™¤ï¼Œä¿å­˜ç­‰ã€‚ çœŸæ˜¯è¶Šæ¥è¶Šæœ‰æ„æ€äº†å‘¢ï¼]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>canvas</tag>
        <tag>paint</tag>
        <tag>draw</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hello World]]></title>
    <url>%2F2017%2F06%2F07%2Fhello-world%2F</url>
    <content type="text"><![CDATA[Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new "My New Post" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment]]></content>
      <tags>
        <tag>hello world</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Android è‡ªå®šä¹‰ item çš„ ListView]]></title>
    <url>%2F2017%2F06%2F05%2Fandroid-listView%2F</url>
    <content type="text"><![CDATA[ä»Ž iOS çš„ TableView çªç„¶è½¬åˆ° Android çš„ ListViewï¼Œ è¯´å®žè¯ï¼Œå¾ˆæ¶å¿ƒã€‚å„ç§ä¸æ–¹ä¾¿ï¼Œä¸è¦é—®æˆ‘ä¸ºä»€ä¹ˆå­¦ Androidï¼Œæˆ‘ä¹Ÿä¸æƒ³ï¼Œå”‰ï¼Œç‰¢éªšå½’ç‰¢éªšï¼Œæ—¢ç„¶å­¦äº†ï¼Œå°±å¾—å­¦åˆ°ç‚¹ä»€ä¹ˆï¼Œä¸ç„¶æ—¢æµªè´¹æ—¶é—´ï¼Œåˆä»€ä¹ˆéƒ½æ²¡å¾—åˆ°,å¤ªäºäº†ã€‚è®°å½•ä¸€ä¸‹å­¦ä¹ çš„åŽ†ç¨‹ã€‚ åœ¨ä½¿ç”¨ ListView çš„æ—¶å€™ï¼Œå¤§éƒ¨åˆ†æˆ‘ä»¬éƒ½ä¼šè‡ªå®šä¹‰ itemï¼ŒiOS ä¹Ÿä¸€æ ·ï¼Œä¼šè‡ªå®šä¹‰ cellã€‚ä¸ç„¶ä½¿ç”¨ç³»ç»Ÿä¸ºæˆ‘ä»¬æä¾›çš„å‡ ç§æ ¼å¼æ˜¯æ»¡è¶³ä¸äº†æˆ‘ä»¬çš„å„å¼å„æ ·çš„éœ€æ±‚çš„ã€‚ åºŸè¯åˆ°æ­¤ä¸ºæ­¢ã€‚ 1.å…ˆåœ¨ xml æ–‡ä»¶ä¸­å¸ƒå±€ï¼š1234567&lt;ListView android:layout_width=&quot;match_parent&quot; android:layout_height=&quot;match_parent&quot; android:id=&quot;@+id/main_listView&quot; android:layout_alignParentTop=&quot;true&quot; android:layout_alignParentLeft=&quot;true&quot; android:layout_alignParentStart=&quot;true&quot; /&gt; 2.åˆ›å»ºæ¨¡åž‹æ–‡ä»¶ç›¸å½“äºŽ iOS ä¸­çš„ model æ–‡ä»¶ï¼Œæ¯å†™ä¸€ä¸ªä¸œè¥¿ï¼Œå°±å¾—åŽ» iOS ä¸­æ‰¾å¯¹åº”çš„ä¸œè¥¿ï¼Œè¿™å±žäºŽæ€ç»´å›ºåŒ–äº†ã€‚æ…¢æ…¢æ”¹æ­£ï¼Œä¸è¿‡è¿™æ ·èƒ½æ–¹ä¾¿å¿«é€Ÿçš„ç†è§£è¿™äº›ä¸œè¥¿ã€‚ 12345678910111213141516171819public class Teacher &#123; private String name; private int imageID; //setterå’Œgetteræ–¹æ³• public String getName() &#123; return name; &#125; public void setName(String name) &#123; this.name = name; &#125; public int getImageID() &#123; return imageID; &#125; public void setImageID(int imageID) &#123; this.imageID = imageID; &#125;&#125; ç›¸æ¯”è¾ƒè€Œè¨€ï¼ŒAndroid çš„æ¨¡åž‹æ–‡ä»¶çœŸçš„å¾ˆéº»çƒ¦ï¼Œå®šä¹‰ä¸€ä¸ªå±žæ€§ï¼Œå°±å¾—å†™å®ƒçš„ getter å’Œ setter æ–¹æ³•ã€‚ä¹Ÿè®¸æœ‰å…¶ä»–çš„åŠžæ³•ï¼Œåªæ˜¯æˆ‘è¿˜ä¸çŸ¥é“ã€‚ 3.åˆ›å»ºAdapterè¿™ä¸ªé€‚é…å™¨ï¼Œåœ¨æˆ‘çš„ç†è§£ä¸­å°±ç›¸å½“äºŽ iOS ä¸­çš„è‡ªå®šä¹‰ cell äº†ï¼Œæ¯” iOS æ–¹ä¾¿çš„æ˜¯ï¼ŒiOS çš„é‚£äº›æ•°æ®æºæ–¹æ³•éƒ½åœ¨è¿™é‡Œå®žçŽ°ã€‚ä¸€èˆ¬çš„è¯ï¼Œè‡ªå®šä¹‰çš„ adapter ä¼šç»§æ‰¿äºŽ BaseAdapterã€‚ 1.å®žçŽ°æ•°æ®æºæ–¹æ³•123456789101112131415161718192021222324@Override public int getCount() &#123; //è¿”å›žå¤šå°‘è¡Œæ•°æ® return mList.size(); &#125; @Override public Object getItem(int position) &#123; //èŽ·å–æ¯ä¸€è¡Œçš„æ•°æ® return mList.get(position); &#125; @Override public long getItemId(int position) &#123; //èŽ·å–è¡Œå· return position; &#125; @Override public View getView(final int position, View convertView, ViewGroup parent) &#123;//UI åˆ·æ–°çš„ä»£ç ä¸»è¦åœ¨è¿™é‡Œå®žçŽ° return null;&#125; 2.åˆ›å»ºä¸€ä¸ªæž„é€ æ–¹æ³•è¿™é‡Œæ˜¯ä¸¾ä¾‹è¯´æ˜Žï¼š 1234public TeacherAdapter(ArrayList&lt;Teacher&gt; mList, Context mContext) &#123; this.mList = mList; this.mContext = mContext; &#125; 4.ç»™ item å¸ƒå±€åˆ›å»ºä¸€ä¸ª item çš„ xml æ–‡ä»¶ï¼Œæ¯ä¸€ä¸ª item çš„å¸ƒå±€éƒ½åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­è¿›è¡Œã€‚ 12345678910111213&lt;ImageView android:layout_width=&quot;50dp&quot; android:layout_height=&quot;50dp&quot; android:id=&quot;@+id/item_imageView&quot; android:layout_marginTop=&quot;5dp&quot; android:layout_marginLeft=&quot;10dp&quot;/&gt; &lt;TextView android:layout_width=&quot;wrap_content&quot; android:layout_height=&quot;wrap_content&quot; android:id=&quot;@+id/item_textView&quot; android:layout_marginLeft=&quot;10dp&quot; android:layout_gravity=&quot;center_vertical&quot;/&gt; è¿™é‡Œæˆ‘ç»™æ¯ä¸ª item ä¸Šå®šä¹‰äº†ä¸¤ä¸ªæŽ§ä»¶ï¼Œä¸€ä¸ª TextViewï¼Œä¸€ä¸ª ImageViewã€‚æ˜¯çº¿æ€§å¸ƒå±€ã€‚ 5.ç»™æŽ§ä»¶èµ‹å€¼æŽ¥ä¸‹æ¥å†å›žåˆ° adapter æ–‡ä»¶ä¸­çš„ getView æ–¹æ³•ä¸­ï¼Œåœ¨è¿™ä¸ªæ–¹æ³•ä¸­ä¸ºæŽ§ä»¶èµ‹å€¼ã€‚ 12345678910111213141516171819@Override public View getView(final int position, View convertView, ViewGroup parent) &#123;//UI åˆ·æ–°çš„ä»£ç ä¸»è¦åœ¨è¿™é‡Œå®žçŽ° //èŽ·å–è€å¸ˆçš„æ•°æ® final Teacher teacher = mlist.get(position); //æ ¹æ®layoutæ–‡ä»¶åˆ›å»ºå¸ƒå±€ View oneTeacherView = LayoutInflater.from(mContext).inflate(R.layout.teacher_item,parent,false); //èŽ·å–ImageViewå’ŒTextView ImageView imageView = (ImageView) oneTeacherView.findViewById(R.id.item_imageView); TextView textView = (TextView) oneTeacherView.findViewById(R.id.item_textView); //æ ¹æ®æ•°æ®åˆ†åˆ«ä¸ºimageViewå’ŒtextViewèµ‹å€¼ imageView.setImageResource(teacher.getImageID()); textView.setText(teacher.getName()); return oneTeacherView;&#125; 6.è®¾ç½®æ•°æ®æºæŽ¥ä¸‹æ¥å›žåˆ° Activity æ–‡ä»¶ä¸­ï¼ŒèŽ·å– listView å¯¹è±¡ï¼š 12345678910111213141516//å› ä¸ºè¿™é‡Œæ˜¯æœ¬åœ°æ•°æ®ï¼Œæ‰€ä»¥å°† listView è®¾ç½®ä¸ºäº†å±€éƒ¨å˜é‡ï¼Œæœ¬åœ°æ•°æ®ä¹Ÿä¸éœ€è¦åœ¨å¼€å¯çº¿ç¨‹åŽ»åˆ·æ–°UIArrayList&lt;Teacher&gt; teacherList = new ArrayList&lt;Teacher&gt;();Teacher teacher = new Teacher()ï¼›teacher.setName(&quot;jack&quot;);teacher.setImageID(R.mipmap.header_image);teacherList.add(teacher);//æˆ‘è¿™é‡Œåªæ·»åŠ äº†ä¸€æ¡æ•°æ®ï¼Œå¦‚æžœåƒæ·»åŠ çš„è¯ï¼Œæ·»åŠ è¿›è¿™ä¸ªæ•°ç»„å°±è¡ŒListView listView = (ListView)findViewById(R.id.main_listView);TeacherAdapter adapter = new TeacherAdapter(teacherList,this);listView.setAdapter(adapter); åˆ°è¿™é‡Œï¼Œä¸€ä¸ªå®Œæ•´çš„è‡ªå®šä¹‰ item çš„ ListView ç®—æ˜¯å®Œæˆäº†ã€‚ä½†æ˜¯åœ¨å®žé™…å¼€å‘ä¸­ï¼Œå¤§éƒ¨åˆ†çš„åº”ç”¨åœºæ™¯éƒ½æ˜¯ä»Žç½‘ç»œç«¯èŽ·å–æ•°æ®ï¼Œç„¶åŽç»™ ListView èµ‹å€¼ã€‚è¿™ä¸ªç­‰æˆ‘å­¦åˆ°ç½‘ç»œçš„æ—¶å€™å†æ¥ä»‹ç»ä¸€ä¸‹ã€‚ å¦‚æœ‰ä¸å¯¹ä¹‹å¤„ï¼Œè¯·å¤šå¤šæŒ‡æ­£ï¼è¾¾è€…ä¸ºå¸ˆï¼Œè°¢è°¢ï¼]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>android-listView</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Android å“åº”æŒ‰é’®ç‚¹å‡»äº‹ä»¶çš„4ç§å†™æ³•]]></title>
    <url>%2F2017%2F05%2F10%2Fandroid-onClick%2F</url>
    <content type="text"><![CDATA[åœ¨android å¼€å‘ä¸­ï¼ŒæŒ‰é’®å“åº”ç‚¹å‡»äº‹ä»¶æœ‰å››ç§å†™æ³•ã€‚ä¸‹é¢ä¾æ¬¡ä»‹ç»ã€‚ 1. åŒ¿åå†…éƒ¨ç±»è¿™ç§æ–¹å¼ä¸€èˆ¬é€‚ç”¨äºŽè‡ªå·±å†™ demo æµ‹è¯•æ—¶ä½¿ç”¨ï¼Œä¼˜ç‚¹å°±æ˜¯å¿«é€Ÿã€‚ 1234567891011121314@Override protected void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); setContentView(R.layout.activity_register); Button button = (Button)findViewById(R.id.btn); button.setOnClickListener(new View.OnClickListener() &#123; @Override public void onClick(View v) &#123; //å“åº”äº‹ä»¶ &#125; &#125;); &#125; 2. è‡ªå®šä¹‰äº‹ä»¶ç›‘å¬ç±»è¿™ç§æ–¹å¼å’Œç¬¬ä¸€ç§å·®ä¸å¤šï¼Œå”¯ä¸€çš„åŒºåˆ«å°±æ˜¯å°†å“åº”äº‹ä»¶çš„ä»£ç æ”¾åˆ°ä¸€ä¸ªè‡ªå®šä¹‰çš„ç›‘å¬ç±»é‡Œé¢ã€‚ 1234567891011121314151617@Overrideprotected void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); setContentView(R.layout.activity_register); Button button = (Button)findViewById(R.id.btn); button.setOnClickListener(new MyListener()); &#125; //è®©è‡ªå®šä¹‰ç›‘å¬ç±»åŽ»å®žçŽ° View çš„ OnClickListener æŽ¥å£ private class MyListener implements View.OnClickListener &#123; @Override public void onClick(View v) &#123; //å“åº”äº‹ä»¶ &#125; &#125; 3. ç”± Activity å®žçŽ° OnClickListener æŽ¥å£è¿™ç§æ–¹å¼æ˜¯åœ¨é¡¹ç›®ä¸­åº”ç”¨æœ€å¤šçš„å†™æ³•ã€‚å› ä¸ºè¿™ç§å†™æ³•å¯ä»¥å‡å°‘ä»£ç é‡ï¼Œå°¤å…¶æ˜¯åœ¨ Activity ä¸Šæœ‰å¤šä¸ªç‚¹å‡»äº‹ä»¶çš„æ—¶å€™ã€‚ 123456789101112131415161718192021222324public class RegisterActivity extends Activity implements View.OnClickListener &#123; @Override protected void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); setContentView(R.layout.activity_register); Button button = (Button)findViewById(R.id.btn); button.setOnClickListener(this); &#125; public void onClick(View v) &#123; //æ ¹æ® id æ¥åŒºåˆ†åˆ†åˆ«æ˜¯å“ªä¸ªæŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶ switch (v.getId())&#123; case R.id.btn: //å“åº”äº‹ä»¶ break; default: break; &#125; &#125; &#125; 4. åœ¨å¸ƒå±€æ–‡ä»¶ä¸­æ·»åŠ  onClick å±žæ€§è¿™ç§æ–¹å¼ä¸ç”¨åœ¨ Activity ä¸­å£°æ˜Žç»„ä»¶å¯¹è±¡å°±å¯ä»¥å“åº”ç‚¹å‡»äº‹ä»¶ï¼Œè™½ç„¶åœ¨çœ‹èµ·æ¥å¾ˆè½»ä¾¿ï¼Œä½†æ˜¯åœ¨ç»´æŠ¤æµ‹è¯•çš„æ—¶å€™ï¼Œä¸å®¹æ˜“æ‰¾åˆ° button ç›¸å¯¹åº”çš„ç‚¹å‡»äº‹ä»¶ï¼Œæ‰€ä»¥ä¸å¤ªæŽ¨èä½¿ç”¨ã€‚ é¦–å…ˆåœ¨ XML å¸ƒå±€æ–‡ä»¶ä¸­æ·»åŠ  onClick å±žæ€§123456&lt;Button android:onClick=&quot;btnClick&quot; android:layout_width=&quot;wrap_content&quot; android:layout_height=&quot;wrap_content&quot; android:text=&quot;@string/btn&quot; android:id=&quot;@+id/btn&quot; /&gt; åœ¨ Activity ä¸­å®žçŽ°æ–¹æ³•123public void btnClick(View v)&#123; //å“åº”äº‹ä»¶ &#125;]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>onClick</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[React Native é›†æˆåˆ°iOSåŽŸç”Ÿé¡¹ç›®]]></title>
    <url>%2F2017%2F05%2F03%2Frn-integration-iosNative%2F</url>
    <content type="text"><![CDATA[å¦‚æžœä½ æ­£å‡†å¤‡ä»Žå¤´å¼€å§‹åˆ¶ä½œä¸€ä¸ªæ–°çš„åº”ç”¨ï¼Œé‚£ä¹ˆReact Nativeä¼šæ˜¯ä¸ªéžå¸¸å¥½çš„é€‰æ‹©ã€‚ä½†å¦‚æžœä½ åªæƒ³ç»™çŽ°æœ‰çš„åŽŸç”Ÿåº”ç”¨ä¸­æ·»åŠ ä¸€ä¸¤ä¸ªè§†å›¾æˆ–æ˜¯ä¸šåŠ¡æµç¨‹ï¼ŒReact Nativeä¹ŸåŒæ ·ä¸åœ¨è¯ä¸‹ã€‚åªéœ€ç®€å•å‡ æ­¥ï¼Œä½ å°±å¯ä»¥ç»™åŽŸæœ‰åº”ç”¨åŠ ä¸Šæ–°çš„åŸºäºŽReact Nativeçš„ç‰¹æ€§ã€ç”»é¢å’Œè§†å›¾ç­‰ã€‚ æŠŠReact Nativeç»„ä»¶æ¤å…¥åˆ°iOSåº”ç”¨ä¸­æœ‰å¦‚ä¸‹å‡ ä¸ªä¸»è¦æ­¥éª¤ï¼š é¦–å…ˆå½“ç„¶è¦äº†è§£ä½ è¦æ¤å…¥çš„React Nativeç»„ä»¶ã€‚ åˆ›å»ºä¸€ä¸ªPodfileï¼Œåœ¨å…¶ä¸­ä»¥subspecçš„å½¢å¼å¡«å†™æ‰€æœ‰ä½ è¦æ¤å…¥çš„React Nativeçš„ç»„ä»¶ã€‚ åˆ›å»ºjsæ–‡ä»¶ï¼Œç¼–å†™React Nativeç»„ä»¶çš„jsä»£ç ã€‚ æ·»åŠ ä¸€ä¸ªäº‹ä»¶å¤„ç†å‡½æ•°ï¼Œç”¨äºŽåˆ›å»ºä¸€ä¸ªRCTRootViewã€‚è¿™ä¸ªRCTRootViewæ­£æ˜¯ç”¨æ¥æ‰¿è½½ä½ çš„React Nativeç»„ä»¶çš„ï¼Œè€Œä¸”å®ƒå¿…é¡»å¯¹åº”ä½ åœ¨index.ios.jsä¸­ä½¿ç”¨AppRegistryæ³¨å†Œçš„æ¨¡å—åå­—ã€‚ å¯åŠ¨React Nativeçš„PackageræœåŠ¡ï¼Œè¿è¡Œåº”ç”¨ã€‚ æ ¹æ®éœ€è¦æ·»åŠ æ›´å¤šReact Nativeçš„ç»„ä»¶ã€‚ è°ƒè¯•ã€‚ å‡†å¤‡éƒ¨ç½²å‘å¸ƒ ï¼ˆæ¯”å¦‚å¯ä»¥åˆ©ç”¨react-native-xcode.shè„šæœ¬ï¼‰ã€‚ å‘å¸ƒåº”ç”¨ï¼Œå‡èŒåŠ è–ªï¼Œèµ°å‘äººç”Ÿå·…å³°ï¼ðŸ˜˜ åˆ›å»ºä¸€ä¸ªåŽŸç”Ÿåº”ç”¨è¿™ä¸ªå°±ä¸å¤šè¯´ã€‚ æ·»åŠ ä¾èµ–åŒ…React Nativeçš„æ¤å…¥è¿‡ç¨‹åŒæ—¶éœ€è¦Reactå’ŒReact Nativeä¸¤ä¸ªnodeä¾èµ–åŒ…ã€‚æˆ‘ä»¬æŠŠå…·ä½“çš„ä¾èµ–åŒ…è®°å½•åœ¨package.jsonæ–‡ä»¶ä¸­ã€‚å¦‚æžœé¡¹ç›®æ ¹ç›®å½•ä¸­æ²¡æœ‰è¿™ä¸ªæ–‡ä»¶ï¼Œé‚£å°±è‡ªå·±åˆ›å»ºä¸€ä¸ªã€‚ package.jsonæˆ‘è¿™é‡Œçš„åšæ³•æ˜¯åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªä¸“é—¨å­˜æ”¾react nativeç›¸å…³çš„æ–‡ä»¶å¤¹ï¼Œå°±åƒè¿™æ ·ï¼š ç„¶åŽåœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ªpackage.jsonæ–‡ä»¶ï¼Œå°±åƒè¿™æ ·ï¼š åœ¨package.jsonæ–‡ä»¶ä¸­çš„å†…å®¹æ˜¯è¿™æ ·çš„ï¼š 123456789101112&#123; &quot;name&quot;: &quot;NativeRN&quot;, &quot;version&quot;: &quot;0.0.1&quot;, &quot;private&quot;: true, &quot;scripts&quot;: &#123; &quot;start&quot;: &quot;node node_modules/react-native/local-cli/cli.js start&quot; &#125;, &quot;dependencies&quot;: &#123; &quot;react&quot;: &quot;16.0.0-alpha.6&quot;, &quot;react-native&quot;: &quot;0.44.0&quot; &#125;&#125; è§£é‡Šä¸€ä¸‹ï¼š versionå­—æ®µæ²¡æœ‰å¤ªå¤§æ„ä¹‰ï¼ˆé™¤éžä½ è¦æŠŠä½ çš„é¡¹ç›®å‘å¸ƒåˆ°npmä»“åº“ï¼‰ã€‚ scriptsä¸­æ˜¯ç”¨äºŽå¯åŠ¨packageræœåŠ¡çš„å‘½ä»¤ã€‚ dependenciesä¸­çš„reactå’Œreact-nativeçš„ç‰ˆæœ¬å–å†³äºŽä½ çš„å…·ä½“éœ€æ±‚ã€‚ä¸€èˆ¬æ¥è¯´æˆ‘ä»¬æŽ¨èä½¿ç”¨æœ€æ–°ç‰ˆæœ¬ã€‚ä½ å¯ä»¥ä½¿ç”¨npm info reactå’Œnpm info react-nativeæ¥æŸ¥çœ‹å½“å‰çš„æœ€æ–°ç‰ˆæœ¬ã€‚å¦å¤–ï¼Œreact-nativeå¯¹reactçš„ç‰ˆæœ¬æœ‰ä¸¥æ ¼è¦æ±‚ï¼Œé«˜äºŽæˆ–ä½ŽäºŽæŸä¸ªèŒƒå›´éƒ½ä¸å¯ä»¥ã€‚ æœ¬æ–‡æ— æ³•åœ¨è¿™é‡Œåˆ—å‡ºæ‰€æœ‰react nativeå’Œå¯¹åº”çš„reactç‰ˆæœ¬è¦æ±‚ï¼Œåªèƒ½æé†’è¯»è€…å…ˆå°è¯•æ‰§è¡Œnpm installï¼Œç„¶åŽæ³¨æ„è§‚å¯Ÿå®‰è£…è¿‡ç¨‹ä¸­çš„æŠ¥é”™ä¿¡æ¯ï¼Œä¾‹å¦‚require react@æŸ.æŸ.æŸç‰ˆæœ¬, but none was installedï¼Œç„¶åŽæ ¹æ®è¿™æ ·çš„æç¤ºï¼Œæ‰§è¡Œnpm i -S react@æŸ.æŸ.æŸç‰ˆæœ¬ã€‚ å®‰è£…ä¾èµ–åŒ…ä½¿ç”¨npmï¼ˆnodeåŒ…ç®¡ç†å™¨ï¼ŒNode package managerï¼‰æ¥å®‰è£…Reactå’ŒReact Nativeæ¨¡å—ã€‚è¿™äº›æ¨¡å—ä¼šè¢«å®‰è£…åˆ°é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„node_modules/ç›®å½•ä¸­ã€‚ åœ¨åŒ…å«æœ‰package.jsonæ–‡ä»¶çš„ç›®å½•ï¼ˆä¸€èˆ¬ä¹Ÿå°±æ˜¯é¡¹ç›®æ ¹ç›®å½•,æˆ‘è¿™é‡Œå› ä¸ºåˆ›å»ºäº†RNComponentæ–‡ä»¶å¤¹ï¼Œæ‰€ä»¥æ˜¯åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ç›®å½•ä¸‹æ‰§è¡Œè¿™ä¸ªå‘½ä»¤ï¼‰ä¸­è¿è¡Œä¸‹åˆ—å‘½ä»¤æ¥å®‰è£…ï¼š 1$ npm install è¿è¡Œå®ŒæˆåŽä¼šå‡ºçŽ°node_modulesè¿™æ ·ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œè¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹åŒ…å«äº†RNçš„ä¸€äº›æ¨¡å—ï¼Œå°±åƒè¿™æ ·ï¼š React Nativeæ¡†æž¶React Nativeæ¡†æž¶æ•´ä½“æ˜¯ä½œä¸ºnodeæ¨¡å—å®‰è£…åˆ°é¡¹ç›®ä¸­çš„ã€‚ä¸‹ä¸€æ­¥æˆ‘ä»¬éœ€è¦åœ¨CocoaPodsçš„Podfileä¸­æŒ‡å®šæˆ‘ä»¬æ‰€éœ€è¦ä½¿ç”¨çš„ç»„ä»¶ã€‚ Subspecsåœ¨ä½ å¼€å§‹æŠŠReact Nativeæ¤å…¥åˆ°ä½ çš„åº”ç”¨ä¸­ä¹‹å‰ï¼Œé¦–å…ˆè¦å†³å®šå…·ä½“æ•´åˆçš„æ˜¯React Nativeæ¡†æž¶ä¸­çš„å“ªäº›éƒ¨åˆ†ã€‚è€Œè¿™å°±æ˜¯subspecè¦åšçš„å·¥ä½œã€‚åœ¨åˆ›å»ºPodfileæ–‡ä»¶çš„æ—¶å€™ï¼Œéœ€è¦æŒ‡å®šå…·ä½“å®‰è£…å“ªäº›React Nativeçš„ä¾èµ–åº“ã€‚æ‰€æŒ‡å®šçš„æ¯ä¸€ä¸ªåº“å°±ç§°ä¸ºä¸€ä¸ªsubspecã€‚ å¯ç”¨çš„subspecéƒ½åˆ—åœ¨node_modules/react-native/React.podspecä¸­ï¼ŒåŸºæœ¬éƒ½æ˜¯æŒ‰å…¶åŠŸèƒ½å‘½åçš„ã€‚ä¸€èˆ¬æ¥è¯´ä½ é¦–å…ˆéœ€è¦æ·»åŠ Coreï¼Œè¿™ä¸€subspecåŒ…å«äº†å¿…é¡»çš„AppRegistryã€StyleSheetã€Viewä»¥åŠå…¶ä»–çš„ä¸€äº›React Nativeæ ¸å¿ƒåº“ã€‚å¦‚æžœä½ æƒ³ä½¿ç”¨React Nativeçš„Textåº“ï¼ˆå³&lt;Text&gt;ç»„ä»¶ï¼‰ï¼Œé‚£å°±éœ€è¦æ·»åŠ RCTTextçš„subspecã€‚åŒç†ï¼ŒImageéœ€è¦åŠ å…¥RCTImageï¼Œç­‰ç­‰ã€‚ Podfileåœ¨Reactå’ŒReact Nativeæ¨¡å—æˆåŠŸå®‰è£…åˆ°node_modulesç›®å½•ä¹‹åŽï¼Œä½ å°±å¯ä»¥å¼€å§‹åˆ›å»ºPodfileä»¥ä¾¿é€‰æ‹©æ‰€éœ€çš„ç»„ä»¶å®‰è£…åˆ°åº”ç”¨ä¸­ã€‚ åˆ›å»ºpodfileåœ¨è¿™é‡Œä¸åœ¨å¤šè¯´ï¼Œç›¸ä¿¡åªè¦ç”¨è¿‡cocoapodsçš„æœ‹å‹éƒ½çŸ¥é“ã€‚ podfileåˆ›å»ºå®Œæˆä¹‹åŽï¼Œåœ¨æ–‡ä»¶é‡Œæ·»åŠ ä¸€ä¸‹å†…å®¹ï¼š 12345678910111213141516# targetçš„åå­—ä¸€èˆ¬ä¸Žä½ çš„é¡¹ç›®åå­—ç›¸åŒtarget &apos;NativeRN&apos; do # &apos;node_modules&apos;ç›®å½•ä¸€èˆ¬ä½äºŽæ ¹ç›®å½•ä¸­ # ä½†æ˜¯å¦‚æžœä½ çš„ç»“æž„ä¸åŒï¼Œé‚£ä½ å°±è¦æ ¹æ®å®žé™…è·¯å¾„ä¿®æ”¹ä¸‹é¢çš„`:path` pod &apos;React&apos;, :path =&gt; &apos;./RNComponent/node_modules/react-native&apos;, :subspecs =&gt; [ &apos;Core&apos;, &apos;RCTText&apos;, &apos;RCTNetwork&apos;, &apos;RCTWebSocket&apos;, # è¿™ä¸ªæ¨¡å—æ˜¯ç”¨äºŽè°ƒè¯•åŠŸèƒ½çš„ # åœ¨è¿™é‡Œç»§ç»­æ·»åŠ ä½ æ‰€éœ€è¦çš„æ¨¡å— ] # å¦‚æžœä½ çš„RNç‰ˆæœ¬ &gt;= 0.42.0ï¼Œè¯·åŠ å…¥ä¸‹é¢è¿™è¡Œ pod &quot;Yoga&quot;, :path =&gt; &quot;./RNComponent/node_modules/react-native/ReactCommon/yoga&quot;end ç„¶åŽæ‰§è¡Œä¸‹é¢çš„ðŸ‘‡å‘½ä»¤ï¼Œå¼€å§‹å®‰è£…React Nativeçš„podåŒ…ã€‚ 1$ pod install ä»£ç é›†æˆindex.ios.jsé¦–å…ˆåˆ›å»ºä¸€ä¸ªç©ºçš„index.ios.jsæ–‡ä»¶ã€‚ä¸€èˆ¬æ¥è¯´æˆ‘ä»¬æŠŠå®ƒæ”¾ç½®åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ã€‚å°±åƒðŸ‘‡ï¼š index.ios.jsæ˜¯React Nativeåº”ç”¨åœ¨iOSä¸Šçš„å…¥å£æ–‡ä»¶ã€‚è€Œä¸”å®ƒæ˜¯ä¸å¯æˆ–ç¼ºçš„ï¼å®ƒå¯ä»¥æ˜¯ä¸ªå¾ˆç®€å•çš„æ–‡ä»¶ï¼Œç®€å•åˆ°å¯ä»¥åªåŒ…å«ä¸€è¡Œrequire/importå¯¼å…¥è¯­å¥ã€‚ 12# åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œä»¥ä¸‹å‘½ä»¤åˆ›å»ºæ–‡ä»¶ï¼š$ touch index.ios.js æ·»åŠ ä½ è‡ªå·±çš„React Nativeä»£ç 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647import React, &#123; Component &#125; from &apos;react&apos;;import &#123; AppRegistry, StyleSheet, Text, View&#125; from &apos;react-native&apos;;export default class NativeRN extends Component &#123; render() &#123; return ( &lt;View style=&#123;styles.container&#125;&gt; &lt;Text style=&#123;styles.welcome&#125;&gt; Welcome to React Native! &lt;/Text&gt; &lt;Text style=&#123;styles.instructions&#125;&gt; To get started, edit index.ios.js &lt;/Text&gt; &lt;Text style=&#123;styles.instructions&#125;&gt; Press Cmd+R to reload,&#123;&apos;\n&apos;&#125; Cmd+D or shake for dev menu &lt;/Text&gt; &lt;/View&gt; ); &#125;&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, justifyContent: &apos;center&apos;, alignItems: &apos;center&apos;, backgroundColor: &apos;#F5FCFF&apos;, &#125;, welcome: &#123; fontSize: 20, textAlign: &apos;center&apos;, margin: 10, &#125;, instructions: &#123; textAlign: &apos;center&apos;, color: &apos;#333333&apos;, marginBottom: 5, &#125;,&#125;);AppRegistry.registerComponent(&apos;NativeRN&apos;, () =&gt; NativeRN); é›†æˆåˆ°åŽŸç”Ÿé¡¹ç›®ä¸­æˆ‘è¿™é‡Œå…ˆåˆ›å»ºäº†ä¸€ä¸ªViewControllerï¼ŒðŸ‘‡è¿™æ ·ï¼š ç„¶åŽå¯¼å…¥#import &lt;RCTRootView.h&gt;å¤´æ–‡ä»¶,ðŸ‘‡è¿™æ ·ï¼š 1234567891011121314- (void)viewDidLoad &#123; [super viewDidLoad]; // Do any additional setup after loading the view. NSString * strUrl = @&quot;http://localhost:8081/index.ios.bundle?platform=ios&amp;dev=true&quot;; NSURL * jsCodeLocation = [NSURL URLWithString:strUrl]; RCTRootView * rootView = [[RCTRootView alloc] initWithBundleURL:jsCodeLocation moduleName:@&quot;NativeRN&quot; initialProperties:nil launchOptions:nil]; self.view = rootView; &#125; è¿˜éœ€è¦åœ¨info.plistæ–‡ä»¶ä¸­é…ç½®ä¸€ä¸‹ï¼š 1234567891011&lt;key&gt;NSAppTransportSecurity&lt;/key&gt; &lt;dict&gt; &lt;key&gt;NSExceptionDomains&lt;/key&gt; &lt;dict&gt; &lt;key&gt;localhost&lt;/key&gt; &lt;dict&gt; &lt;key&gt;NSTemporaryExceptionAllowsInsecureHTTPLoads&lt;/key&gt; &lt;true/&gt; &lt;/dict&gt; &lt;/dict&gt; &lt;/dict&gt; é…ç½®åŽçš„æ•ˆæžœï¼š è¿è¡Œé¡¹ç›®åœ¨è¿è¡Œé¡¹ç›®å‰ï¼Œå…ˆåœ¨react nativeæ–‡ä»¶å¤¹ç›®å½•ä¸‹ï¼Œå¯åŠ¨å¼€å‘æœåŠ¡å™¨ã€‚ä¹Ÿå°±æ˜¯åœ¨æœ¬æ–‡ä¸­çš„RNComponentç›®å½•ä¸‹ï¼Œå¯åŠ¨å‘½ä»¤è¡Œï¼š 1$ npm start è¿è¡Œé¡¹ç›®ï¼Œçœ‹åˆ°æ•ˆæžœï¼š]]></content>
      <categories>
        <category>react-nativeå­¦ä¹ ç¬”è®°</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[ä¸æ€è€ƒï¼Œä¸è¯»ä¹¦]]></title>
    <url>%2F2017%2F05%2F03%2Fstudying-thinking%2F</url>
    <content type="text"><![CDATA[è¶Šæ¥è¶Šæ„Ÿè§‰è„‘å­ä¸å¤Ÿç”¨äº†ã€‚æœ€è¿‘åœ¨å­¦ä¹ ä¸€äº›æ–°çš„ä¸œè¥¿ï¼Œä¹Ÿè®¸æ˜¯è‡ªå·±çš„åŸºç¡€ä¸æ‰Žå®žï¼Œå¯¼è‡´å­¦èµ·æ¥å¾ˆä¹±ï¼Œæ²¡æœ‰ä¾§é‡ç‚¹ï¼Œå®Œå®Œå…¨å…¨å°±æ˜¯ä¸€å›¢ä¹±éº»ã€‚å¸¸å¸¸æ˜¯åˆšåˆšæƒ³å‡ºæ¥ä¸€ä¸ªè§£å†³åŠžæ³•ï¼Œç»§ç»­å¾€ä¸‹å†™çš„æ—¶å€™ï¼Œçªç„¶å‘çŽ°ä¹‹å‰çš„æ–¹æ³•ä¸å¤ªå¥½ï¼Œç„¶åŽå°±æŽ¨ç¿»é‡æ¥ï¼Œå¦‚æ­¤å¾ªçŽ¯å¾€å¤ï¼Œæ²¡æœ‰çœ‹åˆ°ä¸€ç‚¹æ˜¾è‘—çš„æˆæžœï¼Œæ‰è®©æˆ‘å¿ƒç”Ÿç„¦è™‘ã€‚ æœ€è¿‘è¿˜æœ‰ä¸€ä»¶äº‹æƒ…ä½¿æˆ‘éžå¸¸è‹¦æ¼ï¼Œå…¶å®žä¹Ÿç®—ä¸ä¸Šè‹¦æ¼ï¼Œå½’æ ¹ç»“åº•çš„åŽŸå› å°±æ˜¯å› ä¸ºè‡ªå·±è´ªçŽ©ã€‚æ˜¯è¿™æ ·çš„ï¼ŒçŽ°åœ¨ã€ŠçŽ‹è€…è£è€€ã€‹è¿™æ¬¾æ‰‹æ¸¸ç®€ç›´æ˜¯ç«çš„ä¸å¾—äº†ï¼Œæˆ‘ä¹Ÿæœªèƒ½å…å—å…¶å®³ã€‚å¯æ¸¸æˆè¿™ä¸œè¥¿ï¼ŒçŽ©å¤šäº†çœŸçš„ä¼šä¸Šç˜¾ï¼Œæ‰€ä»¥æœ€è¿‘èŠ±åœ¨æ¸¸æˆä¸Šçš„æ—¶é—´æœ‰ç‚¹å¤šã€‚ä¸€æ–¹é¢æ…¨å¹äºŽå…‰é˜´çš„æ˜“é€ï¼Œè€Œå¦ä¸€æ–¹é¢è¿˜åœ¨å¬å”¤å¸ˆå³¡è°·é‡Œå¿˜æƒ…åŽ®æ€ã€‚ä¹‹å‰å¸è½½è¿‡å‡ æ¬¡ï¼Œç‹ è¯ä¹Ÿè¯´äº†å¾ˆå¤šï¼Œå¯å°±æ˜¯æŽ§åˆ¶ä¸ä½è‡ªå·±ã€‚æ€æ¥æƒ³åŽ»ï¼Œè‡ªå·±å°±æ˜¯å¤ªçˆ±çŽ©äº†ï¼Œä¹Ÿå¤ªæ²¡æœ‰è‡ªåˆ¶åŠ›äº†ã€‚æœ€è¿‘æƒ³åˆ°ä¸€ä¸ªåŠžæ³•ï¼Œå°±æ˜¯ç”¨è¯»ä¹¦æ¥è½¬ç§»çŽ©æ¸¸æˆçš„æ³¨æ„åŠ›ã€‚æš‚æ—¶è¿˜ä¸çŸ¥é“ç®¡ä¸ç®¡ç”¨ï¼Œä»¥åŽé™¤äº†å·¥ä½œï¼Œè¦å°½å¯èƒ½çš„æ‘†è„±å¯¹æ‰‹æœºçš„ä¾èµ–ï¼Œå¤šåŽ»è¯»ä¹¦ï¼Œå¤šåŽ»æ€è€ƒï¼Œå¤šå‡ºåŽ»èµ°èµ°ã€‚ ä¹‹å‰çœ‹è¿‡ä¸€ä¸ªèŠ‚ç›®ï¼Œé‡Œé¢æœ‰äººè®²åˆ°â€œè¯»ä¹¦æ°¸ä¸æ¯•ä¸šâ€ï¼Œæˆ‘è§‰å¾—è¯´çš„æŒºå¯¹çš„ã€‚ä¸­å›½ä¸ä¹Ÿæœ‰å¥è€è¯å«â€œæ´»åˆ°è€ï¼Œå­¦åˆ°è€â€å—ï¼Ÿå°±æˆ‘è‡ªå·±æ¥è®²ï¼Œå­¦ä¹ å¯ä»¥ä½¿æˆ‘è§‰å¾—æˆ‘çš„å¤§è„‘è¿˜å¯ä»¥æ€æƒ³ï¼Œè¿˜åœ¨è¿è½¬ï¼Œå†è¯´å¤§ä¸€ç‚¹ï¼Œå°±æ˜¯è¿˜èƒ½æ„Ÿè§‰åˆ°è‡ªå·±æ´»ç€ã€‚å€˜è‹¥è®©æˆ‘æ¯å¤©é‡å¤çš„ï¼Œæœºæ¢°çš„åšä¸€äº›äº‹æƒ…ï¼Œè€Œæ²¡æœ‰æ—¶é—´åŽ»æ€è€ƒï¼Œæˆ‘è‚¯å®šä¼šå—ä¸äº†ã€‚æœ‰æ—¶å€™ä»”ç»†æƒ³æƒ³ï¼Œä¸‡ä¸€çœŸçš„æœ‰ä¸€å¤©ï¼Œè‡ªå·±çš„å¤§è„‘åœæ­¢æ€æƒ³äº†ï¼ŒçœŸçš„æ˜¯æŒºå¯æ€•çš„ä¸€ä»¶äº‹ã€‚ä¹‹æ‰€ä»¥é•¿ä¸ªè„‘å­ï¼Œä¸å°±æ˜¯ç”¨æ¥æ€è€ƒçš„å—ï¼Ÿå­¦ä¹ ï¼Œæ€è€ƒï¼ŒçœŸçš„æ˜¯ä¸€ç”Ÿéƒ½éœ€è¦åšçš„ä¸€ä»¶äº‹ã€‚ å¹´è½»çš„å¤§å¥½å…‰é˜´ï¼Œä¸ç”¨æ¥å­¦ä¹ ï¼Œå¾ˆå¯æƒœï¼Œä¸æ˜¯å—ï¼Ÿ]]></content>
      <categories>
        <category>ç”Ÿæ´»</category>
      </categories>
      <tags>
        <tag>è¯»ä¹¦ï¼Œæ€è€ƒ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[React-Native Fetchç½‘ç»œè¯·æ±‚]]></title>
    <url>%2F2017%2F04%2F27%2Freact-native-fetch%2F</url>
    <content type="text"><![CDATA[åœ¨react-nativeå¼€å‘ä¸­ï¼Œä½¿ç”¨Fetchè¿›è¡Œç½‘ç»œè¯·æ±‚ã€‚å®˜æ–¹æ–‡æ¡£ä¸Šçš„ç½‘ç»œè¯·æ±‚ åŸºæœ¬ä½¿ç”¨æ–¹æ³•GETè¯·æ±‚123456789fetch(@&quot;http://www.baidu.com&quot;) .then((response) =&gt; response.json()) .then((responseJson) =&gt; &#123; console.log(responseJson);//æ‰“å°è¿”å›žçš„æ•°æ® &#125;); &#125;) .catch((error)=&gt;&#123; console.log(error);//æ‰“å°æŠ¥çš„é”™ &#125;) catchä½fetchå¯èƒ½æŠ›å‡ºçš„å¼‚å¸¸ï¼Œå¦åˆ™å‡ºé”™æ—¶ä½ å¯èƒ½çœ‹ä¸åˆ°ä»»ä½•æç¤ºã€‚ POSTè¯·æ±‚Fetchè¿˜æœ‰å¯é€‰çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œå¯ä»¥ç”¨æ¥å®šåˆ¶HTTPè¯·æ±‚ä¸€äº›å‚æ•°ã€‚ä½ å¯ä»¥æŒ‡å®šheaderå‚æ•°ï¼Œæˆ–æ˜¯æŒ‡å®šä½¿ç”¨POSTæ–¹æ³•ï¼Œåˆæˆ–æ˜¯æäº¤æ•°æ®ç­‰ç­‰ï¼š 1234567891011fetch(&apos;https://mywebsite.com/endpoint/&apos;, &#123; method: &apos;POST&apos;, headers: &#123; &apos;Accept&apos;: &apos;application/json&apos;, &apos;Content-Type&apos;: &apos;application/json&apos;, &#125;, body: JSON.stringify(&#123; firstParam: &apos;yourValue&apos;, secondParam: &apos;yourOtherValue&apos;, &#125;)&#125;) å¦‚æžœä½ çš„æœåŠ¡å™¨æ— æ³•è¯†åˆ«ä¸Šé¢POSTçš„æ•°æ®æ ¼å¼ï¼Œé‚£ä¹ˆå¯ä»¥å°è¯•ä¼ ç»Ÿçš„formæ ¼å¼ï¼š 1234567fetch(&apos;https://mywebsite.com/endpoint/&apos;, &#123; method: &apos;POST&apos;, headers: &#123; &apos;Content-Type&apos;: &apos;application/x-www-form-urlencoded&apos;, &#125;, body: &apos;key1=value1&amp;key2=value2&apos;&#125;) å¯ä»¥å‚è€ƒFetchè¯·æ±‚æ–‡æ¡£æ¥æŸ¥çœ‹æ‰€æœ‰å¯ç”¨çš„å‚æ•°ã€‚ ç®€å•å°è£…GET12345678910111213141516171819202122232425262728/* * getè¯·æ±‚ * url:è¯·æ±‚åœ°å€ * params:å‚æ•° * callback:å›žè°ƒå‡½æ•° * */ static get(url,params,callback)&#123; if (params) &#123; let paramsArray = []; //æ‹¼æŽ¥å‚æ•° Object.keys(params).forEach(key =&gt; paramsArray.push(key + &apos;=&apos; + params[key])) if (url.search(/\?/) === -1) &#123; url += &apos;?&apos; + paramsArray.join(&apos;&amp;&apos;) &#125; else &#123; url += &apos;&amp;&apos; + paramsArray.join(&apos;&amp;&apos;) &#125; &#125; //fetchè¯·æ±‚ fetch(url,&#123; method: &apos;GET&apos;, &#125;) .then((response) =&gt; &#123; callback(response) &#125;) .catch((error) =&gt; &#123; alert(error) &#125;); &#125; POSTpostæœ‰ä¸¤ç§å½¢å¼ï¼š ç¬¬ä¸€ç§ï¼šâ€™Content-Typeâ€™: â€˜application/jsonâ€™ 123456789101112131415161718192021222324/* * postè¯·æ±‚ * url:è¯·æ±‚åœ°å€ * params:å‚æ•°,è¿™é‡Œçš„å‚æ•°æ ¼å¼æ˜¯ï¼š&#123;param1: &apos;value1&apos;,param2: &apos;value2&apos;&#125; * callback:å›žè°ƒå‡½æ•° * */ static postJSON(url,params,callback)&#123; //fetchè¯·æ±‚ fetch(url,&#123; method: &apos;POST&apos;, headers: &#123; &apos;Accept&apos;: &apos;application/json&apos;, &apos;Content-Type&apos;: &apos;application/json&apos;, &#125;, body:JSON.stringify(params) &#125;) .then((response) =&gt; response.json()) .then((responseJSON) =&gt; &#123; callback(responseJSON) &#125;) .catch((error) =&gt; &#123; console.log(&quot;error = &quot; + error) &#125;); &#125; ç¬¬äºŒç§ï¼š formè¡¨å•å½¢å¼ 1234567891011121314151617181920212223/* * postè¯·æ±‚ * url:è¯·æ±‚åœ°å€ * params:å‚æ•°,è¿™é‡Œçš„å‚æ•°è¦ç”¨è¿™ç§æ ¼å¼ï¼š&apos;key1=value1&amp;key2=value2&apos; * callback:å›žè°ƒå‡½æ•° * */ static postForm(url,params,callback)&#123; //fetchè¯·æ±‚ fetch(url,&#123; method: &apos;POST&apos;, headers: &#123; &apos;Content-Type&apos;: &apos;application/x-www-form-urlencoded&apos;, &#125;, body: params &#125;) .then((response) =&gt; response.json()) .then((responseJSON) =&gt; &#123; callback(responseJSON) &#125;) .catch((error) =&gt; &#123; console.log(&quot;error = &quot; + error) &#125;); &#125; è°ƒç”¨12345678910111213//postè¯·æ±‚let params = &#123;&apos;key1&apos;:&apos;value1&apos;,&apos;key2&apos;:&apos;value2&apos;&#125;; NetRequest.postJSON(&apos;http://www.baidu.com/&apos;,params,function (set) &#123; //ä¸‹é¢çš„å°±æ˜¯è¯·æ±‚æ¥çš„æ•°æ® console.log(set) &#125;) //getè¯·æ±‚,ä»¥ç™¾åº¦ä¸ºä¾‹,æ²¡æœ‰å‚æ•°,æ²¡æœ‰header NetRequest.get(&apos;https://www.baidu.com/&apos;,&apos;&apos;,function (set) &#123; //ä¸‹é¢æ˜¯è¯·æ±‚ä¸‹æ¥çš„æ•°æ® console.log(set) &#125;) è§£é‡Šä¸€ä¸‹ï¼š 12345//å°†`JSON`æ•°æ®è½¬æ¢æˆå­—ç¬¦ä¸²JSON.stringify(params)//å°†æ•°æ®JSONåŒ–JSON.parse(responseJSON)]]></content>
      <categories>
        <category>react-nativeå­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>fetch</tag>
        <tag>rnç½‘ç»œè¯·æ±‚</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[iOS èŽ·å–crashæ—¥å¿—]]></title>
    <url>%2F2017%2F04%2F21%2FgetCrashBlog%2F</url>
    <content type="text"><![CDATA[åœ¨é¡¹ç›®ä¸Šæž¶åˆ°App Storeä»¥åŽï¼Œè°ä¹Ÿä¸èƒ½ä¿è¯æ²¡æœ‰ä¸€ä¸ªé”™è¯¯ï¼Œå¯èƒ½åœ¨æµ‹è¯•æœŸé—´è¿žæµ‹è¯•äººå‘˜éƒ½æ²¡æœ‰å‘çŽ°çš„éšè—å°bugåœ¨ä¸Šçº¿ä¹‹åŽè¢«ç”¨æˆ·å‘çŽ°äº†ï¼Œè¿™å°±æ— ç–‘ç»™ç”¨æˆ·é€ æˆäº†å›°æ‰°ã€‚æ‰€ä»¥ä½œä¸ºå¼€å‘äººå‘˜ï¼Œè¦åŠæ—¶çš„æ”¶é›†è¿™äº›crashæ—¥å¿—ä¿¡æ¯ï¼Œç„¶åŽä¿®å¤è¿™äº›é—®é¢˜ã€‚ è¿™é‡Œæˆ‘ç”¨äº†ä¸€ç§æ–¹æ³•ï¼Œå°±æ˜¯å½“åº”ç”¨åœ¨ç”¨æˆ·ä½¿ç”¨æ—¶å‘ç”Ÿå´©æºƒçŽ°è±¡ï¼Œä¼šèŽ·å–åˆ°å´©æºƒçš„æ—¥å¿—ï¼Œç„¶åŽè°ƒèµ·é‚®ç®±è®©ç”¨æˆ·é€šè¿‡é‚®ä»¶å‘é€ç»™æˆ‘ä»¬ã€‚ å…·ä½“ä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516#pragma mark - èŽ·å–å¼‚å¸¸æ—¥å¿—- (void)installUncaughtExceptionHandler &#123; NSSetUncaughtExceptionHandler(&amp;UncaughtExceptionHandler);&#125;void UncaughtExceptionHandler(NSException *exception) &#123; NSArray *arr = [exception callStackSymbols]; NSString *reason = [exception reason]; NSString *name = [exception name]; NSString *currentVersion = [[[NSBundle mainBundle] infoDictionary] objectForKey:@&quot;CFBundleVersion&quot;]; NSString *urlStr = [NSString stringWithFormat:@&quot;mailto://developer@qq.com?subject=CrashæŠ¥å‘Š&amp;body=æ‚¨çš„å»ºè®®ä¼šè®©æˆ‘ä»¬åšçš„æ›´å¥½ï¼Œæ„Ÿè°¢æ‚¨çš„é…åˆï¼&lt;br&gt;&lt;br&gt;&lt;br&gt;&quot;&quot;é”™è¯¯è¯¦æƒ…(%@):&lt;br&gt;%@&lt;br&gt;-----------------------&lt;br&gt;%@&lt;br&gt;---------------------&lt;br&gt;%@&quot;,currentVersion,name,reason,[arr componentsJoinedByString:@&quot;&lt;br&gt;&quot;]]; NSURL *url = [NSURL URLWithString:[urlStr stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]]; [[UIApplication sharedApplication]openURL:url];&#125; ç„¶åŽåœ¨AppDelegateé‡Œçš„ 123456- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions&#123;//èŽ·å–å¼‚å¸¸æŠ¥å‘Š [self installUncaughtExceptionHandler];&#125; æ–¹æ³•ä¸­è°ƒç”¨å°±å¯ä»¥äº†ã€‚]]></content>
      <categories>
        <category>iOS å®žç”¨</category>
      </categories>
      <tags>
        <tag>Crash Blog</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ARCä¸‹çš„å†…å­˜æ³„æ¼]]></title>
    <url>%2F2017%2F04%2F18%2FARCMemoryLeak%2F</url>
    <content type="text"><![CDATA[å·²ä¹ æƒ¯äºŽarcå¸®æˆ‘ä»¬ç®¡ç†å†…å­˜çš„æˆ‘ä»¬ï¼Œå†™èµ·ä»£ç æ¥ï¼Œæ¯”MRCä¼¼ä¹Žè‚†æ„å¦„ä¸ºäº†è®¸å¤šï¼Œæ€»æœ‰äº›æœ‰æƒæ— æçš„æ„Ÿè§‰ï¼Œå…¶å®žarcä¸‹é¢è¿˜æ˜¯å¾ˆå®¹æ˜“å¼•èµ·å†…å­˜æº¢å‡ºçš„ã€‚ ARC æ˜¯å¸®åŠ©æˆ‘ä»¬åšå¯¹è±¡å†…å­˜ç®¡ç†çš„ä¸€å¥—æœºåˆ¶ï¼Œä½¿å¾—æˆ‘ä»¬ä»¥å‰åœ¨ MRC æ¨¡å¼ä¸‹ç®¡ç†å†…å­˜å·¥ä½œé‡èƒ½åœ¨ ARC æ¨¡å¼ä¸‹å¾—åˆ°ç¼“è§£ã€‚æ­£å¦‚è‹¹æžœå®˜æ–¹æ–‡æ¡£ä¸Šæ‰€æè¿°çš„ï¼šAutomatic Reference Counting (ARC) is a compiler feature that provides automatic memory management of Objective-C objects.å¯è§ ARC æ˜¯ç¼–è¯‘æ—¶ç‰¹æ€§ï¼Œå®ƒæ²¡æœ‰æ”¹å˜ Objective-C å¼•ç”¨è®¡æ•°å¼å†…å­˜ç®¡ç†çš„æœ¬è´¨ï¼Œæ›´ä¸æ˜¯ GCï¼ˆåžƒåœ¾å›žæ”¶ï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´åªè¦æˆ‘ä»¬ç¨ä¸æ³¨æ„ï¼Œéšå¼çš„æŒæœ‰æˆ–å¤åˆ¶å¯¹è±¡å°±ä¼šé€ æˆå†…å­˜æ³„éœ²ã€‚ NSNotificationcenter1[[NSNotificationCenter defaultCenter]addObserver:self selector:@selector(method:) name:@&quot;notiName&quot; object:nil]; è¿™é‡Œæ·»åŠ è§‚å¯Ÿè€…å…¶å®žæ˜¯ä¸ä¼šé€ æˆå†…å­˜æ³„æ¼çš„ï¼Œä½†æ˜¯ï¼Œä½†æ˜¯ï¼Œä½†æ˜¯â€¦â€¦å¦‚æžœselfè¢«é”€æ¯ï¼Œå½“åœ¨è°ƒç”¨postæ¶ˆæ¯çš„æ—¶å€™ï¼Œå°±ä¼šæŠ¥å¯¹è±¡è¢«é‡Šæ”¾çš„é”™è¯¯ï¼Œå¯¼è‡´é—ªé€€ï¼Œæ‰€ä»¥åœ¨æ·»åŠ è§‚å¯Ÿè€…çš„å¯¹è±¡ï¼Œä¸€å®šè¦åœ¨å®ƒè¢«é”€æ¯çš„æ—¶å€™ä»Žæ¶ˆæ¯ä¸­å¿ƒåˆ é™¤ï¼ å°±æ˜¯åœ¨æ³¨å†Œé€šçŸ¥çš„åœ°æ–¹åŠ ä¸Šè¿™ä¸ªï¼š 1234- (void)dealloc &#123; [[NSNotificationCenter defaultCenter]removeObserver:self];&#125; NSTimer1timer = [NSTimer scheduledTimerWithTimeInterval:1 target:self selector:@selector(method:) userInfo:nil repeats:YES]; ä¸Šé¢çš„timerä¸ºäº†é˜²æ­¢ target è¢«é‡Šæ”¾è€Œå¯¼è‡´çš„ç¨‹åºå¼‚å¸¸ï¼Œtimer ä¼šæŒæœ‰ targetï¼Œ self æŒæœ‰ timerï¼Œtimer åœ¨åˆå§‹åŒ–æ—¶æŒæœ‰ selfï¼Œé€ æˆå¾ªçŽ¯å¼•ç”¨ã€‚è§£å†³çš„æ–¹æ³•å°±æ˜¯ä½¿ç”¨ invalidate æ–¹æ³•é”€æŽ‰ timerã€‚ delegateå±žæ€§çš„å¼ºå¼•ç”¨æŠŠdelegateå£°æ˜Žä¸ºstrongå±žæ€§å®¹æ˜“å¯¼è‡´å†…å­˜æº¢å‡º ã€‚ è§£å†³åŠžæ³•æ˜¯æŠŠdelegateå±žæ€§çš„strongæ”¹ä¸ºassignæˆ–è€…weakå³å¯ã€‚ å½“ç”¨weakæˆ–assignä¿®é¥°çš„æ—¶å€™ï¼ŒæŒ‡æ˜Žè¯¥å¯¹è±¡å¹¶ä¸è´Ÿè´£ä¿æŒdelegateè¿™ä¸ªå¯¹è±¡ï¼Œdelegateè¿™ä¸ªå¯¹è±¡çš„é”€æ¯ç”±å¤–éƒ¨æŽ§åˆ¶ã€‚ å½“ç”¨strongä¿®é¥°çš„æ—¶å€™ï¼Œè¯¥å¯¹è±¡å¼ºå¼•ç”¨delegateï¼Œå¤–ç•Œä¸èƒ½é”€æ¯delegateå¯¹è±¡ï¼Œä¼šå¯¼è‡´å¾ªçŽ¯å¼•ç”¨(Retain Cycles)ã€‚ WKWebView1[_webView.configuration.userContentController addScriptMessageHandler:self name:clickName]; æ·»åŠ addScriptMessageHandlerä¹‹åŽï¼Œå¿…é¡»åœ¨vcé”€æ¯å‰æŠŠå®ƒç§»é™¤ã€‚ 1[_webView.configuration.userContentController removeScriptMessageHandlerForName:clickName]; å’ŒNSNotification å¾ˆç±»ä¼¼ã€‚ Block ä¸Šé¢å›¾ç‰‡ä¸­å°±æ˜¯ä¸€å…¸åž‹æ¡ˆä¾‹ï¼Œçº¢è‰²éƒ¨åˆ†å°±æ˜¯ä¿®æ”¹ä¹‹å‰å¯¼è‡´å†…å­˜æº¢å‡ºçš„ä»£ç ï¼Œæˆ‘ä»¬æ¥åˆ†æžä¸€ä¸‹ï¼š ä¸Šé¢çš„success blockåº”è¯¥æ˜¯selfæŒæœ‰ï¼Œè€Œåœ¨successä¸­æœ‰æŒæœ‰äº†selfï¼Œå¯¼è‡´selfå’Œ block çš„å¾ªçŽ¯å¼•ç”¨ï¼Œé€ æˆå†…å­˜æ³„éœ²ï¼ è¯´åˆ°åº•è¿˜æ˜¯é€ æˆäº†å¾ªçŽ¯å¼•ç”¨å¯¼è‡´äº†å†…å­˜æ³„æ¼ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æ‰“ç ´å¾ªçŽ¯ï¼Œé‡Šæ”¾å¯¹è±¡ï¼Œè¿™é‡Œæˆ‘ä»¬æŠŠselfå˜æˆäº†å¼±å¼•ç”¨ï¼Œæ‰“ç ´å¾ªçŽ¯å¼•ç”¨ã€‚ ä»¥ä¸Šå‡ ç§æƒ…å†µå¯èƒ½é€šè¿‡instrument æ˜¯æŸ¥çœ‹ä¸å‡ºæ¥çš„ï¼Œè‡³å°‘æ˜¯æ²¡æœ‰å°çº¢å‰çš„ã€‚æˆ‘ä»¬é€šè¿‡instrumentsæŸ¥çœ‹æ‰€æœ‰VCçš„å¼•ç”¨è®¡æ•°æ‰æ‰¾åˆ°é‚£äº›VCæ˜¯å‘ç”Ÿäº†å†…å­˜æ³„éœ²ã€‚ å‚è€ƒä»–çš„]]></content>
      <categories>
        <category>iOS å®žç”¨</category>
      </categories>
      <tags>
        <tag>ARCå†…å­˜æ³„æ¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é‡‘å±±åŸŽå¸‚æ²™æ»©æ¸¸]]></title>
    <url>%2F2017%2F04%2F16%2FvisitJinShanCityBeach%2F</url>
    <content type="text"><![CDATA[ä¸€å¤§æ—©å°±ä»ŽåºŠä¸Šçˆ¬èµ·æ¥ï¼Œå·²ç»å¾ˆä¹…éƒ½æ²¡æœ‰èµ·çš„è¿™ä¹ˆæ—©äº†ï¼Œæ´—æ¼±å®Œæ¯•ï¼Œå‡†å¤‡å‡ºå‘ã€‚èªæ˜Žçš„æˆ‘å·²ç»äºŽæ˜¨æ™šæŸ¥å¥½äº†è·¯çº¿ï¼Œç¡®è®¤æ— è¯¯åŽï¼Œæ­£å¼å‡ºå‘ã€‚ å¯¹äºŽå¤§æµ·ï¼Œæ—©å°±å‘å¾€ä¹‹ï¼Œä¹‹å‰ä¸çŸ¥é“ä¸Šæµ·çš„ä»€ä¹ˆåœ°æ–¹å¯ä»¥çœ‹åˆ°ï¼Œä¸€ç›´è€½ææœªæˆè¡Œã€‚ä½†çŽ°åœ¨ä¸‡äº‹ä¿±å¤‡ï¼Œåˆæ°é€¢è¿™ä¸‰å››æœˆèˆ’çˆ½çš„å­£èŠ‚ï¼Œè¿˜çŠ¹è±«ä»€ä¹ˆå‘¢ï¼Ÿ å¯¹äºŽæˆ‘è¿™æ ·ä¸€ä¸ªåœ¨ä¸­åŽŸé•¿å¤§çš„å­©å­ï¼Œé«˜å±±ã€å¤§æµ·éƒ½å¯ä»¥è®©æˆ‘æƒŠå¥‡ä¸å·²ï¼ˆè¯´å‡ºæ¥å¾ˆå°´å°¬ï¼Œè¿˜æ˜¯åœ¨åŽ»å¹´æ‰çœŸæ­£çš„çˆ¬äº†ä¸€æ¬¡å±±ï¼‰ã€‚è™½ç„¶å¾ˆç´¯ï¼Œä½†å¿ƒæ„¿å·²äº†ã€‚è¯´çœŸçš„ï¼Œæˆ‘æ˜¯ç‰¹åˆ«å–œæ¬¢è¿™ç§å±±å±±æ°´æ°´çš„è‡ªç„¶é£Žå…‰ï¼Œä¸€æ–¹é¢æ…¨å¹äºŽå¤§è‡ªç„¶çš„é¬¼æ–§ç¥žå·¥ï¼Œå¦ä¸€æ–¹é¢å¯ä»¥ä½¿è‡ªå·±æ”¾æ¾èº«å¿ƒï¼Œå¿ƒæ—·ç¥žæ€¡ã€‚å¸¦ç€å¯¹å¤§æµ·çš„æœŸè®¸ï¼Œåœ¨è½¦ä¸Šç¡ç€äº†ã€‚ã€‚ã€‚ é‡‘å±±è¿™ä¸ªåœ°æ–¹è·ç¦»æˆ‘ä½çš„åœ°æ–¹çœŸçš„å¾ˆè¿œï¼Œä»Ž747æ¢åˆ°äº†ä¸ŠçŸ³çº¿ï¼Œåä¸Šæ²¡å¤šä¹…æˆ‘å°±ç¡ç€äº†ï¼Œä¸­é—´é†’äº†å¥½å‡ æ¬¡ï¼Œç«Ÿç„¶è¿˜æ²¡æœ‰åˆ°ï¼Œç„¶åŽå°±æ— èŠçš„çŽ©æ‰‹æœºäº†ã€‚ä¸çŸ¥é“è¿‡äº†å¤šä¹…ï¼Œç»ˆäºŽåˆ°äº†ã€‚ä¸‹è½¦æ²¡èµ°å¤šä¹…å°±çœ‹åˆ°äº†4å·å£ï¼Œèµ°è¿‘æ‰å‘çŽ°æ˜¯å‡ºå£ï¼Œåªè®©å‡ºä¸è®©è¿›ï¼ˆåªå¥½æ”¹é“å’¯ï¼‰ï¼é—®äº†å‡ºå£çš„ä¿å®‰ï¼Œç»™æŒ‡äº†æŒ‡5å·å£çš„æ–¹å‘ï¼Œå¤§è¸æ­¥çš„å‰è¿›å§ï¼åˆ°äº†ä¹‹åŽï¼ŒæŽé’±ä¹°ç¥¨ã€‚ã€‚ã€‚ç­‰ç­‰ï¼Œï¼Œï¼Œæ²¡å¸¦é’±ï¼Ÿï¼Ÿï¼Ÿç¿»éäº†å…¨èº«çš„å£è¢‹ï¼Œæ‰¾åˆ°äº†ä¸‰å—é’±ï¼ˆä¸¤ä¸ªç¡¬å¸å’Œä¸€å¼ çº¸å¸ï¼‰ã€‚WTF!è¿™ä¸‹å¯æ€Žä¹ˆåŠžï¼Œä¸è¿‡ï¼Œç»åŽ†è¿‡å¤§é£Žå¤§æµªçš„æˆ‘ï¼Œæ€Žä¹ˆå¯èƒ½è®©è¿™ç‚¹å°äº‹éš¾å€’ã€‚çž¬é—´å°±æƒ³åˆ°äº†è¿™æ˜¯21ä¸–çºªï¼ŒæŽ¥ç€åœ¨ç”µå…‰çŸ³ç«é—´å°±æƒ³åˆ°å¯ä»¥ç¾Žå›¢å•Šã€‚å“ˆå“ˆå“ˆï¼Œè¿™ç‚¹å°äº‹æ€Žä¹ˆå¯èƒ½éš¾å€’æˆ‘ã€‚ç„¶è€Œï¼Œå”®ç¥¨çš„å¦¹å­ï¼ˆè™½ç„¶ä»¥æˆ‘çš„çœ¼åŠ›ä¸€çœ¼çœ‹ä¸å‡ºå¥¹çš„å¹´é¾„ï¼Œå§‘ä¸”å«å¥¹å¤§å¦¹å­å§ï¼‰å‘Šè¯‰æˆ‘è¿™ä¸ªå…¥å£ç½‘ä¸Šè®¢çš„ç¥¨ä¸èƒ½è¿›ï¼Œè¦åŽ»3å·å£ï¼ŒQNMLGBã€‚å¿ƒé‡Œç¢Žç¢Žå¿µäº†å¥½ä¹…ï¼Œè¿™èƒ½æ€ªè°å‘¢ï¼Ÿèƒ½æ€ªæˆ‘æ²¡å¸¦çŽ°é‡‘å—ï¼Ÿå½“ç„¶ä¸èƒ½ï¼Œåªèƒ½æ€ªä»–ä»¬çš„è®¾æ–½ä¸å¤ŸçŽ°ä»£åŒ–ï¼ŒæŽ¥ç€èµ°å§ï¼Œé¡¶ç€ä¸€è½®æ˜Žæ—¥ï¼Œç»ˆäºŽæ¥åˆ°äº†ã€‚å½“ç„¶ï¼Œæ‹ä¸ªç…§å…ˆã€‚ ä¹°ç¥¨ï¼Œè¿›åŽ»ï¼Œæˆ‘çœ‹è¿™æ¬¡è°è¿˜æ•¢æ‹¦æˆ‘ï¼ çŽ°åœ¨æ˜¯éžæ³³æœŸï¼Œä½†æ˜¯æ˜¯å‘¨æœ«ï¼Œæ‰€ä»¥ç¥¨ä»·æ˜¯20ã€‚æ¥éƒ½æ¥äº†ï¼Œå†è´µä¹Ÿå¾—è¿›å•Šã€‚é©¬ä¸Šå°±èƒ½çœ‹åˆ°å¤§æµ·äº†ï¼Œå¥½æ¿€åŠ¨ã€‚ã€‚ã€‚ è¿™æ˜¯ä»€ä¹ˆé¬¼å•Šï¼Ÿè¿™å«å¤§æµ·å—ï¼Ÿè¿™æ ·çš„å¤§æµ·æ˜¯å¸¦ä¸èµ°æˆ‘çš„å“€æ„çš„å§ï¼Ÿ è¿œå¤„è¢«ä¸€é“åƒæ˜¯å¤§åçš„ä¸œè¥¿ç»™å›´ä½äº†ï¼Œè¿‡æ¥çš„æµªä¸€ä¸ªä¸ªå°çš„å¯æ€œï¼Œå®Œå…¨ä¸æ˜¯æˆ‘æƒ³è±¡ä¸­çš„æ ·å­ã€‚çœ‹åˆ°ä¸€å—å¤§çŸ³å¤´ï¼Œå¿ƒæƒ³ç€ï¼Œæ€Žä¹ˆç€ä¹Ÿå¾—ä¸ŠåŽ»åŸè¯—ä¸€é¦–å§ï¼Œè·³ä¸ŠåŽ»åˆšåˆšç«™å¥½ï¼Œç›´æŠ’èƒ¸è‡†çš„â€œå•Šâ€è¿˜æ²¡å‡ºå£ï¼ŒèƒŒåŽå“èµ·äº†â€œå¸…å“¥ï¼Œå¿«ä¸‹æ¥ï¼Œé‚£é‡Œä¸è®©ä¸Šå™¢â€çš„å£°éŸ³ï¼Œåˆšåˆšæ¶Œä¸Šæ¥çš„çµæ„Ÿï¼Œæ±‡æˆäº†ä¸€å¥â€œå¥½çš„ï¼Œé©¬ä¸Šä¸‹æ¥â€å–·æ¶Œè€Œå‡ºã€‚ ç»§ç»­å¾€å‰èµ°ï¼Œæ²™æ»©ä¸Šçš„æ²™å­æ˜¯çœŸçš„æ²™å­ï¼Œæˆ‘æ²¡æœ‰è„±éž‹åŽ»æ„Ÿå—ï¼Œå› ä¸ºæˆ‘æ€•æ‰Žäº†è„šã€‚ ç»ˆäºŽåˆ°äº†å¯ä»¥è¿‘è·ç¦»æŽ¥è§¦åˆ°æ°´çš„åœ°æ–¹äº†ï¼Œå¯è¿˜æ˜¯è¢«å›´æ å›´èµ·æ¥äº†ï¼Œå¾ˆç…žé£Žæ™¯æœ‰æ²¡æœ‰ï¼Ÿæ²¡æœ‰æ¯”åŸºå°¼ç¾Žå¥³ï¼ˆè¿™ä¸ªå¤©æ°”ä¹Ÿä¸å¯èƒ½æœ‰ï¼Œè¿™æ‰å››æœˆä»½ï¼‰ä¹Ÿå°±ç®—äº†ï¼Œå°±è¿™ç‚¹æ°´è¿˜å›´èµ·æ¥ï¼ŒçœŸæ˜¯å¤Ÿäº†ï¼æ²™æ»©ä¸Šçš„ä¸€ç¾¤å¤§å¦ˆåœ¨çƒ­ç«æœå¤©çš„èŠç€ï¼Œæ—¶ä¸æ—¶çš„è¿˜æ‰­å‡ ä¸‹ï¼Œéš¾é“æ˜¯ä¼ è¯´ä¸­çš„â€œæ²™æ»©èˆžè¹ˆé˜Ÿâ€ï¼Ÿæ­£åœ¨æˆ‘æš—æš—çŒœæµ‹å¥¹ä»¬çš„çœŸæ­£èº«ä»½çš„æ—¶å€™ï¼Œçªç„¶ï¼Œä¸‰ä¸ªå¤§å¦ˆä»Žäººç¾¤ä¸­èµ°äº†å‡ºæ¥ï¼ŒèƒŒå¯¹ç€å¤§æµ·ç«™å¥½ï¼Œå¥¹ä»¬å¯¹é¢è¿˜ç«™ç€ä¸€ä½æ‹ç…§çš„å¤§å¦ˆï¼Œåœ¨æ‹ç…§å¤§å¦ˆçš„å£ä»¤å£°ä¸­ï¼šâ€œ1â€ï¼Œâ€œ2â€ï¼Œâ€œ3â€ï¼Œä¸‰ä¸ªå¤§å¦ˆçªç„¶åƒå°‘å¥³èˆ¬çš„è·³äº†èµ·æ¥ï¼Œè€Œä¸”è¿˜æ‘†å‡ºäº†poseï¼Œå…¨èº«é—ªèµ·äº†é’æ˜¥çš„å…‰èŠ’ï¼Œå…‰èŠ’å››å°„ï¼Œåˆºç—›äº†æˆ‘çš„çœ¼ç›ã€‚å½“ç„¶poseè¿˜æœªæ‘†å¥½ï¼Œå°±å·²ç»ä»Žç©ºä¸­ç€é™†äº†ï¼Œæ¯•ç«Ÿè·³èµ·çš„é«˜åº¦æœ‰é™ã€‚ å†å¾€å‰èµ°ï¼Œä¸€è‚¡ä¸‹æ°´é“æ±¡æ³¥çš„å‘³é“æ‰‘é¢è€Œæ¥ã€‚åªå¥½è°ƒæ•´æ–¹å‘ï¼Œç„¶åŽæ²™é›•æ˜ å…¥çœ¼å¸˜ã€‚ å†å¾€å‰èµ°ï¼Œè§†çº¿å¼€é˜”äº†ä¸€äº›ï¼Œèƒ½çœ‹åˆ°è¿œå¤„çš„æµ·åŸŸï¼Œä¼¼æœ‰è‹¥æ— çš„å°å²›ã€‚è¿Žé¢çš„æµ·é£Žå¹æ¥ï¼ŒçœŸçš„æœ‰ç‚¹å¤§æµ·çš„æ„Ÿè§‰äº†ã€‚è¿˜æœ‰ä¹˜åå¿«è‰‡åœ¨æ°´ä¸­é©°éª‹çš„ä¹˜å®¢ã€‚å¥½äº†ï¼Œæ²¡æœ‰ä¼˜ç¾Žçš„è¯å†åŽ»èµžç¾Žè¿™ä¸ªåœ°æ–¹äº†ï¼Œèƒ½æƒ³åˆ°çš„å°±è¿™ä¹ˆå¤šã€‚ðŸ˜å¤§æ¦‚ç”¨äº†ä¸åˆ°ä¸€ä¸ªå°æ—¶ï¼Œå°±æŠŠè¿™é‡Œå…¨è½¬äº†ä¸ªéï¼Œè€Œä¸”è¿˜æ˜¯åœ¨æˆ‘æ•…æ„æ”¾æ…¢è„šæ­¥çš„æƒ…å†µä¸‹ã€‚æ€»çš„æ¥è¯´ï¼Œè¿™é‡Œæ»¡è¶³ä¸äº†å¯¹å¤§æµ·çš„æ†§æ†¬ï¼Œå……å…¶é‡å°±ç®—æ˜¯ä¸ªäº²å­ä¹å›­å§ã€‚æœ€åŽæ”¾ä¸Šæ‹çš„çœ‹èµ·æ¥è¿˜ä¸é”™çš„å›¾ç”¨ä»¥ä»¥åŽæ€€å¿µè¿™é‡Œå§ï¼Œåæ­£ç»å¯¹ä¸ä¼šå†æ¥ç¬¬äºŒæ¬¡äº†ã€‚]]></content>
      <categories>
        <category>ç”Ÿæ´»</category>
      </categories>
      <tags>
        <tag>ç”Ÿæ´»</tag>
        <tag>æ—…æ¸¸</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[iOS æœ¬åœ°æŽ¨é€ï¼ˆé€šçŸ¥ï¼‰]]></title>
    <url>%2F2017%2F04%2F14%2FlocalNotification%2F</url>
    <content type="text"><![CDATA[ä»¥å‰ä¸€ç›´è¿·æƒ‘ï¼Œæœ¬åœ°æŽ¨é€åˆ°åº•æœ‰ä»€ä¹ˆç”¨ï¼ŒåŽæ¥ä»”ç»†æƒ³äº†æƒ³ï¼Œç¡®å®žæœ‰ç”¨ï¼ˆåºŸè¯ï¼Œä¸ç„¶è‹¹æžœçˆ¸çˆ¸å¹²å˜›å¼€å‘è¿™ä¸ªï¼Ÿæ‰‹åŠ¨é„™è§†è‡ªå·±ï¼ï¼‰ æœ¬åœ°é€šçŸ¥æœåŠ¡ ä¸»è¦å¤„ç†åŸºäºŽæ—¶é—´è¡Œä¸ºçš„é€šçŸ¥ã€‚æ¯”å¦‚å®šæ—¶é€šçŸ¥ç”¨æˆ·è¯¥èµ·åºŠæ’’å°¿äº†ã€‚ å°±æ˜¯è¿™ä¹ˆä¸ªç”¨å¤„ï¼å—¯ï¼Œæ˜¯è¿™æ ·å§ï¼Ÿæ˜¯çš„ï¼ åœ¨iOS10è‹¹æžœåºŸå¼ƒäº†ä¹‹å‰çš„UILocalNotificationï¼Œè€Œé‡‡ç”¨äº†æ–°çš„UserNotifications Frameworkæ¥æŽ¨é€é€šçŸ¥ã€‚çŽ°åœ¨å…ˆè¯´ä¸€ä¸‹iOS10ä¹‹å‰çš„æœ¬åœ°æŽ¨é€æµç¨‹ï¼ iOS 10ä¹‹å‰æ³¨å†Œé€šçŸ¥123456789101112- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions &#123; // Override point for customization after application launch. if ([[UIDevice currentDevice].systemVersion floatValue] &gt; 8.0) &#123; UIUserNotificationSettings *settings = [UIUserNotificationSettings settingsForTypes:UIUserNotificationTypeAlert | UIUserNotificationTypeBadge | UIUserNotificationTypeSound categories:nil]; [application registerUserNotificationSettings:settings]; &#125; return YES;&#125; å‘é€é€šçŸ¥123456789101112131415161718192021222324252627// 1.åˆ›å»ºä¸€ä¸ªæœ¬åœ°é€šçŸ¥ UILocalNotification *localNote = [[UILocalNotification alloc] init]; // 1.1.è®¾ç½®é€šçŸ¥å‘å‡ºçš„æ—¶é—´ localNote.fireDate = [NSDate dateWithTimeIntervalSinceNow:5]; // 1.2.è®¾ç½®é€šçŸ¥å†…å®¹ localNote.alertBody = @&quot;è¿™æ˜¯ä¸€ä¸ªæœ¬åœ°æŽ¨é€&quot;; // 1.3.è®¾ç½®é”å±æ—¶,å­—ä½“ä¸‹æ–¹æ˜¾ç¤ºçš„ä¸€ä¸ªæ–‡å­— localNote.alertAction = @&quot;çœ‹æˆ‘&quot;; localNote.hasAction = YES; // 1.4.è®¾ç½®å¯åŠ¨å›¾ç‰‡(é€šè¿‡é€šçŸ¥æ‰“å¼€çš„) localNote.alertLaunchImage = @&quot;../Documents/1.jpg&quot;; // 1.5.è®¾ç½®é€šè¿‡åˆ°æ¥çš„å£°éŸ³ localNote.soundName = UILocalNotificationDefaultSoundName; // 1.6.è®¾ç½®åº”ç”¨å›¾æ ‡å·¦ä¸Šè§’æ˜¾ç¤ºçš„æ•°å­— localNote.applicationIconBadgeNumber = 1; // 1.7.è®¾ç½®ä¸€äº›é¢å¤–çš„ä¿¡æ¯ localNote.userInfo = @&#123;@&quot;hello&quot; : @&quot;how are you&quot;, @&quot;msg&quot; : @&quot;success&quot;&#125;; // 2.æ‰§è¡Œé€šçŸ¥ [[UIApplication sharedApplication] scheduleLocalNotification:localNote]; è¿™é‡Œè¦è¯´ä¸€ç‚¹ï¼Œå°±æ˜¯iOSç³»ç»Ÿé™åˆ¶äº†æ³¨å†Œæœ¬åœ°æŽ¨é€çš„æ•°é‡ï¼Œæœ€å¤§çš„æ³¨å†Œé‡ä¸º64æ¡ã€‚ æŽ¥æ”¶æŽ¨é€ åº”ç”¨åœ¨å‰å°æˆ–åŽå°ï¼Œæœªè¢«æ€æ­»æ—¶ã€‚ 1234567//ç¨‹åºå¤„äºŽå‰å°æˆ–åŽå°æ—¶è°ƒç”¨- (void)application:(UIApplication *)application didReceiveLocalNotification:(UILocalNotification *)notification&#123; NSLog(@&quot;333è¿™é‡Œè¢«è°ƒç”¨&quot;); UIAlertView *alert = [[UIAlertView alloc]initWithTitle:@&quot;Title&quot; message:@&quot;ç¨‹åºåœ¨å‰å°æˆ–åŽå°ï¼Œæœªè¢«æ€æ­»ï¼Œç‚¹å‡»é€šçŸ¥æ è°ƒç”¨&quot; delegate:self cancelButtonTitle:@&quot;cancel&quot; otherButtonTitles:@&quot;ok&quot;, nil]; [alert show];&#125; ç¨‹åºå·²è¢«æ€æ­»æ—¶ 1234567891011121314- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions &#123; // Override point for customization after application launch. if (launchOptions[UIApplicationLaunchOptionsLocalNotificationKey]) &#123; //æ·»åŠ å¤„ç†ä»£ç  NSLog(@&quot;666è¿™é‡Œè¢«è°ƒç”¨&quot;); UIAlertView *alert = [[UIAlertView alloc]initWithTitle:@&quot;Title&quot; message:@&quot;ç¨‹åºå·²è¢«æ€æ­»ï¼Œç‚¹å‡»é€šçŸ¥æ è°ƒç”¨&quot; delegate:self cancelButtonTitle:@&quot;cancel&quot; otherButtonTitles:@&quot;ok&quot;, nil]; [alert show]; &#125; return YES;&#125; iOS 10ä¹‹åŽå…ˆå¯¼å…¥è¿™ä¸ªä¸œè¥¿#import &lt;UserNotifications/UserNotifications.h&gt; æ³¨å†Œé€šçŸ¥1234567891011121314151617- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions &#123; // Override point for customization after application launch. // ä½¿ç”¨ UNUserNotificationCenter æ¥ç®¡ç†é€šçŸ¥ UNUserNotificationCenter *center = [UNUserNotificationCenter currentNotificationCenter]; //ç›‘å¬å›žè°ƒäº‹ä»¶ center.delegate = self; //iOS 10 ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•æ³¨å†Œï¼Œæ‰èƒ½å¾—åˆ°æŽˆæƒ [center requestAuthorizationWithOptions:(UNAuthorizationOptionAlert + UNAuthorizationOptionSound + UNAuthorizationOptionBadge) completionHandler:^(BOOL granted, NSError * _Nullable error) &#123; // Enable or disable features based on authorization. &#125;]; return YES;&#125; å‘é€é€šçŸ¥1234567891011121314151617181920// ä½¿ç”¨ UNUserNotificationCenter æ¥ç®¡ç†é€šçŸ¥ UNUserNotificationCenter* center = [UNUserNotificationCenter currentNotificationCenter]; //éœ€åˆ›å»ºä¸€ä¸ªåŒ…å«å¾…é€šçŸ¥å†…å®¹çš„ UNMutableNotificationContent å¯¹è±¡ï¼Œæ³¨æ„ä¸æ˜¯ UNNotificationContent ,æ­¤å¯¹è±¡ä¸ºä¸å¯å˜å¯¹è±¡ã€‚ UNMutableNotificationContent* content = [[UNMutableNotificationContent alloc] init]; content.title = [NSString localizedUserNotificationStringForKey:@&quot;æœ¬åœ°æŽ¨é€Title&quot; arguments:nil]; content.body = [NSString localizedUserNotificationStringForKey:@&quot;æœ¬åœ°æŽ¨é€Body&quot; arguments:nil]; content.sound = [UNNotificationSound defaultSound]; // åœ¨ è®¾å®šæ—¶é—´ åŽæŽ¨é€æœ¬åœ°æŽ¨é€ UNTimeIntervalNotificationTrigger* trigger = [UNTimeIntervalNotificationTrigger triggerWithTimeInterval:5 repeats:NO]; UNNotificationRequest* request = [UNNotificationRequest requestWithIdentifier:@&quot;FiveSecond&quot; content:content trigger:trigger]; //æ·»åŠ æŽ¨é€æˆåŠŸåŽçš„å¤„ç†ï¼ [center addNotificationRequest:request withCompletionHandler:^(NSError * _Nullable error) &#123; &#125;]; é€šçŸ¥å¤„ç†å®žçŽ°UNUserNotificationCenterDelegateä»£ç†æ–¹æ³•: ç¬¬ä¸€ä¸ªä»£ç†æ–¹æ³•ï¼š 123456-(void)userNotificationCenter:(UNUserNotificationCenter *)center willPresentNotification:(UNNotification *)notification withCompletionHandler:(void (^)(UNNotificationPresentationOptions))completionHandler&#123; // å¤„ç†å®ŒæˆåŽæ¡ç”¨ completionHandler ï¼Œç”¨äºŽæŒ‡ç¤ºåœ¨å‰å°æ˜¾ç¤ºé€šçŸ¥çš„å½¢å¼ completionHandler(UNNotificationPresentationOptionSound);&#125; è¿™ä¸ªæ–¹æ³•ä¸­çš„é‚£å¥è¯å°±æ˜¯ï¼Œå½“åº”ç”¨åœ¨å‰å°çš„æ—¶å€™ï¼Œæ”¶åˆ°æœ¬åœ°é€šçŸ¥ï¼Œæ˜¯ç”¨ä»€ä¹ˆæ–¹å¼æ¥å±•çŽ°ã€‚ç³»ç»Ÿç»™äº†ä¸‰ç§å½¢å¼ï¼š 12345typedef NS_OPTIONS(NSUInteger, UNNotificationPresentationOptions) &#123; UNNotificationPresentationOptionBadge = (1 &lt;&lt; 0), UNNotificationPresentationOptionSound = (1 &lt;&lt; 1), UNNotificationPresentationOptionAlert = (1 &lt;&lt; 2),&#125; ç¬¬äºŒä¸ªä»£ç†æ–¹æ³•ï¼š è¿™ä¸ªæ–¹æ³•æ˜¯åœ¨åŽå°æˆ–è€…ç¨‹åºè¢«æ€æ­»çš„æ—¶å€™ï¼Œç‚¹å‡»é€šçŸ¥æ è°ƒç”¨çš„ï¼Œåœ¨å‰å°çš„æ—¶å€™ä¸ä¼šè¢«è°ƒç”¨ 1234567- (void)userNotificationCenter:(UNUserNotificationCenter *)center didReceiveNotificationResponse:(UNNotificationResponse *)response withCompletionHandler:(void(^)())completionHandler&#123; UIAlertView *alert = [[UIAlertView alloc]initWithTitle:@&quot;Title&quot; message:@&quot;message&quot; delegate:self cancelButtonTitle:@&quot;cancel&quot; otherButtonTitles:@&quot;ok&quot;, nil]; [alert show]; completionHandler();&#125;]]></content>
      <categories>
        <category>iOS æŽ¨é€</category>
      </categories>
      <tags>
        <tag>æœ¬åœ°æŽ¨é€</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[iOS UITableViewçš„ä¸€äº›çç¢Ž]]></title>
    <url>%2F2017%2F04%2F13%2FhandleUITableView%2F</url>
    <content type="text"><![CDATA[è¡¨æ ¼UITableViewåŸºæœ¬ä¸Šå¼€å‘ä¸­åº”ç”¨æœ€å¸¸ç”¨çš„æŽ§ä»¶ä¹‹ä¸€äº†ï¼Œå…³äºŽtableviewä½ åˆäº†è§£å¤šå°‘å‘¢ï¼Œåæ­£æˆ‘æ˜¯åªçŸ¥é“ä¸€äº›å¸¸è§„çš„ç”¨æ³•ï¼ŒçŽ°åœ¨æŠŠä¹‹å‰å†™è¿‡çš„é¡¹ç›®ä¸­åº”ç”¨åˆ°çš„ä¸€äº›å°ç»†èŠ‚æ€»ç»“ä¸€ä¸‹ã€‚ cellåˆ†å‰²çº¿è¿™ä¸ªä¸çŸ¥é“æ˜¯ä¸æ˜¯æˆ‘è‡ªå·±çš„é—®é¢˜ï¼Œç¬¬ä¸€æ¬¡é‡åˆ°è¦å°†cellåˆ†å‰²çº¿ä¸Žå±å¹•è¾¹ç¼˜æ²¡æœ‰é—´è·çš„éœ€æ±‚æ—¶ï¼Œè¯•äº†å¥½å¤šæ–¹æ³•ï¼ ç¬¬ä¸€ç§æ–¹æ³•ä¸‹é¢çš„è¿™ä¸ªåœ¨Objective-Cé‡Œå†™äº†æ²¡æœ‰ä»€ä¹ˆæ•ˆæžœï¼Œä½†åœ¨Swiftä¸­å¯ä»¥å®Œç¾Žæ‰§è¡Œï¼Œæˆ‘ä¸çŸ¥é“æ˜¯ä¸æ˜¯æˆ‘ä¸€ä¸ªäººçš„é—®é¢˜ã€‚è´´å‡ºæ¥è¿™ä¸ªæ–¹æ³•ï¼š 1tableView.separatorInset = UIEdgeInsetsZero; ç¬¬äºŒç§æ–¹æ³•è¿™ä¸ªæ–¹æ³•æ˜¯åœ¨è®ºå›é‡Œçœ‹åˆ°çš„ï¼Œè¯•äº†è¯•ï¼Œå¯ä»¥çš„ã€‚ 12345- (void)tableView:(UITableView *)tableView willDisplayCell:(UITableViewCell *)cell forRowAtIndexPath:(NSIndexPath *)indexPath&#123; cell.separatorInset = UIEdgeInsetsZero; cell.layoutMargins = UIEdgeInsetsZero;&#125; tableViewçš„è¿™ä¸ªä»£ç†æ–¹æ³•æ˜¯åœ¨cellå°†è¦å‡ºçŽ°åœ¨å±å¹•çš„æ—¶å€™è°ƒç”¨ã€‚ä½†æ˜¯è¿™ç§æ–¹æ³•å’Œç¬¬ä¸€ç§æ–¹æ³•æœ‰ä¸ªä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿå°±æ˜¯ä¸èƒ½å°†tableView.separatorStyleè®¾ç½®ä¸ºUITableViewCellSeparatorStyleNone,è¿™æ ·å°±å¯¼è‡´äº†å¦‚æžœcellçš„ä¸ªæ•°ä¸è¶³ä»¥å……æ»¡å±å¹•çš„è¯ï¼Œä¼šåœ¨cellçš„åº•éƒ¨çœ‹åˆ°ç©ºä½™çš„cellåˆ†å‰²çº¿ï¼Œè¿™å¯¹äºŽæˆ‘è¿™ä¸ªå¼ºè¿«ç—‡æ˜¯ä¸èƒ½å¿çš„ï¼Œå½“ç„¶äº†ä¹Ÿæœ‰è§£å†³åŠžæ³•ï¼Œå°±æ˜¯æ·»åŠ ä¸€å¥ï¼štableView.tableFooterView = [UIView new];å°±OKäº†ã€‚ ç¬¬ä¸‰ç§æ–¹æ³•è‡ªä»Žåœ¨ocä¸­çŸ¥é“ç¬¬ä¸€ç§æ–¹æ³•ä¸èƒ½ç”¨ä¹‹åŽï¼ŒåŸºæœ¬ä¸Šæˆ‘éƒ½åœ¨ç”¨è¿™ç§æ–¹æ³•ï¼Œå°±æ˜¯åœ¨è‡ªå®šä¹‰çš„cellé‡Œé‡æ–°ç”»çº¿ã€‚ 12345678910111213141516- (void)drawRect:(CGRect)rect &#123; [super drawRect:rect]; CGContextRef context = UIGraphicsGetCurrentContext(); CGContextSetFillColorWithColor(context, [UIColor clearColor].CGColor); CGContextFillRect(context, rect); CGContextSetStrokeColorWithColor(context, [UIColor colorWithRed:225.0/255.0 green:225.0/255.0 blue:225.0/255.0 alpha:1.0].CGColor); CGContextStrokeRect(context, CGRectMake(0, 0, SCREEN_WIDTH, 0.5)); CGContextSetStrokeColorWithColor(context, [UIColor colorWithRed:225.0/255.0 green:225.0/255.0 blue:225.0/255.0 alpha:1.0].CGColor); CGContextStrokeRect(context, CGRectMake(0, rect.size.height-0.5, SCREEN_WIDTH, 0.5)); &#125; é‡æ–°ç»˜åˆ¶çš„è¯ï¼Œå¯ä»¥è®¾ç½®åˆ†å‰²çº¿çš„é¢œè‰²ï¼Œé•¿åº¦ï¼Œé«˜åº¦ã€‚ å¡ç‰‡å¼cellå°±æ˜¯ä¸‹é¢è¿™ç§æ•ˆæžœï¼š å®žçŽ°è¿™ç§æ•ˆæžœæˆ‘å·²çŸ¥çš„æœ‰ä¸‰ç§æ•ˆæžœï¼š ç¬¬ä¸€ç§é€šè¿‡è®¾ç½®cellçš„contentViewæ¥é—´æŽ¥å®žçŽ°ï¼Œåœ¨cellçš„contentViewçš„é¡¶éƒ¨æˆ–è€…åº•éƒ¨ç•™ä¸‹ä¸€å®šçš„é—´è·ï¼Œè¿™æ ·å°±ä¼šæœ‰cellé—´å°±æœ‰é—´è·çš„æ•ˆæžœã€‚ä½†æ˜¯è¿™ç§æ–¹å¼åœ¨cellæœ‰ç‚¹å‡»æ•ˆæžœçš„æ—¶å€™ï¼Œä¼šå¾ˆæ˜Žæ˜¾çš„çœ‹å‡ºæœ‰åˆ†å±‚ï¼Œå› ä¸ºè¿™æ—¶å€™cellæ˜¯è¢«ç‚¹å‡»çš„ï¼ŒcontentViewéƒ½ä¼šæœ‰ç³»ç»Ÿç‚¹å‡»çš„é˜´å½±æ•ˆæžœã€‚è¿™ç§æ–¹å¼åœ¨cellå·¦æ»‘åˆ é™¤ï¼Œç½®é¡¶ç­‰æ“ä½œçš„æ—¶å€™ï¼Œå·¦æ»‘å‡ºçš„è§†å›¾ä¼šé«˜å‡ºä¸€éƒ¨åˆ†ï¼ˆå·¦æ»‘æ˜¾ç¤ºå‡ºçš„é«˜åº¦=ï¼ˆcellçš„é«˜åº¦-ç•™ä¸‹çš„é—´è·é«˜åº¦ï¼‰+ ç•™ä¸‹çš„é—´è·é«˜åº¦ï¼‰ï¼Œå¾ˆæ˜¾ç„¶è¿™ç§æ–¹å¼æœ‰è‡´å‘½ç¼ºé™·ã€‚ å»ºè®®è¿˜æ˜¯ä¸è¦ç¬¬ä¸€ç§æ–¹æ³• ç¬¬äºŒç§é€šè¿‡åˆ†ç»„çš„æ–¹å¼é—´æŽ¥çš„å®žçŽ°ï¼Œæ¯ç»„çš„Headerå¯ä»¥å½“åšæ˜¯cellä¹‹é—´çš„é—´è·ï¼Œæ¯ç»„ä¸­åªæœ‰ä¸€ä¸ªcellï¼š 12345678910111213141516171819- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView &#123; return 10;&#125; - (CGFloat)tableView:(UITableView *)tableView heightForHeaderInSection:(NSInteger)section &#123; return 10;&#125; - (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section &#123; return 1;&#125; - (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath &#123; return 100;&#125; ä½†æ˜¯å‘¢ï¼Œè¿™è¿˜æ˜¯ä¼šå‡ºçŽ°ä¸€ä¸ªé—®é¢˜ï¼Œå› ä¸ºç³»ç»Ÿé»˜è®¤åˆ†ç»„çš„æ—¶å€™æ¯ç»„çš„Headerä¼šåœç•™åœ¨tableviewçš„é¡¶éƒ¨ï¼Œè¿™è¦æ€Žä¹ˆå¤„ç†å‘¢ï¼Ÿç½‘ä¸Šä¹Ÿæœ‰ä¸€ç§è§£å†³åŠžæ³•: 123456789101112131415- (void)scrollViewDidScroll:(UIScrollView *)scrollView &#123; if (scrollView == self.tableView) &#123; CGFloat sectionHeaderHeight = 10; if (scrollView.contentOffset.y &lt;= sectionHeaderHeight &amp;&amp; scrollView.contentOffset.y &gt;= 0) &#123; scrollView.contentInset = UIEdgeInsetsMake(-scrollView.contentOffset.y, 0, 0, 0); &#125; else if (scrollView.contentOffset.y &gt;= sectionHeaderHeight) &#123; scrollView.contentInset = UIEdgeInsetsMake(-sectionHeaderHeight, 0, 0, 0); &#125; &#125; &#125; ä½†æ˜¯è¿™ç§æ–¹å¼æ˜¯é€šè¿‡scrollåç§»é‡æ¥ç›‘å¬å’Œæ”¹å˜tableviewçš„contentInsetï¼Œå› ä¸ºåªè¦UITableViewåœ¨æ»šåŠ¨å°±ä¸€ç›´åœ¨è¿è¡Œï¼Œä¸æ˜¯å¾ˆå¥½ã€‚ ç¬¬ä¸‰ç§é‡å†™cellçš„setFrameæ–¹æ³•ï¼š 12345678- (void)setFrame:(CGRect)frame &#123; frame.origin.x = 15; frame.size.width -= 2 * frame.origin.x; frame.size.height -= 15; frame.origin.y += 10; [super setFrame:frame];&#125; è¿™ç§æ–¹å¼çœ‹ä¸ŠåŽ»å¾ˆä¼˜é›…ï¼Œå…¶å®žä¹Ÿæœ‰ç¼ºç‚¹ï¼Œå°±æ˜¯ä¸é€‚åˆæœ‰ç¼–è¾‘çš„æƒ…å†µï¼Œå› ä¸ºåœ¨ç¼–è¾‘çš„æ—¶å€™ä¼šä¸åœè°ƒç”¨setFrameæ–¹æ³•ï¼Œå¯¼è‡´é”™ä¹±ï¼Œæ­¤æ—¶å»ºè®®ä½¿ç”¨ä¸Šé¢çš„ç¬¬äºŒç§æ–¹æ¡ˆã€‚]]></content>
      <categories>
        <category>iOS å®žç”¨</category>
      </categories>
      <tags>
        <tag>UItableView</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[iOS å¸¸ç”¨æ“ä½œä¹‹æ–‡ä»¶æ“ä½œ]]></title>
    <url>%2F2017%2F04%2F13%2FfileOperations%2F</url>
    <content type="text"><![CDATA[åœ¨é¡¹ç›®å¼€å‘ä¸­ï¼Œä¸å¯é¿å…çš„ä¼šé‡åˆ°å°†ä¸€äº›ä¸œè¥¿å­˜åˆ°æœ¬åœ°ï¼Œæˆ–è€…åœ¨æœ¬åœ°åˆ›å»ºæ–°çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ï¼Œç‰¹åœ°åœ¨æ­¤æ€»ç»“äº†ä¸€ä¸‹ã€‚ æ–‡ä»¶æ“ä½œèŽ·å–Documentsæ–‡ä»¶å¤¹è·¯å¾„123456789/*** èŽ·å–Documentsæ–‡ä»¶å¤¹è·¯å¾„** @return æ–‡ä»¶å¤¹è·¯å¾„*/+ (NSString *)getDocumentsFolderPath&#123;NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);return [paths objectAtIndex:0];&#125; èŽ·å–Documentsæ–‡ä»¶è·¯å¾„1234567891011/*** èŽ·å–Documentsæ–‡ä»¶è·¯å¾„** @param fileName æ–‡ä»¶åç§°** @return æ–‡ä»¶è·¯å¾„*/+ (NSString *)getDocumentsFilePath:(NSString *)fileName&#123;return [[self getDocumentsFolderPath] stringByAppendingPathComponent:fileName];&#125; èŽ·å–ä¸€ä¸ªç›®å½•æ‰€å çš„ç©ºé—´å¤§å°1234567891011121314151617/*** èŽ·å–ä¸€ä¸ªç›®å½•æ‰€å çš„ç©ºé—´å¤§å°** @param filePath æ–‡ä»¶ç›®å½•è·¯å¾„** @return ç›®å½•ç©ºé—´å¤§å°*/+ (long long)fileSizeAtPath:(NSString*) filePath&#123;NSFileManager* manager = [NSFileManager defaultManager];if ([manager fileExistsAtPath:filePath])&#123;return [[manager attributesOfItemAtPath:filePath error:nil] fileSize];&#125;else&#123;return 0;&#125;&#125; æ–‡ä»¶æ˜¯å¦å­˜åœ¨123456789/*æ–‡ä»¶æ˜¯å¦å­˜åœ¨*/ + (BOOL)isFileExisted:(NSString *)fileName&#123; NSFileManager *fileManager = [NSFileManager defaultManager]; if(![fileManager fileExistsAtPath:[self getFilePath:fileName]])&#123; return NO; &#125; return YES; &#125; åˆ›å»ºæŒ‡å®šåå­—çš„æ–‡ä»¶12345678910111213/*åˆ›å»ºæŒ‡å®šåå­—çš„æ–‡ä»¶*/ + (BOOL)createFileAtPath:(NSString *)fileName&#123; NSArray *array = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES); NSString *path = [[array objectAtIndex:0] stringByAppendingPathComponent:fileName]; NSLog(@&quot;-----%@:&quot;, path); NSFileManager *fileManager = [NSFileManager defaultManager]; if(![fileManager fileExistsAtPath:path])&#123; [fileManager createFileAtPath:path contents:nil attributes:nil]; return YES; &#125; return NO; &#125; åˆ›å»ºæŒ‡å®šåå­—çš„æ–‡ä»¶å¤¹1234567891011121314/*åˆ›å»ºæŒ‡å®šåå­—çš„æ–‡ä»¶å¤¹*/ + (BOOL)createDirectoryAtPath:(NSString *)fileName&#123; NSArray *array = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES); NSString *path = [[array objectAtIndex:0] stringByAppendingPathComponent:fileName]; NSLog(@&quot;-----%@:&quot;, path); NSFileManager *fileManager = [NSFileManager defaultManager]; if(![fileManager fileExistsAtPath:path])&#123; NSError *error = nil; [fileManager createDirectoryAtPath:path withIntermediateDirectories:YES attributes:nil error:&amp;error]; return YES; &#125; return NO; &#125; åˆ é™¤æ–‡ä»¶123456789101112+ (BOOL)deleteFileAtPath:(NSString *)fileName&#123; NSArray *array = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES); NSString *path = [[array objectAtIndex:0] stringByAppendingPathComponent:fileName]; NSFileManager *fileManager = [NSFileManager defaultManager]; if(![fileManager fileExistsAtPath:path])&#123; return NO; &#125; [fileManager removeItemAtPath:path error:nil]; return YES; &#125; NSUserDefaultsä¿å­˜å’Œå–å‡º 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576/**ä¿å­˜@param value &lt;#value description#&gt;@param key &lt;#key description#&gt;*/+(void)saveValue:(id) value forKey:(NSString *)key&#123;NSUserDefaults *userDefaults = [NSUserDefaults standardUserDefaults];[userDefaults setObject:value forKey:key];[userDefaults synchronize];&#125;/**å–å‡º@param key &lt;#key description#&gt;@return &lt;#return value description#&gt;*/+(id)valueForKey:(NSString *)key&#123;NSUserDefaults *userDefaults = [NSUserDefaults standardUserDefaults];return [userDefaults objectForKey:key];&#125;/**æ ¹æ®keyå–å‡ºNSStringçš„value@param key &lt;#key description#&gt;@return &lt;#return value description#&gt;*/+(id)StringForKey:(NSString *)key&#123;NSUserDefaults *userDefaults = [NSUserDefaults standardUserDefaults];return [userDefaults stringForKey:key];&#125;/**æ ¹æ®keyå–å‡ºBoolåž‹çš„å€¼@param key &lt;#key description#&gt;@return &lt;#return value description#&gt;*/+(BOOL)boolValueForKey:(NSString *)key&#123;NSUserDefaults *userDefaults = [NSUserDefaults standardUserDefaults];return [userDefaults boolForKey:key];&#125;/**ä¿å­˜Boolåž‹çš„å€¼@param value value@param key key*/+(void)saveBoolValue:(BOOL)value forKey:(NSString *)key&#123;NSUserDefaults *userDefaults = [NSUserDefaults standardUserDefaults];[userDefaults setBool:value forKey:key];[userDefaults synchronize];&#125;/**èŽ·å–userDefaultså­˜å‚¨çš„æ‰€æœ‰ä¿¡æ¯*/+(void)printAllUserDefault&#123;NSUserDefaults *userDefaults = [NSUserDefaults standardUserDefaults];NSDictionary *dic = [userDefaults dictionaryRepresentation];NSLog(@&quot;%@&quot;,dic);&#125;]]></content>
      <categories>
        <category>iOS å®žç”¨</category>
      </categories>
      <tags>
        <tag>æœ¬åœ°å­˜å‚¨</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[swiftOptional]]></title>
    <url>%2F2017%2F04%2F07%2FswiftOptional%2F</url>
    <content type="text"><![CDATA[å­¦ä¹ swiftçš„è¿‡ç¨‹ä¸­ä¸å¯é¿å…çš„ä¼šé‡åˆ°ï¼Ÿæˆ–ï¼è¿™ç§ä¸œè¥¿ï¼Œè¿™å°±æ˜¯ä»Šå¤©è¦è¯´çš„å¯é€‰åž‹ï¼ˆOptional)äº†ã€‚å¤§å®¶éƒ½çŸ¥é“ï¼Œswiftæ˜¯è‹¹æžœå®˜æ–¹æŽ¨å‡ºçš„ä¸€æ¬¾è¾ƒäºŽObjective-Cå®‰å…¨æ€§è¾ƒé«˜çš„è¯­è¨€ï¼Œè€Œå¯é€‰åž‹å°±æ˜¯swiftæœ€ä¸ºçªå‡ºçš„ç‰¹æ€§ä¹‹ä¸€ã€‚ Optionalæ˜¯ä»€ä¹ˆï¼ŸOptional æ˜¯ Swift æ–°åŠ å…¥çš„ç±»åž‹ã€‚å¯é€‰åž‹çš„æ„æ€ç®€å•ç†è§£æ˜¯ï¼šæœ‰å€¼å¾—æ—¶å€™å°±æœ‰å€¼ï¼Œæ— å€¼çš„æ—¶å€™å°±æ˜¯ nil ã€‚Swift ä¸­çš„ nil å’Œå…¶ä»–è¯­è¨€ä¸­çš„ nil è¿˜æœ‰äº›ä¸ä¸€æ ·ï¼Œnil è‡ªå·±æœ¬èº«å°±æ˜¯ä¸€ç§ç±»åž‹ï¼Œæ²¡æœ‰å°±æ˜¯ nil ï¼Œæ˜¯å’Œå…¶ä»–ç±»åž‹ä¸¥æ ¼åŒºåˆ†å¼€çš„ã€‚å¯é€‰åž‹çš„å®šä¹‰å¾ˆç®€å•ï¼šç±»åž‹ + ? ã€‚æ¯”å¦‚ String?ã€Int?ã€Float? ç­‰ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ String? å’Œ String æ˜¯å®Œå…¨ä¸åŒçš„ä¸¤ä¸ªç±»åž‹ï¼Œå‰è€…æ˜¯ String ç±»åž‹çš„å¯é€‰åž‹ï¼ŒåŽè€…æ˜¯ String ç±»åž‹ï¼Œæ³¨æ„åŒºåˆ†ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨ OC ä¸­æˆ‘ä»¬å¯ä»¥è¿™æ ·å†™: 12NSString *name = @&quot;jack&quot;;name = nil; è€Œåœ¨swiftä¸­å¦‚æžœåƒä¸‹é¢è¿™ç§å†™æ³•æ˜¯ä¼šæŠ¥é”™çš„ï¼š 123//è¿™ç§å†™æ³•æ˜¯ä¼šæŠ¥é”™çš„ï¼Œè¯´çš„æ˜¯ nil æ˜¯ä¸å¯ä»¥åˆ†é…ç»™ String ç±»åž‹çš„ï¼Œè¿™ä¹Ÿè¯´æ˜Žåœ¨ swift ä¸­ nil æ˜¯å’Œå…¶ä»–ç±»åž‹ä¸¥æ ¼åŒºåˆ†çš„ã€‚var name: String = &quot;jack&quot;name = nil æ”¹ä¸ºå¯é€‰åž‹ä¹‹åŽå°±å¯ä»¥äº†ï¼Œåƒä¸‹é¢è¿™æ ·ï¼š 12var name: String? = &quot;name&quot;name = nil å¯é€‰åž‹ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯å¯ä»¥é€‰æ‹©ï¼Œæ¯”å¦‚ String? çš„æ„æ€å°±æ˜¯å¯ä»¥åœ¨ String å’Œ nil ä¹‹é—´é€‰æ‹©ï¼Œå¯ä»¥æ˜¯ String ä¹Ÿå¯ä»¥æ˜¯ nil ã€‚å¦‚æžœä¸€ä¸ªå˜é‡å®šä¹‰æˆ Stringï¼Œé‚£ä¹ˆè¿™ä¸ªå˜é‡å°±ä¼šæ˜¯ String ç±»åž‹ï¼Œè€Œä¸å¯èƒ½æ˜¯nilã€‚ è¿˜æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯å£°æ˜Žå¯é€‰åž‹å¿…é¡»æ˜¯æ˜¾ç¤ºçš„å£°æ˜Žä¹Ÿå°±æ˜¯å¿…é¡»æ˜¯ 1var name: String? = nil è€Œä¸èƒ½æ˜¯ï¼š 1var name = nil è¿™æ ·ï¼Œå› ä¸º Swift åœ¨åšç±»åž‹åˆ¤æ–­çš„æ—¶å€™æ— æ³•åˆ¤æ–­ name åˆ°åº•æ˜¯ String ç±»åž‹çš„å¯é€‰åž‹è¿˜æ˜¯å…¶ä»–ç±»åž‹çš„å¯é€‰åž‹ï¼Œå› æ­¤ä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ã€‚ Tips: å½“ç„¶æžšä¸¾ç±»åž‹çš„å†™æ³•è¿˜å¯ä»¥å¦‚ 12&gt; var name: Optional&lt;String&gt; = Optional.Some(&quot;Loveway&quot;)&gt; è¿™æ ·ï¼Œåªä¸è¿‡æˆ‘ä»¬ä¸€èˆ¬éƒ½ç”¨ 12&gt; var name: String? = nil&gt; è¿™æ ·çš„ç®€å†™ã€‚ Optionalçš„è§£åŒ…å¯é€‰åž‹æ˜¯ä¸èƒ½å¤Ÿè¢«ç›´æŽ¥ä½¿ç”¨çš„ï¼ˆå› ä¸º Swift æ˜¯ç±»åž‹å®‰å…¨çš„ï¼Œå¯é€‰åž‹çš„å€¼åˆå¯èƒ½ä¼šæ˜¯ nilï¼Œå¦‚æžœä¸åšå¤„ç†å¯èƒ½å¯¼è‡´ç¨‹åº crashï¼‰ï¼Œå¦‚æžœæˆ‘ä»¬æƒ³ä½¿ç”¨å¯é€‰åž‹çš„å€¼ï¼Œé‚£ä¹ˆåœ¨è¿™ä¹‹å‰æˆ‘ä»¬éœ€è¦åšçš„ä¸€é¡¹å·¥ä½œå°±æ˜¯ï¼šè§£åŒ…ï¼ˆunwarpï¼‰ï¼ 1.å¼ºåˆ¶è§£åŒ… æ‰€è°“çš„å¼ºåˆ¶è§£åŒ…æ„æ€å°±æ˜¯æˆ‘çŸ¥é“è¿™ä¸ªç±»åž‹æ˜¯å¯é€‰åž‹ï¼Œä½†æ˜¯åœ¨æˆ‘çš„ç¨‹åºæ‰§è¡Œåˆ°è¿™é‡Œçš„æ—¶å€™æˆ‘å¯ä»¥ä¿è¯å®ƒæ˜¯æœ‰å€¼å¾—ï¼Œæ‰€ä»¥æˆ‘è¦åœ¨è¿™é‡Œä½¿ç”¨å®ƒã€‚å…·ä½“è¡¨çŽ°å½¢å¼å°±æ˜¯åœ¨å¯é€‰åž‹åŽé¢åŠ ä¸ª !ï¼Œå¦‚ä¸‹: 12var name: String? = &quot;jack&quot;print(&quot;My name is &quot; + name!) ä½†æ˜¯è¿™æ ·çš„è§£åŒ…æ˜¯ä¸å®‰å…¨ï¼Œå› ä¸ºä½ ä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™ä½ çš„è¿™ä¸ªå¯é€‰åž‹å°±ä¼šå˜æˆ nilï¼Œå¦‚æžœæˆ‘ä»¬ä»£ç éžå¸¸å¤šçš„è¯ï¼Œä¸€ä¸å°å¿ƒä¸º niläº†ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç¨‹åºå´©æºƒã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬ä¼šæƒ³åˆ°ä¸€ç§æ–¹æ³•ï¼šåˆ¤ç©ºï¼å¦‚ä¸‹: 123456var name: String? = &quot;loveway&quot;if name != nil &#123; print(&quot;My name is &quot; + name!)&#125; else &#123; print(&quot;name is nil&quot;)&#125; è¿™æ ·å†™ä¼¼ä¹Žæ˜¯æ²¡æœ‰ä»€ä¹ˆé—®é¢˜äº†ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä½ åœ¨åˆ¤æ–­éž nil çš„ä½œç”¨åŸŸå†…ä½¿ç”¨ name çš„æ—¶å€™è¿˜å¿…é¡»æŠŠ ! å¸¦ä¸Šï¼Œè¿™æ ·ä»£ç æ¯”è¾ƒå¤šçš„æ—¶å€™è¿˜æ˜¯æ¯”è¾ƒéº»çƒ¦ã€‚äºŽæ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢è¿™ç§æ–¹å¼: 2.ä½¿ç”¨ if let è§£åŒ… å¦‚ä¸‹ï¼š 123456var name: String? = &quot;jack&quot;if let name = name &#123; print(&quot;My name is &quot; + name)&#125; else &#123; print(&quot;name is nil&quot;)&#125; è¿™ç§è§£åŒ…æ–¹å¼å¯ä»¥ä¿è¯ name æ˜¯è§£åŒ…è¿‡çš„ï¼Œä¸ä¼šå†æ˜¯ nil è¿™ç§æƒ…å†µï¼Œå…¶å®žé€»è¾‘æ˜¯å’Œä¸Šé¢åšéžç©ºåˆ¤æ–­ä¸€æ ·çš„ã€‚å½“ç„¶ä½ æŠŠ let æ¢æˆ var ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œæ•ˆæžœæ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡æˆ‘ä»¬ä¸€èˆ¬è¦ç”¨çš„æ˜¯è§£åŒ…åŽçš„å€¼ï¼Œè€Œä¸ä¼šåŽ»æ”¹å˜å®ƒï¼Œæ‰€ä»¥å¹³å¸¸ä½¿ç”¨ä¸­ä¸€èˆ¬éƒ½æ˜¯ç”¨ if let ã€‚ åŒæ—¶ if let å¯ä»¥åŒæ—¶ä¸€æ¬¡æ€§è§£åŒ…å¤šä¸ªå¯é€‰åž‹ï¼Œç”¨ , éš”å¼€ï¼Œä½¿è¯­å¥ç®€æ´ï¼Œå¦‚ä¸‹: 1234567var name: String? = &quot;loveway&quot;var age: Int? = 18if let name = name, age = age &#123; print(&quot;My name is &quot; + name + &quot;My age is&quot; + &quot;\(age)&quot;)&#125; else &#123; print(&quot;name is nil&quot;)&#125; æœ€åŽï¼Œæ—¢ç„¶è¿™é‡Œä½¿ç”¨çš„æ˜¯ if ï¼Œé‚£ä¹ˆåŒæ ·æˆ‘ä»¬å¯ä»¥å¦‚ä¸‹è¿™æ ·ç”¨ï¼Œæ¥è¿›è¡Œè¿›ä¸€æ­¥çš„åˆ¤æ–­ç­›é€‰: 1234567var name: String? = &quot;loveway&quot;var age: Int? = 18if let name = name, age = age where age == 18 &#123; print(&quot;My name is \(name), age is \(String(age))&quot;)&#125; else &#123; print(&quot;name is nil&quot;)&#125; å¯é€‰é“¾å¼è°ƒç”¨ï¼ˆOptional Chainingï¼‰å¯é€‰é“¾å¼è°ƒç”¨ï¼ˆOptional Chainingï¼‰æ˜¯ä¸€ç§å¯ä»¥åœ¨å½“å‰å€¼å¯èƒ½ä¸º nil çš„å¯é€‰å€¼ä¸Šè¯·æ±‚å’Œè°ƒç”¨å±žæ€§ã€æ–¹æ³•åŠä¸‹æ ‡çš„æ–¹æ³•ã€‚å¦‚æžœå¯é€‰å€¼æœ‰å€¼ï¼Œé‚£ä¹ˆè°ƒç”¨å°±ä¼šæˆåŠŸï¼Œå¦‚æžœå¯é€‰å€¼æ˜¯ nil ï¼Œé‚£ä¹ˆè°ƒç”¨å°†è¿”å›ž nilã€‚å¤šä¸ªè°ƒç”¨å¯ä»¥è¿žæŽ¥åœ¨ä¸€èµ·å½¢æˆä¸€ä¸ªè°ƒç”¨é“¾ï¼Œå¦‚æžœå…¶ä¸­ä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹ä¸º nil ï¼Œæ•´ä¸ªè°ƒç”¨é“¾éƒ½ä¼šå¤±è´¥ï¼Œå³è¿”å›ž nil ã€‚ ä¸‹é¢æˆ‘ä»¬å°±æ¥ä¸¾ä¸ªä¾‹å­å…·ä½“è¯´æ˜Žå¯é€‰é“¾ï¼Œå¦‚ä¸‹: 123456var name: String? = &quot;loveway&quot;if let name = name &#123; print(name.uppercaseString)&#125; else &#123; print(&quot;name is nil&quot;)&#125; æˆ‘ä»¬æ¥è§£åŒ… name ï¼Œå¦‚æžœæœ‰å€¼å°±æ‰“å°å‡º name çš„å¤§å†™ï¼Œå¦‚æžœæ²¡æœ‰å°±è¾“å‡º name is nil ï¼Œå…¶å®žä¸Šé¢è¿™æ®µä»£ç å®Œå…¨ç­‰åŒäºŽ: 12var name: String? = &quot;loveway&quot;name?.uppercaseString ä¸Šé¢è¿™å¥ä»£ç çš„æ„æ€å°±æ˜¯å¦‚æžœå¯é€‰åž‹å˜é‡ name æœ‰å€¼ï¼Œé‚£ä¹ˆå°±å¯¹ name è¿›è¡Œè§£åŒ…ï¼Œå¹¶å¾—åˆ° name çš„uppercaseString å€¼ï¼Œå¦‚æžœæ²¡æœ‰ï¼Œé‚£ä¹ˆè¿™å¥ä»£ç å°±ä¼šè¿”å›žä¸€ä¸ª nil ã€‚è¿™æ ·å°±ç¬¦åˆ Swift çš„ç±»åž‹å®‰å…¨ï¼Œå®Œå…¨æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚ä½†æ˜¯å¦‚æžœä½ å†™æˆ: 12var name: String? = &quot;loveway&quot;name!.uppercaseString ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä¸è¿‡ä¸å®‰å…¨ï¼Œå› ä¸ºå¦‚æžœ name æ²¡æœ‰å€¼ï¼Œä½ è¿›è¡Œå¼ºåˆ¶è§£åŒ…ï¼Œå°±ä¼šæŠ¥é”™ã€‚ æ‰€ä»¥æˆ‘ä»¬ä»¥åŽå¯èƒ½ä¼šç”¨åˆ°ç±»ä¼¼äºŽ person?.name?.uppercaseString è¿™æ ·çš„ä¸€å±‚å±‚è§£åŒ…çš„ï¼Œè¿™ç§å°±æ˜¯å¯é€‰é“¾ã€‚ Nil Coalescing Operatorï¼ˆç©ºåˆè¿ç®—ç¬¦ï¼‰å¦‚ä¸Šï¼Œå¦‚æžœæˆ‘ä»¬æƒ³æŠŠè§£åŒ…åŽçš„å€¼å­˜èµ·æ¥çš„è¯ï¼Œå¯ä»¥è¿™æ ·: 1let newName = name == nil ? &quot;no name&quot; : name! ä¸Šé¢ä»£ç çš„æ„æ€å°±æ˜¯å¦‚æžœ name ä¸º nil ï¼ŒnewName å°±æ˜¯ â€œno nameâ€ï¼Œå¦åˆ™ newName å°±æ˜¯ name!ï¼ˆnameçš„è§£åŒ…ï¼‰ã€‚å…¶å®ž Swift ä¸ºæˆ‘ä»¬æä¾›äº†æ›´ç®€æ´çš„è¯­æ³•ï¼Œå¦‚ä¸‹: 1let newName2 = name ?? &quot;no name&quot; ä¸Šé¢ä»£ç çš„æ„æ€å°±æ˜¯ name å¦‚æžœæœ‰å€¼ newName2 çš„å€¼å°±æ˜¯ name! ,å¦åˆ™å°±æ˜¯ no name ã€‚è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ ??æ˜¯ç©ºåˆè¿ç®—ç¬¦ï¼Œè¿™æ ·å†™çš„å¯é˜…è¯»æ€§å¼ºï¼Œæ¯”è¾ƒç®€æ´ã€‚ å½“ç„¶å…³äºŽ ?? è¿œä¸æ­¢è¿™äº›ï¼Œæœ‰å…´è¶£çš„åŒå­¦å¯ä»¥çœ‹ èŠèŠswiftè¯­è¨€ä¸­çš„â€œ??â€ è¿™ç¯‡æ–‡ç« ã€‚ éšå¼å¯é€‰åž‹ä¸Šé¢æˆ‘ä»¬éƒ½çŸ¥é“äº†ï¼Œåˆ›å»ºä¸€ä¸ªæ˜¾ç¤ºå¯é€‰åž‹æ˜¯: ç±»åž‹ + ?ã€‚è¿™é‡Œåˆ›å»ºéšå¼å¯é€‰åž‹çš„å°±æ˜¯ï¼š ç±»åž‹ + !ã€‚ 1var name: String! = &quot;loveway&quot; è¿™é‡Œå¯èƒ½æœ‰çš„ç«¥éž‹ä¼šç–‘æƒ‘ï¼Œå·²ç»æœ‰äº†æ˜¾ç¤ºçš„å¯é€‰åž‹ï¼Œä¸ºä»€ä¹ˆè¿˜éœ€è¦æœ‰éšå¼çš„å¯é€‰åž‹ã€‚è¿™é‡Œå…¶å®žéšå¼çš„å¯é€‰åž‹ä¹Ÿæ˜¯æœ‰ä¸€å®šä½œç”¨çš„ã€‚æ¯”å¦‚ä½ æœ‰ä¸€ä¸ªå˜é‡ï¼Œå£°æ˜Žä¸ºéšå¼çš„å¯é€‰åž‹ï¼ˆ!ï¼‰ï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯ï¼Œå½“ä½ è¿™ä¸ªç±»æ²¡æœ‰è¢«åˆå§‹åŒ–çš„æ—¶å€™ä»–æ˜¯æ²¡æœ‰å€¼çš„ï¼Œä½†æ˜¯å½“ä½ è¿™ä¸ªç±»åˆå§‹åŒ–ä»¥åŽï¼Œä½ å¯ä»¥ç¡®ä¿ä»–æ˜¯æœ‰å€¼çš„ï¼Œæ‰€ä»¥è¿™é‡Œå£°æ˜Žä¸ºéšå¼çš„å¯é€‰åž‹ï¼Œè€Œä¸æ˜¯æ˜¾ç¤ºçš„ã€‚åŒæ ·éœ€è¦æ³¨æ„çš„æ˜¯éšå¼çš„å¯é€‰åž‹ä¹Ÿæ˜¯å¯é€‰åž‹ï¼Œå¦‚æžœä½ éœ€è¦ç”¨å®ƒçš„å€¼ï¼Œä½ ä¹Ÿæ˜¯è¦è¿›è¡Œåˆ¤æ–­çš„ã€‚å¦‚æžœä¸è¿›è¡Œåˆ¤æ–­è€Œç›´æŽ¥ä½¿ç”¨ï¼Œå¯èƒ½ä¼šé€ æˆä¸å¯é¢„æ–™çš„åŽæžœï¼å·®ä¸å¤šå¯é€‰åž‹å°±åˆ°è¿™é‡Œäº†ï¼Œå¦‚æžœè¿˜æœ‰ä»€ä¹ˆé—æ¼ï¼Œæ¬¢è¿Žå¤§å®¶æŒ‡æ­£ï¼ è½¬è‡ªé‡è¯» Swift ä¹‹ä¸€ï¼šOptionalï¼ˆå¯é€‰åž‹ï¼‰]]></content>
      <categories>
        <category>swiftå­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>swift</tag>
        <tag>Optional</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è°ˆè°ˆ Swift ä¸­çš„ map å’Œ flatMap]]></title>
    <url>%2F2017%2F04%2F06%2FswiftMapAndFlatMap%2F</url>
    <content type="text"><![CDATA[map å’Œ flatMap æ˜¯ Swift ä¸­ä¸¤ä¸ªå¸¸ç”¨çš„å‡½æ•°ï¼Œå®ƒä»¬ä½“çŽ°äº† Swift ä¸­å¾ˆå¤šçš„ç‰¹æ€§ã€‚å¯¹äºŽç®€å•çš„ä½¿ç”¨æ¥è¯´ï¼Œå®ƒä»¬çš„æŽ¥å£å¹¶ä¸å¤æ‚ï¼Œä½†å®ƒä»¬å†…éƒ¨çš„æœºåˆ¶è¿˜æ˜¯éžå¸¸å€¼å¾—ç ”ç©¶çš„ï¼Œèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬å¤Ÿå¥½çš„ç†è§£ Swift è¯­è¨€ã€‚ map ç®€ä»‹é¦–å…ˆï¼Œå’±ä»¬è¯´è¯´ map å‡½æ•°å¦‚ä½•ä½¿ç”¨ã€‚ 123let numbers = [1,2,3,4]let result = numbers.map &#123; $0 + 2 &#125;print(result) // [3,4,5,6] map æ–¹æ³•æŽ¥å—ä¸€ä¸ªé—­åŒ…ä½œä¸ºå‚æ•°ï¼Œ ç„¶åŽå®ƒä¼šéåŽ†æ•´ä¸ª numbers æ•°ç»„ï¼Œå¹¶å¯¹æ•°ç»„ä¸­æ¯ä¸€ä¸ªå…ƒç´ æ‰§è¡Œé—­åŒ…ä¸­å®šä¹‰çš„æ“ä½œã€‚ ç›¸å½“äºŽå¯¹æ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ åšäº†ä¸€ä¸ªæ˜ å°„ã€‚ æ¯”å¦‚å’±ä»¬è¿™ä¸ªä¾‹å­é‡Œé¢çš„é—­åŒ…æ˜¯è®²æ‰€æœ‰å…ƒç´ éƒ½åŠ  2 ã€‚ è¿™æ ·å®ƒäº§ç”Ÿçš„ç»“æžœæ•°æ®å°±æ˜¯ [3,4,5,6]ã€‚ åˆæ­¥äº†è§£ä¹‹åŽï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ map çš„å®šä¹‰ï¼š 1func map&lt;T&gt;(@noescape transform: (Self.Generator.Element) throws -&gt; T) rethrows -&gt; [T] å’±ä»¬æŠ›å¼€ä¸€äº›å’Œå…³é”®é€»è¾‘æ— å…³çš„ä¿®é¥°ç¬¦ @noescape,throws è¿™äº›ï¼Œåœ¨æ•´ç†ä¸€ä¸‹å°±æ˜¯è¿™æ ·ï¼š 1func map&lt;T&gt;(transform: (Self.Generator.Element) -&gt; T) rethrows -&gt; [T] map å‡½æ•°æŽ¥å—ä¸€ä¸ªé—­åŒ…ï¼Œ è¿™ä¸ªé—­åŒ…çš„å®šä¹‰æ˜¯è¿™æ ·çš„ï¼š 1(Self.Generator.Element) -&gt; T å®ƒæŽ¥å— Self.Generator.Element ç±»åž‹çš„å‚æ•°ï¼Œ è¿™ä¸ªç±»åž‹ä»£è¡¨æ•°ç»„ä¸­å½“å‰å…ƒç´ çš„ç±»åž‹ã€‚ è€Œè¿™ä¸ªé—­åŒ…çš„è¿”å›žå€¼ï¼Œæ˜¯å¯ä»¥å’Œä¼ é€’è¿›æ¥çš„å€¼ä¸åŒçš„ã€‚ æ¯”å¦‚æˆ‘ä»¬å¯ä»¥è¿™æ ·ï¼š 12let stringResult = numbers.map &#123; &quot;No. \($0)&quot; &#125;// [&quot;No. 1&quot;, &quot;No. 2&quot;, &quot;No. 3&quot;, &quot;No. 4&quot;] è¿™æ¬¡æˆ‘ä»¬åœ¨é—­åŒ…è£…æŠŠä¼ é€’è¿›æ¥çš„æ•°å­—æ‹¼æŽ¥åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ï¼Œ ç„¶åŽè¿”å›žä¸€ä¸ªç»„æ•°ï¼Œ è¿™ä¸ªæ•°ç»„ä¸­åŒ…å«çš„æ•°æ®ç±»åž‹ï¼Œå°±æ˜¯æˆ‘ä»¬æ‹¼æŽ¥å¥½çš„å­—ç¬¦ä¸²ã€‚ è¿™å°±æ˜¯å…³äºŽ map çš„åˆæ­¥äº†è§£ï¼Œ æˆ‘ä»¬ç»§ç»­æ¥çœ‹ flatMapã€‚ flatMapmap å¯ä»¥å¯¹ä¸€ä¸ªé›†åˆç±»åž‹çš„æ‰€æœ‰å…ƒç´ åšä¸€ä¸ªæ˜ å°„æ“ä½œã€‚ é‚£ä¹ˆ flatMap å‘¢ï¼Ÿ è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ª flatMap çš„ä¾‹å­ï¼š 12result = numbers.flatMap &#123; $0 + 2 &#125;// [3,4,5,6] æˆ‘ä»¬å¯¹åŒæ ·çš„æ•°ç»„ä½¿ç”¨ flatMap è¿›è¡Œå¤„ç†ï¼Œ å¾—åˆ°äº†åŒæ ·çš„ç»“æžœã€‚ é‚£ flatMap å’Œ map åˆ°åº•æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ å’±ä»¬å†æ¥çœ‹å¦ä¸€ä¸ªä¾‹å­ï¼š 12345let numbersCompound = [[1,2,3],[4,5,6]];var res = numbersCompound.map &#123; $0.map&#123; $0 + 2 &#125; &#125;// [[3, 4, 5], [6, 7, 8]]var flatRes = numbersCompound.flatMap &#123; $0.map&#123; $0 + 2 &#125; &#125;// [3, 4, 5, 6, 7, 8] è¿™é‡Œå°±çœ‹å‡ºå·®åˆ«äº†ã€‚ å¯¹äºŽäºŒç»´æ•°ç»„ï¼Œ map å’Œ flatMap çš„ç»“æžœå°±ä¸åŒäº†ã€‚ æˆ‘ä»¬å…ˆæ¥çœ‹ç¬¬ä¸€ä¸ªè°ƒç”¨ï¼š 12var res = numbersCompound.map &#123; $0.map&#123; $0 + 2 &#125; &#125;// [[3, 4, 5], [6, 7, 8]] numbersCompound.map { ... } è¿™ä¸ªè°ƒç”¨å®žé™…ä¸Šæ˜¯éåŽ†äº†è¿™é‡Œä¸¤ä¸ªæ•°ç»„å…ƒç´  [1,2,3] å’Œ [4,5,6]ã€‚ å› ä¸ºè¿™ä¸¤ä¸ªå…ƒç´ ä¾ç„¶æ˜¯æ•°ç»„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¯¹ä»–ä»¬å†æ¬¡è°ƒç”¨ map å‡½æ•°ï¼š$0.map{ $0 + 2 }ã€‚ è¿™ä¸ªå†…éƒ¨çš„è°ƒç”¨æœ€ç»ˆå°†æ•°ç»„ä¸­æ‰€æœ‰çš„å…ƒç´ åŠ  2ã€‚ å†æ¥çœ‹çœ‹ flatMap çš„è°ƒç”¨ï¼š 12var flatRes = numbersCompound.flatMap &#123; $0.map&#123; $0 + 2 &#125; &#125;// [3, 4, 5, 6, 7, 8] flatMap ä¾ç„¶ä¼šéåŽ†æ•°ç»„çš„å…ƒç´ ï¼Œå¹¶å¯¹è¿™äº›å…ƒç´ æ‰§è¡Œé—­åŒ…ä¸­å®šä¹‰çš„æ“ä½œã€‚ ä½†å”¯ä¸€ä¸åŒçš„æ˜¯ï¼Œå®ƒå¯¹æœ€ç»ˆçš„ç»“æžœè¿›è¡Œäº†æ‰€è°“çš„ â€œé™ç»´â€ æ“ä½œã€‚ æœ¬æ¥åŽŸå§‹æ•°ç»„æ˜¯ä¸€ä¸ªäºŒç»´çš„ï¼Œ ä½†ç»è¿‡ flatMap ä¹‹åŽï¼Œå®ƒå˜æˆä¸€ç»´çš„äº†ã€‚ flatMap æ˜¯å¦‚ä½•åšåˆ°çš„å‘¢ï¼Œå®ƒçš„åŽŸç†æ˜¯ä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆä¼šå­˜åœ¨è¿™æ ·ä¸€ä¸ªå‡½æ•°å‘¢ï¼Ÿ ç›¸ä¿¡æ­¤æ—¶ä½ è„‘æµ·ä¸­è‚¯å®šä¼šæµ®çŽ°å‡ºç±»ä¼¼çš„é—®é¢˜ã€‚ ä¸‹é¢å’±ä»¬å†æ¥çœ‹ä¸€ä¸‹ flatMap çš„å®šä¹‰, è¿˜æ˜¯æŠ›åŽ» @noescape, rethrows è¿™äº›æ— å…³é€»è¾‘çš„å…³é”®å­—ï¼š 12func flatMap&lt;T&gt;(transform: (Self.Generator.Element) throws -&gt; T?) -&gt; [T]func flatMap&lt;S : SequenceType&gt;(transform: (Self.Generator.Element) -&gt; S) -&gt; [S.Generator.Element] å’Œ map ä¸åŒï¼Œ flatMap æœ‰ä¸¤ä¸ªé‡è½½ã€‚ å‚ç…§æˆ‘ä»¬åˆšæ‰çš„ç¤ºä¾‹ï¼Œ æˆ‘ä»¬è°ƒç”¨çš„å…¶å®žæ˜¯ç¬¬äºŒä¸ªé‡è½½ï¼š 1func flatMap&lt;S : SequenceType&gt;(transform: (Self.Generator.Element) -&gt; S) -&gt; [S.Generator.Element] flatMap çš„é—­åŒ…æŽ¥å—çš„æ˜¯æ•°ç»„çš„å…ƒç´ ï¼Œä½†è¿”å›žçš„æ˜¯ä¸€ä¸ª SequenceType ç±»åž‹ï¼Œä¹Ÿå°±æ˜¯å¦å¤–ä¸€ä¸ªæ•°ç»„ã€‚ è¿™ä»Žæˆ‘ä»¬åˆšæ‰è¿™ä¸ªè°ƒç”¨ä¸­ä¸éš¾çœ‹å‡ºï¼š 1numbersCompound.flatMap &#123; $0.map&#123; $0 + 2 &#125; &#125; æˆ‘ä»¬ä¼ å…¥ç»™ flatMap ä¸€ä¸ªé—­åŒ… $0.map{ $0 + 2 } , è¿™ä¸ªé—­åŒ…ä¸­ï¼Œåˆå¯¹ $0 è°ƒç”¨äº† map æ–¹æ³•ï¼Œ ä»Ž map æ–¹æ³•çš„å®šä¹‰ä¸­æˆ‘ä»¬èƒ½å¤ŸçŸ¥é“ï¼Œå®ƒè¿”å›žçš„è¿˜æ˜¯ä¸€ä¸ªé›†åˆç±»åž‹ï¼Œä¹Ÿå°±æ˜¯ SequenceTypeã€‚ æ‰€ä»¥æˆ‘ä»¬è¿™ä¸ª flatMap çš„è°ƒç”¨å¯¹åº”çš„å°±æ˜¯ç¬¬äºŒä¸ªé‡è½½å½¢å¼ã€‚ é‚£ä¹ˆä¸ºä»€ä¹ˆ flatMap è°ƒç”¨åŽä¼šå¯¹æ•°ç»„é™ç»´å‘¢ï¼Ÿ æˆ‘ä»¬å¯ä»¥ä»Žå®ƒçš„æºç ä¸­çª¥æŽ¢ä¸€äºŒï¼ˆSwift ä¸æ˜¯å¼€æºäº†å—~ï¼‰ã€‚ 1234567891011121314151617extension Sequence &#123; //... public func flatMap&lt;S : Sequence&gt;( @noescape transform: ($&#123;GElement&#125;) throws -&gt; S ) rethrows -&gt; [S.$&#123;GElement&#125;] &#123; var result: [S.$&#123;GElement&#125;] = [] for element in self &#123; result.append(contentsOf: try transform(element)) &#125; return result &#125; //... &#125; è¿™å°±æ˜¯ flatMap çš„å®Œæ•´æºç äº†ï¼Œ å®ƒçš„æºç ä¹Ÿå¾ˆç®€å•ï¼Œ å¯¹éåŽ†çš„æ¯ä¸€ä¸ªå…ƒç´ è°ƒç”¨ try transform(element)ã€‚ transform å‡½æ•°å°±æ˜¯æˆ‘ä»¬ä¼ é€’è¿›æ¥çš„é—­åŒ…ã€‚ ç„¶åŽå°†é—­åŒ…çš„è¿”å›žå€¼é€šè¿‡ result.append(contentsOf:) å‡½æ•°æ·»åŠ åˆ° result æ•°ç»„ä¸­ã€‚ é‚£æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹ result.append(contentsOf:) éƒ½åšäº†ä»€ä¹ˆï¼Œ å®ƒçš„æ–‡æ¡£å®šä¹‰æ˜¯è¿™æ ·ï¼š Append the elements of newElements to self. ç®€å•è¯´å°±æ˜¯å°†ä¸€ä¸ªé›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œæ·»åŠ åˆ°å¦ä¸€ä¸ªé›†åˆã€‚ è¿˜ä»¥æˆ‘ä»¬åˆšæ‰è¿™ä¸ªäºŒç»´æ•°ç»„ä¸ºä¾‹ï¼š 123let numbersCompound = [[1,2,3],[4,5,6]];var flatRes = numbersCompound.flatMap &#123; $0.map&#123; $0 + 2 &#125; &#125;// [3, 4, 5, 6, 7, 8] flatMap é¦–å…ˆä¼šéåŽ†è¿™ä¸ªæ•°ç»„çš„ä¸¤ä¸ªå…ƒç´  [1,2,3] å’Œ [4,5,6]ï¼Œ å› ä¸ºè¿™ä¸¤ä¸ªå…ƒç´ ä¾ç„¶æ˜¯æ•°ç»„ï¼Œ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¯¹ä»–ä»¬å†è¿›è¡Œ map æ“ä½œï¼š $0.map{ $0 + 2 }ã€‚ è¿™æ ·ï¼Œ å†…éƒ¨çš„ $0.map{ $0 + 2 } è°ƒç”¨è¿”å›žå€¼ç±»åž‹è¿˜æ˜¯æ•°ç»„ï¼Œ å®ƒä¼šè¿”å›ž [3,4,5] å’Œ [6,7,8]ã€‚ ç„¶åŽï¼Œ flatMap æŽ¥æ”¶åˆ°å†…éƒ¨é—­åŒ…çš„è¿™ä¸¤ä¸ªè¿”å›žç»“æžœï¼Œ è¿›è€Œè°ƒç”¨ result.append(contentsOf:) å°†å®ƒä»¬çš„æ•°ç»„ä¸­çš„å†…å®¹æ·»åŠ åˆ°ç»“æžœé›†ä¸­ï¼Œè€Œä¸æ˜¯æ•°ç»„æœ¬èº«ã€‚ é‚£ä¹ˆæˆ‘ä»¬æœ€ç»ˆçš„è°ƒç”¨ç»“æžœç†æ‰€å½“ç„¶å°±åº”è¯¥æ˜¯ [3, 4, 5, 6, 7, 8] äº†ã€‚ ä»”ç»†æƒ³æƒ³æ˜¯ä¸æ˜¯è¿™æ ·å‘¢~ flatMap çš„å¦ä¸€ä¸ªé‡è½½æˆ‘ä»¬åˆšæ‰åˆ†æžäº†åŠå¤©ï¼Œ å…¶å®žåªåˆ†æžåˆ° flatMap çš„ä¸€ç§é‡è½½æƒ…å†µï¼Œ é‚£ä¹ˆå¦å¤–ä¸€ç§é‡è½½åˆæ˜¯æ€Žä¹ˆå›žäº‹å‘¢ï¼š 1func flatMap&lt;T&gt;(transform: (Self.Generator.Element) -&gt; T?) -&gt; [T] ä»Žå®šä¹‰ä¸­æˆ‘ä»¬çœ‹å‡ºï¼Œ å®ƒçš„é—­åŒ…æŽ¥æ”¶çš„æ˜¯ Self.Generator.Element ç±»åž‹ï¼Œ è¿”å›žçš„æ˜¯ä¸€ä¸ª T? ã€‚ æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œåœ¨ Swift ä¸­ç±»åž‹åŽé¢è·Ÿéšä¸€ä¸ª ?ï¼Œ ä»£è¡¨çš„æ˜¯ Optional å€¼ã€‚ ä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªé‡è½½ä¸­æŽ¥æ”¶çš„é—­åŒ…è¿”å›žçš„æ˜¯ä¸€ä¸ª Optional å€¼ã€‚ æ›´è¿›ä¸€æ­¥æ¥è¯´ï¼Œå°±æ˜¯é—­åŒ…å¯ä»¥è¿”å›ž nilã€‚ æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼š 123let optionalArray: [String?] = [&quot;AA&quot;, nil, &quot;BB&quot;, &quot;CC&quot;];var optionalResult = optionalArray.flatMap&#123; $0 &#125;// [&quot;AA&quot;, &quot;BB&quot;, &quot;CC&quot;] è¿™æ ·ç«Ÿç„¶æ²¡æœ‰æŠ¥é”™ï¼Œ å¹¶ä¸” flatMap çš„è¿”å›žç»“æžœä¸­ï¼Œ æˆåŠŸçš„å°†åŽŸæ•°ç»„ä¸­çš„ nil å€¼è¿‡æ»¤æŽ‰äº†ã€‚ å†ä»”ç»†è§‚å¯Ÿï¼Œä½ ä¼šå‘çŽ°æ›´å¤šã€‚ ä½¿ç”¨ flatMap è°ƒç”¨ä¹‹åŽï¼Œ æ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ éƒ½è¢«è§£åŒ…äº†ï¼Œ å¦‚æžœåŒæ ·ä½¿ç”¨ print å‡½æ•°è¾“å‡ºåŽŸå§‹æ•°ç»„çš„è¯ï¼Œ å¤§æ¦‚ä¼šå¾—åˆ°è¿™æ ·çš„ç»“æžœ: 1[Optional(&quot;AA&quot;), nil, Optional(&quot;BB&quot;), Optional(&quot;CC&quot;)] è€Œä½¿ç”¨ print å‡½æ•°è¾“å‡º flatMap çš„ç»“æžœé›†æ—¶ï¼Œä¼šå¾—åˆ°è¿™æ ·çš„è¾“å‡ºï¼š 1[&quot;AA&quot;, &quot;BB&quot;, &quot;CC&quot;] ä¹Ÿå°±æ˜¯è¯´åŽŸå§‹æ•°ç»„çš„ç±»åž‹æ˜¯ [String?] è€Œ flatMap è°ƒç”¨åŽå˜æˆäº† [String]ã€‚ è¿™ä¹Ÿæ˜¯ flatMap å’Œ map çš„ä¸€ä¸ªé‡å¤§åŒºåˆ«ã€‚ å¦‚æžœåŒæ ·çš„æ•°ç»„ï¼Œæˆ‘ä»¬ä½¿ç”¨ map æ¥è°ƒç”¨ï¼Œ å¾—åˆ°çš„æ˜¯è¿™æ ·çš„è¾“å‡ºï¼š 1[Optional(&quot;AA&quot;), nil, Optional(&quot;BB&quot;), Optional(&quot;CC&quot;)] è¿™å°±å’ŒåŽŸå§‹æ•°ç»„ä¸€æ ·äº†ã€‚ è¿™ä¸¤è€…çš„åŒºåˆ«å°±æ˜¯è¿™æ ·ã€‚ map å‡½æ•°å€¼å¯¹å…ƒç´ è¿›è¡Œå˜æ¢æ“ä½œã€‚ ä½†ä¸ä¼šå¯¹æ•°ç»„çš„ç»“æž„é€ æˆå½±å“ã€‚ è€Œ flatMap ä¼šå½±å“æ•°ç»„çš„ç»“æž„ã€‚å†è¿›ä¸€æ­¥åˆ†æžä¹‹å‰ï¼Œæˆ‘ä»¬æš‚ä¸”è¿™æ ·ç†è§£ã€‚ flatMap çš„è¿™ç§æœºåˆ¶ï¼Œè€Œå·²å¸®åŠ©æˆ‘ä»¬æ–¹ä¾¿çš„å¯¹æ•°æ®è¿›è¡ŒéªŒè¯ï¼Œæ¯”å¦‚æˆ‘ä»¬æœ‰ä¸€ç»„å›¾ç‰‡æ–‡ä»¶åï¼Œ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ flatMap å°†æ— æ•ˆçš„å›¾ç‰‡è¿‡æ»¤æŽ‰ï¼š 12var imageNames = [&quot;test.png&quot;, &quot;aa.png&quot;, &quot;icon.png&quot;];imageNames.flatMap&#123; UIImage(named: $0) &#125; é‚£ä¹ˆ flatMap æ˜¯å¦‚ä½•å®žçŽ°è¿‡æ»¤æŽ‰ nil å€¼çš„å‘¢ï¼Ÿ æˆ‘ä»¬è¿˜æ˜¯æ¥çœ‹ä¸€ä¸‹æºç ï¼š 123456789101112131415161718extension Sequence &#123; // ... public func flatMap&lt;T&gt;( @noescape transform: ($&#123;GElement&#125;) throws -&gt; T? ) rethrows -&gt; [T] &#123; var result: [T] = [] for element in self &#123; if let newElement = try transform(element) &#123; result.append(newElement) &#125; &#125; return result &#125; // ... &#125; ä¾ç„¶æ˜¯éåŽ†æ‰€æœ‰å…ƒç´ ï¼Œå¹¶åº”ç”¨ try transform(element) é—­åŒ…çš„è°ƒç”¨ï¼Œ ä½†å…³é”®ä¸€ç‚¹æ˜¯ï¼Œè¿™é‡Œé¢ç”¨åˆ°äº† if let è¯­å¥ï¼Œ å¯¹é‚£äº›åªæœ‰è§£åŒ…æˆåŠŸçš„å…ƒç´ ï¼Œæ‰ä¼šæ·»åŠ åˆ°ç»“æžœé›†ä¸­: 123if let newElement = try transform(element) &#123; result.append(newElement)&#125; è¿™æ ·ï¼Œ å°±å®žçŽ°äº†æˆ‘ä»¬åˆšæ‰çœ‹åˆ°çš„è‡ªåŠ¨åŽ»æŽ‰ nil å€¼çš„æ•ˆæžœäº†ã€‚ ç»“å°¾å…³äºŽ Swift ä¸­çš„ map å’Œ flatMapï¼Œ çœ‹å®Œè¿™ç¯‡å†…å®¹æ˜¯ä¸ä¼šä¼šå¯¹ä½ æœ‰æ‰€å¯å‘å‘¢ã€‚ å½“ç„¶ï¼Œ å…³äºŽè¿™ä¸¤ä¸ªå‡½æ•°æˆ‘ä»¬è¿™é‡Œå¹¶æ²¡æœ‰å®Œå…¨è®¨è®ºå®Œã€‚ å®ƒä»¬èƒŒåŽè¿˜æœ‰ç€æ›´å¤šçš„æ€æƒ³ã€‚ å…³äºŽæœ¬ç¯‡æ–‡ç« çš„ä»£ç ï¼Œå¤§å®¶è¿˜å¯ä»¥æ¥ Github ä¸Šé¢ å‚çœ‹. è½¬è‡ªï¼šhttps://www.swiftcafe.io/2016/03/28/about-map/?utm_source=tuicool&amp;utm_medium=referral]]></content>
      <categories>
        <category>swiftå­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>map</tag>
        <tag>flatMap</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é›¨å¤œ]]></title>
    <url>%2F2017%2F03%2F31%2FrainNight%2F</url>
    <content type="text"><![CDATA[è¿™æ˜¯ä¸€ä¸ªå¤œï¼Œä¸€ä¸ªä¸‹é›¨çš„å¤œã€‚ æˆ‘å–œæ¬¢æ­¤æ—¶æ­¤åˆ»çš„æ°”æ°›ï¼Œä¸€ä¸ªäººçªåœ¨è¢«çªé‡Œï¼Œçª—å¤–æ·…æ·…æ²¥æ²¥çš„é›¨æ»´æ•²æ‰“ç€çª—æˆ·ä¸Šçš„çŽ»ç’ƒï¼Œæ­£åº”äº†é‚£å¥è¯â€œå¤§ç å°ç è½çŽ‰ç›˜â€ã€‚æˆ¿é—´é‡Œå¾ˆå®‰é™ï¼Œå®‰é™çš„åªèƒ½å¬åˆ°è‡ªå·±çš„å‘¼å¸å£°ï¼Œçª—å¤–æ—¶ä¸æ—¶çš„ä¼ æ¥ä¸€å£°æ±½è½¦å‘¼å•¸è€Œè¿‡çš„å£°éŸ³ã€‚è¿™ç§çŽ¯å¢ƒï¼Œè¿™ç§æ°›å›´ï¼Œè®©æˆ‘è§‰å¾—å¾ˆèˆ’æœï¼Œæ°åˆ°å¥½å¤„ã€‚ ä¸€ä¸ªäººåœ¨è¿™ç§çŽ¯å¢ƒä¸‹ï¼Œæ€æƒ³ä¼šå˜å¾—æ ¼å¤–çš„æ¸…æ™°å’Œæ˜Žæœ—ï¼Œä¼šæƒ³æ˜Žç™½å¾ˆå¤šä¸€ç›´æƒ³ä¸æ˜Žç™½çš„é—®é¢˜ã€‚äºŽæˆ‘è‡ªå·±è€Œè¨€ï¼Œå–œæ¬¢é»‘å¤œç”šäºŽç™½å¤©ã€‚å°¤å…¶æ˜¯è¿™æ ·çš„ä¸€ä¸ªé™è°§çš„å¤œã€‚ ä¸Šæµ·çš„ç”Ÿæ´»èŠ‚å¥å¿«çš„å¯æ€•ï¼Œåˆæ¥ä¹åˆ°ä¹‹æ—¶ï¼Œæ‰‹å¿™è„šä¹±ï¼Œæ…Œä¸æ‹©è·¯ã€‚æ…¢æ…¢çš„ä¹ æƒ¯äº†è¿™ç§ç”Ÿæ´»ï¼Œå–œæ¬¢åœ¨ä¸€ç‰‡å–§åš£ä¹‹ä¸­è§…å¾—ä¸€æ–¹æ¸…å¹½ä¹‹æ‰€ï¼Œç‹¬å¤„ï¼Œäº«å—ã€‚ ä¸€ä¸ªäººç”Ÿæ´»ï¼Œæœ‰å¥½å¤„ï¼Œä¹Ÿæœ‰åå¤„ã€‚å¥½å¤„å°±æ˜¯å¯ä»¥ç»å¸¸åæ€è‡ªå·±ï¼Œå¯ä»¥ä¾é è‡ªå·±æ¥çº¦æŸè‡ªå·±ã€‚åå¤„å°±æ˜¯ç¼ºå°‘ä¸Žäººäº¤æµï¼Œæ²¡æœ‰äº¤æµï¼Œè¿›æ­¥å°±ä¼šå¼‚å¸¸ç¼“æ…¢ã€‚å°±çŽ°åœ¨æ¥è¯´ï¼Œæˆ‘è¿˜æŒºæ»¡æ„è‡ªå·±å¦‚ä»Šçš„ç”Ÿæ´»çŠ¶æ€ï¼Œè™½è¯´æœä¹æ™šäº”ï¼Œä½†ä¹Ÿæ˜¯å¼‚å¸¸å……å®žï¼ŒçŸ¥é“æ¯å¤©éœ€è¦åšäº›ä»€ä¹ˆæ¥å¡«è¡¥è‡ªå·±ã€‚å¹´é¾„åœ¨ä¸€å¤©å¤©çš„å¢žé•¿ï¼Œæˆ‘è¦åšçš„å°±æ˜¯è®©ç»åŽ†ï¼Œç»éªŒï¼Œå­¦è¯†éƒ½è¦ä¸Žä¹‹å¢žé•¿ã€‚ æœ¬æ¥è¯´å¥½äº†ï¼Œè¿™ä¸æ˜¯ä¸€ç¯‡é¸¡æ±¤æ–‡ï¼Œä½†å†™ç€å†™ç€ï¼Œæ€»æƒ³å†™ä¸€äº›è¯æ¥å®‰æ…°æˆ–é¼“åŠ±è‡ªå·±ä¸€ä¸‹ã€‚å­¦è€Œä¸æ€åˆ™ç½”ï¼Œæ€è€Œä¸å­¦åˆ™æ®†ã€‚å¿«èŠ‚å¥çš„ç”Ÿæ´»ä¸­ï¼Œä¼šæ€è€ƒæ˜¾å¾—å¼¥è¶³çè´µã€‚æˆ‘ä»¬ä¸è¦åªé¡¾é£Žé›¨å…¼ç¨‹ï¼Œè¿˜è¦æ—¶ä¸æ—¶çš„åœä¸‹æ¥ï¼Œå®¡è§†è‡ªå·±ã€‚ä»¥äººä¸ºé•œï¼Œæ­£å·±ã€‚ å¤œï¼Œæ˜¯æ€ç»ªæ”¾é£žçš„æ—¶åˆ»ã€‚ä¼šæƒ³åˆ°ä¸€äº›äººï¼Œä¼šæƒ³åˆ°ä¸€äº›äº‹ã€‚æƒ³æ˜¨å¤©ï¼Œæƒ³æ˜Žå¤©ã€‚æƒ³ä¸€åˆ‡èƒ½æƒ³åˆ°çš„ã€‚æ€æƒ³çš„è§¦è§’æ¼«æ— è¾¹é™…ï¼Œä»»å…¶å››é€šå…«è¾¾ï¼Œé€šå‘æœªæ¥ã€‚ çª—å¤–çš„é›¨è¿˜åœ¨æ·…æ·…æ²¥æ²¥çš„ä¸‹ç€ï¼Œå¤œå·²æ·±ã€‚]]></content>
      <categories>
        <category>ç”Ÿæ´»</category>
      </categories>
      <tags>
        <tag>éšç¬”</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æžå…‰æŽ¨é€å¼€å‘çŽ¯å¢ƒå¯ä»¥æ”¶åˆ°,ç”Ÿäº§çŽ¯å¢ƒæ”¶ä¸åˆ°æŽ¨é€]]></title>
    <url>%2F2017%2F03%2F30%2Fjpush%2F</url>
    <content type="text"><![CDATA[é¦–å…ˆé˜è¿°ä¸€ä¸‹æˆ‘é‡åˆ°çš„é—®é¢˜ï¼š æˆ‘ä»¬é¡¹ç›®è¿žé€šäº†æžå…‰æŽ¨é€ï¼Œä»¥å‰å†™è¿‡çš„é¡¹ç›®ä¹Ÿæ˜¯è¿™æ ·ï¼Œåœ¨å¼€å‘çŽ¯å¢ƒä¸‹æµ‹è¯•ï¼Œå¥½ä½¿äº†ï¼Œä½†æ˜¯æ‰“åŒ…ADHocæ—¶å€™ï¼Œå°±ä¸å¥½ä½¿äº†ï¼Œå½“æ—¶ä¹Ÿæ²¡åœ¨æ„ï¼Œå› ä¸ºç½‘ä¸Šå¥½å¤šäººè¯´ï¼Œåªè¦æµ‹è¯•å¥½ä½¿äº†ï¼Œè¯ä¹¦æ˜¾ç¤ºé…ç½®æˆåŠŸäº†ï¼ˆç»¿ç¯ï¼‰ï¼Œé‚£å°±æ²¡é—®é¢˜äº†ã€‚ soï¼Œä¸Šçº¿ï¼Œç„¶åŽä¸Šçº¿ä»¥åŽï¼Œå‘çŽ°æŽ¨é€åŠŸèƒ½å®Œå…¨ä¸å¥½ä½¿ï¼è¿™å°±å°´å°¬äº†ï¼Œèµ¶ç´§ä¸‹æž¶ã€‚ å› ä¸ºæˆ‘ä»¬é¡¹ç›®ä½¿ç”¨çš„æ˜¯åˆ«åæŽ¨é€ï¼Œä½¿ç”¨æžå…‰ç½‘ç«™æŽ¨é€æ—¶å€™ï¼Œæˆ‘ä½¿ç”¨äº†å¹¿æ’­ï¼Œåˆ«åæŽ¨é€ï¼ŒregIDæŽ¨é€ï¼Œç»“æžœ éƒ½èƒ½æ”¶åˆ°ï¼ˆå¼€å‘çŽ¯å¢ƒï¼‰ï¼›ç„¶åŽæˆ‘åœ¨ç”Ÿäº§çŽ¯å¢ƒï¼ï¼ï¼ï¼ï¼ï¼žå†æ¬¡å‘é€ï¼ï¼ï¼ï¼ï¼ï¼žå¹¿æ’­ï¼Œåˆ«åï¼ŒregIDï¼Œç»“æžœï¼Œå¾ˆæ˜¾ç„¶ï¼Œåˆ«åæ”¶ä¸åˆ°ï¼Œè¿™å°±çº ç»“äº†ï¼Œå¼€å§‹æŸ¥çœ‹é—®é¢˜å§ã€‚ ç»è¿‡ä¸¤å¤©çš„çˆ¬å‘ï¼Œç»ˆäºŽæ‰¾åˆ°äº†é—®é¢˜æ‰€åœ¨ï¼Œä¹Ÿæ­£åœ¨ç§¯æžè§£å†³ã€‚åœ¨è¿™é‡Œå†æ¬¡æ„Ÿè°¢æžå…‰å®˜æ–¹ä¸¤ä½å¤§ç‰›ï¼Œå¦‚æžœæ²¡æœ‰ä½ ä»¬çš„å¸®å¿™ï¼Œæˆ‘æƒ³æˆ‘è¿˜ä¼šçº ç»“å¥½ä¹…ã€‚ Lris12 Helperhaps å¥½äº†ï¼ŒåºŸè¯å°‘è¯´ï¼Œé˜è¿°é—®é¢˜è·Ÿä»£ç  åˆæ¬¡å‘çŽ°è¿™ä¸ªé—®é¢˜çš„æ—¶å€™ï¼Œé¦–å…ˆæŽ’æŸ¥çš„å°±æ˜¯è¯ä¹¦é…ç½®ï¼Œè¿™é‡Œå†æ¬¡å»ºè®®å¤§å®¶å¥½å¥½ä»”ç»†çš„çœ‹çœ‹å¼€å‘æ–‡æ¡£ï¼Œå› ä¸ºå¾ˆå¤šé”™è¯¯éƒ½æ˜¯ç»†èŠ‚å¤„ä¸æ³¨æ„é€ æˆçš„ï¼Œé™„ä¸Šå¼€å‘æ–‡æ¡£åœ°å€ã€‚å› ä¸ºè¿™ä¸ªé¡¹ç›®æ˜¯æŽ¥æ‰‹åˆ«äººå·²ç»åšå¾—å·®ä¸å¤šçš„ï¼Œæˆ‘å°±è´Ÿè´£æ”¶å°¾ï¼Œæ‰€ä»¥ï¼Œè¯ä¹¦è¿™æ–¹é¢æˆ‘ä¼šä¼˜å…ˆæŸ¥çœ‹ï¼Œæ˜¯å¦é”™è¯¯ã€‚ åœ¨developer.apple.com ä¸­ï¼Œæˆ‘å·²ç»çœ‹åˆ° å¾ˆæ˜Žæ˜¾ï¼Œå¼€å‘çŽ¯å¢ƒçš„è¯ä¹¦è·Ÿç”Ÿäº§çŽ¯å¢ƒçš„è¯ä¹¦ï¼Œéƒ½å·²ç»é…ç½®å®Œæˆï¼Œé‚£ä¹ˆè¯ä¹¦æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œä¸‹é¢æˆ‘ä»¬çœ‹çœ‹æžå…‰å®˜ç½‘çš„é…ç½®ï¼š ä¹Ÿæ˜¯å·²éªŒè¯ï¼Œè¿™å°±å¥‡æ€ªäº†ï¼Œåˆ°è¿™ï¼Œæˆ‘è¡¨ç¤ºï¼Œå¯èƒ½æ˜¯ä»£ç å‡ºé”™äº†ï¼Œå¥½å§ï¼Œæˆ‘ä»¬æ¥çœ‹ä»£ç ã€‚ åˆ«åè®¾ç½®ï¼Œç›¸ä¿¡åœ¨å®˜æ–¹æ–‡æ¡£ä¸­å¤§å®¶éƒ½æ˜Žç™½æ€Žä¹ˆå†™ã€‚åå¤æŸ¥çœ‹æ–‡æ¡£ï¼Œæˆ‘å‘çŽ°å¹¶æ²¡æœ‰ä»»ä½•é—®é¢˜è¿™ä¹ˆå†™ã€‚ç»è¿‡è·Ÿ Lris12 å¤§ç¥žçš„äº¤æµï¼Œè§‰å¾—å¾ˆå¯èƒ½æ˜¯å› ä¸ºç½‘ç»œåŽŸå› ï¼Œåœ¨æ³¨å†Œæžå…‰è¿˜æ²¡æœ‰è¿”å›žæˆåŠŸçš„æ—¶å€™ï¼Œå°±ç»‘å®šåˆ«åï¼Œå¯¼è‡´regIDè·Ÿåˆ«åæ²¡æœ‰ç»‘å®šæˆåŠŸã€‚ è§£å†³æ–¹æ³•ï¼š æ·»åŠ 5ä¸ªç›‘å¬ï¼Œåœ¨ç›‘å¬åˆ°extern NSString * const kJPFNetworkDidLoginNotification; // ç™»å½•æˆåŠŸï¼Œä¹‹åŽå†è®¾ç½®åˆ«åã€‚ æžå…‰é›†æˆæŒ‡å— Psï¼šè¿™é‡Œå¼ºçƒˆå»ºè®®è¿™ä¹ˆå†™ï¼Œå®‰å…¨ç¬¬ä¸€ å®‰å…¨ç¬¬ä¸€ï¼ï¼ï¼ è¿™é‡Œé™„ä¸Šä»£ç ï¼š 1234567891011- (void)application:(UIApplication *)application didRegisterForRemoteNotificationsWithDeviceToken:(NSData *)deviceToken&#123;NSNotificationCenter *defaultCenter = [NSNotificationCenter defaultCenter];[defaultCenter addObserver:self selector:@selector(networkDidReceiveMessage:) name:kJPFNetworkDidLoginNotification object:nil];[JPUSHService registerDeviceToken:deviceToken];&#125; //é€šçŸ¥æ–¹æ³• 12345678910111213- (void)networkDidReceiveMessage:(NSNotification *)notification &#123;[JPUSHService setTags:nil aliasInbackground:[OpenUDID value]];dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(1.0f * NSEC_PER_SEC)), dispatch_get_main_queue(), ^&#123;[JPUSHService setTags:nil alias:[OpenUDID value] fetchCompletionHandle:^(int iResCode, NSSet *iTags, NSString *iAlias)&#123;&#125;];&#125;); //é”€æ¯é€šçŸ¥ï¼š 123[[NSNotificationCenter defaultCenter] removeObserver:self name:kJPFNetworkDidLoginNotification object:nil];&#125; ç„¶è€Œï¼Œé—®é¢˜ä¾æ—§æ²¡æœ‰è§£å†³ï¼Œä½†æ˜¯è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬ç™»å½•æžå…‰å®˜ç½‘æŽ¨é€ã€‚æˆ‘åœ¨ç”Ÿäº§çŽ¯å¢ƒï¼Œå†æ¬¡å‘é€ï¼Œå¹¿æ’­ï¼Œåˆ«åï¼ŒregIDï¼Œç»“æžœï¼Œéƒ½æ”¶åˆ°äº†ï¼ï¼æ­£å½“æˆ‘é«˜å…´çš„æ—¶å€™ï¼Œå‘çŽ° apiæŽ¨é€ä¾æ—§æ”¶ä¸åˆ°ï¼ï¼æ”¶ä¸åˆ°ï¼ï¼ç»æœ›ï¼ï¼ ç»§ç»­æŽ’æŸ¥ï¼ï¼ï¼æŒ‰ç…§å¼€å‘æ–‡æ¡£ï¼Œè®¾ç½®xcodeé…ç½®ï¼Œå—¯ ï¼Œä¾æ—§æ²¡ç”¨ã€‚ è¿™é‡Œæˆ‘é‡ç‚¹è¯´ä¸€ä¸‹ ï¼šiOS9 ä¹‹åŽ å¸è½½é‡è£…åŽä¼šæ”¹å˜tokenï¼Œæ‰€ä»¥registrationIDä¼šæ”¹å˜ï¼Œå¦‚æžœä½ æ²¡æœ‰ç”¨åˆ°idfaã€‚å¦‚æžœä½ çš„é¡¹ç›®ä½¿ç”¨çš„æ˜¯regIDæŽ¨é€ï¼Œé‚£ä¹ˆä½ è¦æ³¨æ„ï¼Œæ¯æ¬¡æ›´æ–°appï¼Œæ–°ç”¨æˆ·ä¸‹è½½appï¼Œé‡æ–°ä¸‹è½½appç­‰ä¸€ç³»åˆ—çŠ¶å†µä¸‹ï¼ŒregIDæ”¹å˜çš„é—®é¢˜ã€‚è¿˜æœ‰å¦‚æžœæ³¨å†ŒæˆåŠŸåŽï¼Œä¼šè¿”å›žï¼Œè®¾ç½®æˆåŠŸï¼Œæœ‰callbackä¸º0ã€‚è¿™ä¸ªä¹Ÿè¦æ³¨æ„ä¸‹ã€‚ å¥½ï¼Œå›žå½’æ­£é¢˜ã€‚è¿™æ—¶å€™æ—¶é—´å·²ç»è¿‡åŽ»ä¸€å¤©åŠäº†ï¼Œ æœ€åŽæˆ‘è§‰å¾—ï¼Œæˆ‘æ‰€æœ‰çš„ä»£ç ï¼Œé…ç½®ï¼Œè¯ä¹¦ï¼ŒçŽ¯å¢ƒï¼Œéƒ½æ²¡æœ‰é—®é¢˜ï¼å†åŽ»æžå…‰å®˜ç½‘çœ‹çœ‹ï¼Œåˆ°åº•å’‹å›žäº‹ã€‚ å¥½å— è¿™ä¸€çœ‹ ç»ˆäºŽå‘çŽ°äº†é—®é¢˜æ‰€åœ¨ï¼ å¤§å®¶çœ‹æ²¡çœ‹åˆ°ï¼Œè¿™é‡Œå†™çš„æ˜¯æŽ¨é€å¹³å°iOS-devï¼Ÿå§æ§½ï¼ï¼åŽå°ç»™æˆ‘æŽ¨é€çš„å±…ç„¶æ˜¯å¼€å‘çŽ¯å¢ƒï¼ï¼æžœæ–­æ‰¾åŽå°ç†è®ºï¼ï¼ï¼ Lriså¤§ç¥žå‘Šè¯‰æˆ‘ï¼šã€Œå‘å¸ƒç‰ˆæœ¬åŽæ— æ³•æœ‰æ•ˆæŽ¨é€ã€ or ã€Œç”Ÿäº§çŽ¯å¢ƒä¸‹æ”¶ä¸åˆ°æ¶ˆæ¯ã€ æŒ‰ä»¥ä¸‹æ­¥éª¤æŽ’æŸ¥é—®é¢˜ï¼š å®¢æˆ·ç«¯ï¼ï¼ï¼ï¼ï¼žå®¢æˆ·ç«¯æ˜¯å¦æ‰“åŒ…è¯ä¹¦ï¼ï¼ï¼ï¼ï¼žæ£€æŸ¥å½“å‰çŽ¯å¢ƒæ˜¯å¦æ­£ç¡®ï¼ï¼ï¼ï¼ï¼ï¼žè®¾å¤‡é‡Œé¢çš„æ‰‹æœºåº”ç”¨æœ‰æ²¡æœ‰æ·»åŠ /é…ç½®è¿™ä¸ªtag/ åˆ«åï¼ï¼ï¼ï¼žæœåŠ¡ç«¯æ³¨æ„æ”¹å˜çŽ¯å¢ƒå‚æ•°ï¼Œoptionçš„apns_productionçš„å€¼ï¼ˆtrueï¼šç”Ÿäº§ï¼‰ï¼ˆfalseå¼€å‘ï¼‰ã€‚æ ¹æ®å®¢æˆ·ç«¯çŽ¯å¢ƒæ”¹å˜æœåŠ¡ç«¯æŽ¨é€çŽ¯å¢ƒã€‚çŽ¯å¢ƒè¦ä¸€è‡´æ‰èƒ½æ”¶åˆ°æŽ¨é€ã€‚ ç„¶åŽæˆ‘ä»¬åŽå°ç»™æˆ‘å‘é€äº†ä¸€æ®µä»£ç  å µä½äº†æˆ‘çš„å˜´ï¼š 12345$platform = &apos;android,ios&apos; ;$msg_content = json_encode(array(&apos;n_builder_id&apos;=&gt;0, &apos;n_title&apos;=&gt;$n_title, &apos;n_content&apos;=&gt;$n_content,&apos;content-available&apos;=&gt;1,&apos;apns_production&apos;=&gt;1));$obj = new jpush($masterSecret,$appkeys); æˆ‘æ ‡çº¢çš„ä½ç½®ï¼Œäººå®¶å·²ç»è®¾ç½®äº†1ï¼Œä¸ºä»€ä¹ˆè¿˜ä¸å¥½ç”¨ï¼Ÿç»è¿‡Helperhapså¤§ç¥žçš„è§£é‡Šï¼Œå¥½å§ï¼Œæˆ‘æ‡‚äº†ï¼æˆ‘ä»¬åŽå°ä½¿ç”¨çš„è¿‡æœŸçš„V2 apiã€‚ ç‰¹åˆ«æç¤ºï¼šå»ºè®®ä¸è¦åœ¨å®¢æˆ·ç«¯é‡Œå†™ä»£ç ç›´æŽ¥è°ƒç”¨æ­¤ APIã€‚å› ä¸º Android apk æ¯”è¾ƒå®¹æ˜“ç ´è§£ï¼Œåˆ«äººå¾ˆå®¹æ˜“ä»Žå®¢æˆ·ç«¯ä»£ç é‡Œæ‰¾å‡ºæ¥è°ƒç”¨ JPush Remote API æ‰€éœ€è¦çš„ä¿å¯†ä¿¡æ¯ï¼Œä»Žè€Œå¯ä»¥æ¨¡æ‹Ÿåˆ°ä½ çš„èº«ä»½æ¥å‘èµ·æ¶æ„çš„æŽ¨é€ã€‚ å»ºè®®çš„ä½¿ç”¨æ–¹å¼æ˜¯ï¼šè°ƒç”¨ JPush Remote API çš„ä»£ç æ”¾åœ¨ä½ è‡ªå·±çš„åº”ç”¨æœåŠ¡å™¨ä¸Šã€‚ä½ è‡ªå·±çš„åº”ç”¨æœåŠ¡å™¨å¯¹è‡ªå·±çš„å®¢æˆ·ç«¯æä¾›æŽ¥å£æ¥æŽ¨é€æ¶ˆæ¯ã€‚å…·ä½“è¯·å‚è€ƒæŽ¨èŠçš„ä½œæ³•ï¼šç¤ºä¾‹ä¸Žä»£ç ã€‚ å‡çº§åˆ° v3 Push APIï¼šå»ºè®®å¼€å‘è€…å‡çº§åˆ° v3 ç‰ˆæœ¬ã€‚æ­¤ç‰ˆæœ¬ä¼šç»§ç»­æ”¯æŒåˆ° 2015 å¹´ã€‚è‡³æ­¤ï¼Œè¿™ä¸ªé—®é¢˜æ‰ç®—æ˜¯è§£å†³ï¼ˆè‡³å°‘å¯¹å‰ç«¯æ¥è¯´ï¼‰ã€‚ç¬¬ä¸€æ¬¡å‘è¿™æ ·çš„å¸–å­æ„Ÿè§‰æœ‰ç‚¹ä¹± å—¯ã€‚ã€‚ã€‚ ä¸‹æ¬¡å¤§å®¶åœ¨æŽ¨é€ä¸Šæœ‰é—®é¢˜çš„è¯ã€‚ã€‚å…ˆçœ‹å¼€å‘æ–‡æ¡£èµ°ä¸€éæµç¨‹ï¼Œç„¶åŽçœ‹çœ‹æžå…‰ä¸ªäººæŽ¨é€ï¼Œå¹¿æ’­èƒ½å¦æ”¶åˆ°ï¼Œç„¶åŽå°±å¯ä»¥è€ƒè™‘è·ŸæœåŠ¡ç«¯å¹²ä¸€ä»—äº†ï¼ï¼ æœ€åŽç¥å¤§å®¶ æ°¸æ— BUGï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ è½¬è‡ªï¼šhttp://www.jianshu.com/p/0d382c4d98ff]]></content>
      <categories>
        <category>iOS æŽ¨é€</category>
      </categories>
      <tags>
        <tag>jpush</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[React-Native å¥‡è‘©æŠ¥é”™]]></title>
    <url>%2F2017%2F03%2F22%2FrnPortCrash%2F</url>
    <content type="text"><![CDATA[åˆšå†™äº†ä¸€ä¸ªreact-nativeå°demoï¼Œå®Œç¾Žè¿è¡Œï¼Œå¿ƒä¸­çªƒå–œï¼ŒäºŽæ˜¯å…³é—­é¡¹ç›®ã€‚è¿‡äº†ä¸€ä¼šå„¿ï¼Œæƒ³å†ä¸€ç¹åˆšæ‰å¦‚è¡Œäº‘æµæ°´èˆ¬è¿è¡Œçš„é¡¹ç›®ï¼ŒäºŽæ˜¯ï¼Œè¿è¡Œï¼Œç»“æžœâ€¦â€¦çº³å°¼ï¼Ÿå‡ºçŽ°äº†ä¸€ç‰‡å§¨å¦ˆçº¢æœ‰æ²¡æœ‰ï¼Ÿå¿ƒä¸­ä¸€ä¸‡å¤´è‰æ³¥é©¬å‘¼å•¸è€Œè¿‡æœ‰æ²¡æœ‰ï¼Ÿåˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ NAï¼é˜¿sirå•Šï¼Œæˆ‘è¯´äº†æˆ‘æ²¡åŠ¨è¿‡ä»£ç å•¦ï¼Œå‡ºçŽ°ä¸‹é¢è¿™ç§é”™è¯¯ä¸å…³æˆ‘çš„äº‹å•Šï¼š12ProjectName has not been registered. This is either due to a require() error during initialization or failure to call AppRegistry.registerComponent. åˆ†æžé”™è¯¯åŽŸå› ï¼š 1.ç¬¬ä¸€ç§æƒ…å†µï¼šç¨‹åºå…¥å£å¤„é¡¹ç›®åç§°ä¸ä¸€è‡´ã€‚æ£€æŸ¥å‘çŽ°ï¼š 1AppRegistry.registerComponent(&apos;ProjectName&apos;, () =&gt; ProjectName); ä¸€æ¨¡ä¸€æ ·ï¼ä¸ºäº†æ‹…å¿ƒæ€•è‡ªå·±çš„çœ¼ç›çœ‹åˆ°çš„ä¸æ˜¯çœŸå®žçš„ï¼Œç‰¹åœ°ç²˜è´´å¤åˆ¶äº†ä¸€éï¼ ç¬¬ä¸€ç§æƒ…å†µæŽ’é™¤ï¼ 2.ç¬¬äºŒç§æƒ…å†µ8081ç«¯å£è¢«å ç”¨ æ£€éªŒæ–¹æ³•ï¼šåˆ°é¡¹ç›®æ ¹ç›®å½•ä¸‹---------&gt;&gt;&gt;æ‰“å¼€ç»ˆç«¯---------&gt;&gt;&gt;è¾“å…¥å‘½ä»¤è¡Œï¼šreact-native start å¦‚æžœå‡ºçŽ°äº†Packager can&#39;t listen on port 8081,å¥½çš„æ­å–œä½ ï¼Œæ‰¾åˆ°äº†ç—‡ç»“æ‰€åœ¨ï¼Œä¸‹é¢å°±æ˜¯æ ¹æ®æç¤ºæ¥å°±å¥½äº†ï¼š .lsof -i : 8081 //åˆ—å‡ºè¢«å ç”¨çš„ç«¯å£ .kill -9 &lt; PID &gt; //æ‰¾å‡ºä¸Žä¹‹å¯¹åº”çš„PIDï¼Œæ€æ­»å°±okäº† .é‡æ–°è¿è¡Œé¡¹ç›® .ä¾æ—§å®Œç¾Ž]]></content>
      <categories>
        <category>react-nativeå­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>8081port</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[React-Native ä¹‹index.ios.jsè§£è¯»]]></title>
    <url>%2F2017%2F03%2F22%2FexplainIndexiosjs%2F</url>
    <content type="text"><![CDATA[æ’¸ä»£ç ä¹‹å‰è¿˜æ˜¯è¦æžæ¸…æ¥šä½œç”¨æ¯”è¾ƒå¥½ï¼Œä¸ç„¶æ´‹æ´‹æ´’æ´’çš„æ’¸äº†ä¸ªå¤©æ˜åœ°æš—ï¼Œå´ä¸çŸ¥é“ä¸ºä»€ä¹ˆç”¨è¿™ä¸ªå§¿åŠ¿æ’¸ï¼Œä¸å°±å°´å°¬äº†å—ï¼Ÿè¦çŸ¥å…¶ç„¶ï¼Œè¿˜è¦çŸ¥å…¶æ‰€ä»¥ç„¶ï¼Œè®ºæŽŒæ¡æ’¸ä»£ç å§¿åŠ¿çš„é‡è¦æ€§ï¼ React.nativeæ˜¯facebookå¼€æºçš„ä¸€å¥—åŸºäºŽJavaScriptçš„å¼€æºæ¡†æž¶ï¼Œå¾ˆæ–¹ä¾¿ç”¨æ¥å¼€å‘ç§»åŠ¨è®¾å¤‡çš„appã€‚è€Œä¸”ï¼Œæ–¹ä¾¿åŠæ—¶æ›´æ–°appçš„UIä¸Žæ•°æ®ï¼Œä¹Ÿå¾ˆæ–¹ä¾¿éƒ¨ç½²ã€‚ åœ¨react-nativeçš„iosé¡¹ç›®ä¸­ï¼Œç•Œé¢æ­å»ºéƒ¨åˆ†æ˜¯ä¸€ä¸ªjsæ–‡ä»¶ï¼šindex.ios.jsã€‚ä¸‹é¢å¯¹è¿™ä¸ªæ–‡ä»¶è¿›è¡Œä¸€ä¸‹è§£è¯»ï¼Œæ–¹ä¾¿åŽç»­å¼€å‘ä¸­æ˜Žç™½å„ä¸ªéƒ¨åˆ†çš„ä½œç”¨ã€‚ 1ã€å¼•ç”¨React1import React, &#123; Component &#125; from &apos;react&apos;; 2ã€æŽ§ä»¶çš„å¼•å…¥12345678import &#123;AppRegistry,StyleSheet,Text,View,ListView,TouchableOpacity&#125; from &apos;react-native&apos;; 3ã€æ ·å¼è®¾ç½®12345678910111213141516171819//è®¾ç½®æ ·å¼const styles = StyleSheet.create(&#123;container: &#123;flex: 1,justifyContent: &apos;center&apos;,alignItems: &apos;center&apos;,backgroundColor: &apos;#F5FCFF&apos;,&#125;,welcome: &#123;fontSize: 20,textAlign: &apos;center&apos;,margin: 10,&#125;,instructions: &#123;textAlign: &apos;center&apos;,color: &apos;#333333&apos;,marginBottom: 5,&#125;,&#125;); ä½œç”¨ï¼šå®šä¹‰äº†ä¸€æ®µåº”ç”¨åœ¨ â€œHello Worldâ€ æ–‡æœ¬ä¸Šçš„æ ·å¼ã€‚ React Native ä½¿ç”¨ CSS æ¥å®šä¹‰åº”ç”¨ç•Œé¢çš„æ ·å¼ã€‚ 4ã€åˆ›å»ºReactç»„ä»¶å¯¹åº”çš„ç±»123456789101112131415161718export default class HelloWorld extends Component &#123;render() &#123;return (&lt;View style=&#123;styles.container&#125;&gt;&lt;Text style=&#123;styles.welcome&#125;&gt;Welcome to React Native!&lt;/Text&gt;&lt;Text style=&#123;styles.instructions&#125;&gt;To get started, edit index.android.js&lt;/Text&gt;&lt;Text style=&#123;styles.instructions&#125;&gt;Double tap R on your keyboard to reload,&#123;&apos;\n&apos;&#125;Shake or press menu button for dev menu&lt;/Text&gt;&lt;/View&gt;);&#125;&#125; ä½œç”¨ï¼šæè¿°å°†è¦åˆ›å»ºçš„ç»„ä»¶ï¼ŒåŒ…æ‹¬å„ç§è¡Œä¸ºå’Œå±žæ€§ã€‚ 5ã€è§£é‡Šä¸€ä¸‹ ç»„ä»¶æ¸²æŸ“çš„æ–¹æ³• 123render() &#123;return ();&#125; æ³¨æ„ï¼šåªæœ‰å½“ç»„ä»¶è¢«æ¸²æŸ“æ—¶ï¼Œå¿…é¡»å®žçŽ°renderæŽ¥å£æ–¹æ³•ï¼Œå› ä¸ºï¼Œåªæœ‰renderæ–¹æ³•ï¼Œæ˜¯ç”¨äºŽè¾“å‡ºå†…å®¹ç»„ä»¶å†…å®¹çš„ï¼›å…¶ä»–æŽ¥å£æ–¹æ³•ï¼Œéƒ½æ˜¯å¯é€‰çš„ã€‚ æ ‡ç­¾å®šä¹‰è§†å›¾ 12&lt;View style=&#123;styles.container&#125;&gt;&lt;/View&gt; ä½œç”¨ï¼šè®¾ç½®æ˜¾ç¤ºåŒºåŸŸï¼Œç›¸å½“äºŽiOSä¸­çš„UIViewæŽ§ä»¶ï¼ˆObjective-cå’ŒSwiftï¼‰ æ ‡ç­¾å®šä¹‰æ–‡æœ¬ 123&lt;Text style=&#123;styles.welcome&#125;&gt;Welcome to React Native!&lt;/Text&gt; ä½œç”¨ï¼šè®¾ç½®å¹¶æ˜¾ç¤ºå­—ç¬¦ä¸²ï¼Œç›¸å½“äºŽiOSçš„UILabelæŽ§ä»¶ï¼ˆObjective-cå’ŒSwiftï¼‰ã€‚ å®šä¹‰ç¨‹åºå…¥å£ 1AppRegistry.registerComponent(&apos;HelloWorld&apos;, () =&gt; HelloWorld); ä½œç”¨ï¼šç”¨AppRegistryçš„registerComponent( )æ–¹æ³•ï¼Œå®šä¹‰äº†Appçš„å…¥å£ï¼Œå¹¶æä¾›äº†æ ¹ç»„ä»¶ã€‚ è½¬è‡ªï¼šhttp://blog.csdn.net/maoyingyong/article/details/46439951]]></content>
      <categories>
        <category>react-nativeå­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>index.ios.js</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[React-Native ä¹‹ListView]]></title>
    <url>%2F2017%2F03%2F22%2Freact-native-listView%2F</url>
    <content type="text"><![CDATA[æœ€è¿‘åœ¨æ‘¸ç´¢react-nativeï¼Œè™½ç„¶è‹¹æžœçˆ¸çˆ¸å·²ç»åœ¨ä¹‹å‰å°æ€äº†JSPatchï¼Œæˆ‘è¿˜æ˜¯æŠ±ç€è¯•ä¸€è¯•çš„æ€åº¦å…ˆå­¦ä¸€ä¸ªç–—ç¨‹ï¼Œæ¯•ç«Ÿï¼ŒçŸ¥è¯†å˜›ï¼Œå¤šå­¦ç‚¹æ€»æ˜¯å¥½çš„ã€‚ å…¶å®žå¯¹äºŽjsæˆ‘äº†è§£çš„ä¸å¤šï¼Œæ‰€ä»¥ä¸€äº›ä¸œè¥¿ç»™ä¸äº†ç›¸åº”çš„è§£é‡Šï¼Œè¿˜è¯·è§è°…ï¼ˆpsï¼šæˆ‘çš„å­¦ä¹ é˜¶æ®µéƒ½æ˜¯ä»Žæ¨¡ä»¿å¼€å§‹çš„ï¼‰ã€‚åŽé¢æˆ‘ä¼šä¸æ–­çš„å­¦ä¹ åŸºç¡€çŸ¥è¯†ï¼ŒæŠŠç›¸åº”çš„è§£é‡Šä¼šæ·»åŠ ä¸ŠåŽ»çš„ã€‚è§ç¬‘äº†ï¼ æŽ¥ä¸‹æ¥å…ˆå­¦ä¹ ä¸€ä¸‹å¦‚ä½•åˆ›å»ºä¸€ä¸ªListViewã€‚ 1.è®¾ç½®æ ·å¼ä¸Šä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334353637//è®¾ç½®æ ·å¼const styles = StyleSheet.create(&#123;//æ•´ä¸ªlistViewçš„æ ·å¼è®¾ç½®outerViewStyle: &#123;//å æ»¡çª—å£flex: 1&#125;,//ä¸€ä¸ªè‡ªå®šä¹‰viewçš„æ ·å¼è®¾ç½®headerViewStyle: &#123;height: 64,backgroundColor: &apos;orange&apos;,justifyContent: &apos;center&apos;,alignItems: &apos;center&apos;&#125;,//åˆ—è¡¨rowçš„æ ·å¼è®¾ç½®rowStyle: &#123;//è®¾ç½®ä¸»è½´çš„æ–¹å‘flexDirection: &apos;row&apos;,//ä¾§è½´æ–¹å‘å±…ä¸­alignItems: &apos;center&apos;,padding: 10,//å•å…ƒæ ¼åº•éƒ¨çš„çº¿è®¾ç½®borderBottomColor: &apos;#e8e8e8&apos;,borderBottomWidth: 0.5&#125;,//åˆ†åŒºå¤´éƒ¨viewçš„æ ·å¼è®¾ç½®sectionHeaderViewStyle: &#123;backgroundColor: &apos;#e8e8e8&apos;,justifyContent: &apos;center&apos;,height: 25&#125;&#125;); ä»¥ä¸Šå°±æ˜¯æœ¬listViewèƒ½ç”¨åˆ°çš„ä¸€äº›è®¾ç½®ã€‚ 2.èŽ·å–æ•°æ®ç”¨åˆ°çš„æ•°æ®æ˜¯æœ¬åœ°çš„jsonæ•°æ® 1234567891011121314151617181920212223242526272829303132333435363738394041//è°ƒå–æ•°æ®componentDidMount()&#123;this.loadDataFromJson();&#125;,var Car = require(&apos;./Car.json&apos;);loadDataFromJson()&#123;//èŽ·å–jsonæ•°æ®var jsonData = Car.data;//å®šä¹‰ä¸€äº›å˜é‡var dataBlob = &#123;&#125;,sectionIDs = [],rowIDs = [],cars = [];for (var i = 0; i &lt; jsonData.length; i++) &#123;//1.æŠŠåŒºå·æ”¾å…¥sectionIDsæ•°ç»„ä¸­sectionIDs.push(i);//2.æŠŠåŒºä¸­çš„å†…å®¹æ”¾å…¥dataBlobå¯¹è±¡ä¸­dataBlob[i] = jsonData[i].title;//3.å–å‡ºè¯¥ç»„ä¸­æ‰€æœ‰çš„è½¦cars = jsonData[i].cars;rowIDs[i] = [];//éåŽ†æ‰€æœ‰çš„è½¦æ•°ç»„for (var j = 0; j &lt; cars.length; j++) &#123;//1.æŠŠè¡Œå·æ”¾å…¥rowIDs[i]ä¸­rowIDs[i].push(j);//2.æŠŠæ¯ä¸€è¡Œçš„å†…å®¹æ”¾å…¥dataBlobå¯¹è±¡ä¸­dataBlob[i + &apos;:&apos; + j] = cars[j];&#125;&#125;//æ›´æ–°çŠ¶æ€this.setState(&#123;dataSource: this.state.dataSource.cloneWithRowsAndSections(dataBlob,sectionIDs,rowIDs)&#125;);&#125;, 3.åˆå§‹åŒ–å‡½æ•°123456789101112131415161718192021222324252627282930//åˆå§‹åŒ–å‡½æ•°getInitialState()&#123;//é…ç½®åŒºæ•°æ®var getSectionData = (dataBlob,sectionID) =&gt; &#123;return dataBlob[sectionID];&#125;;//é…ç½®è¡Œæ•°æ®var getRowData = (dataBlob,sectionID,rowID) =&gt; &#123;return dataBlob[sectionID + &apos;:&apos; +rowID];&#125;;return &#123;dataSource : new ListView.DataSource(&#123;getSectionData: getSectionData,//èŽ·å–åŒºä¸­çš„æ•°æ®getRowData: getRowData,//èŽ·å–è¡Œä¸­çš„æ•°æ®rowHasChanged: (r1,r2) =&gt; r1 !== r2,sectionHeaderHasChanged: (s1,s2) =&gt; s1 !== s2&#125;)&#125;&#125;,render() &#123;return (&lt;ListView /&gt;);&#125;, 4.é…ç½®æ•°æ®123456789101112131415161718// æ¯ä¸€è¡Œçš„æ•°æ®renderRow(rowData)&#123;return(&lt;TouchableOpacity activeOpacity=&#123;0.5&#125;&gt;&lt;View style=&#123;styles.rowStyle&#125;&gt;&lt;Text style=&#123;&#123;marginLeft:5&#125;&#125;&gt;&#123;rowData.name&#125;&lt;/Text&gt;&lt;/View&gt;&lt;/TouchableOpacity&gt;);&#125;,renderSectionHeader(sectionData,sectionID) &#123;return(&lt;View style=&#123;styles.sectionHeaderViewStyle&#125;&gt;&lt;Text style=&#123;&#123;marginLeft:5,color:&apos;red&apos;&#125;&#125;&gt;&#123;sectionData&#125;&lt;/Text&gt;&lt;/View&gt;);&#125; 5.ç•Œé¢æ˜¾ç¤º1234567891011121314render()&#123;return (&lt;View style = &#123;styles.outerViewStyle&#125;&gt;&lt;View style=&#123;styles.headerViewStyle&#125;&gt;&lt;Text style=&#123;&#123;color:&apos;white&apos;,fontSize:25&#125;&#125;&gt;è½¦çš„å“ç‰Œ&lt;/Text&gt;&lt;/View&gt;&lt;ListViewdataSource=&#123;this.state.dataSource&#125;renderRow=&#123;this.renderRow&#125;renderSectionHeader=&#123;this.renderSectionHeader&#125;/&gt;&lt;/View&gt;);&#125;, ä¸Šä¸€ä¸ªæ•ˆæžœå›¾ï¼š ç”±äºŽæœ¬äººä¹Ÿæ˜¯åˆšåˆšçª¥æŽ¢rnï¼Œæ‰€ä»¥å¾ˆå¤šåœ°æ–¹éƒ½æ˜¯ä¸æ±‚ç”šè§£ï¼Œæ‰€ä»¥å¾ˆå¤šåœ°æ–¹æ²¡æœ‰ç»™å‡ºç›¸åº”çš„è§£é‡Šï¼Œè¿˜è¯·è§è°…ï¼è¿™é‡Œç»™å‡ºæºç ï¼Œå¤§å®¶å¯ä»¥å…±åŒå­¦ä¹ ï¼ æ€’æˆ³æˆ‘ï¼Œå¾—æºç ï¼]]></content>
      <categories>
        <category>react-nativeå­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>listView</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[moya + RxSwift è¿›è¡Œç½‘ç»œè¯·æ±‚]]></title>
    <url>%2F2017%2F03%2F13%2Fmoya%2F</url>
    <content type="text"><![CDATA[å¦‚åœ¨OCä¸­ä½¿ç”¨AFNetworkingä¸€èˆ¬,Swiftæˆ‘ä»¬ç”¨Alamofireæ¥åšç½‘ç»œåº“.è€ŒMoyaåœ¨Alamofireçš„åŸºç¡€ä¸Šåˆå°è£…äº†ä¸€å±‚: 1.å…³äºŽmoya å®˜æ–¹è¯´moyaæœ‰ä»¥ä¸‹ç‰¹æ€§-_-: ç¼–è¯‘æ—¶æ£€æŸ¥æ­£ç¡®çš„APIç«¯ç‚¹è®¿é—®. ä½¿ä½ å®šä¹‰ä¸åŒç«¯ç‚¹æžšä¸¾å€¼å¯¹åº”ç›¸åº”çš„ç”¨é€”æ›´åŠ æ˜Žæ™°. æé«˜æµ‹è¯•åœ°ä½ä»Žè€Œä½¿å•å…ƒæµ‹è¯•æ›´åŠ å®¹æ˜“. 2.å¼€å§‹1.åˆ›å»ºæžšä¸¾APIå°±åƒè¿™æ ·: 1234567enum APIManager &#123;case getNewsLatest//èŽ·å–æœ€æ–°æ¶ˆæ¯case getStartImage// å¯åŠ¨ç•Œé¢å›¾åƒèŽ·å–case getVersion(String)//è½¯ä»¶ç‰ˆæœ¬æŸ¥è¯¢case getThemes//ä¸»é¢˜æ—¥æŠ¥åˆ—è¡¨æŸ¥çœ‹case getNewsDetail(Int)//èŽ·å–æ–°é—»è¯¦æƒ…&#125; 2.å®žçŽ°TargetTypeåè®®å°±åƒè¿™æ ·: 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970extension APIManager: TargetType &#123;/// The target&apos;s base `URL`.var baseURL: URL &#123;return URL.init(string: &quot;http://news-at.zhihu.com/api/&quot;)!&#125;/// The path to be appended to `baseURL` to form the full `URL`.var path: String &#123;switch self &#123;case .getNewsLatest:return &quot;4/news/latest&quot;case .getStartImage://start-image åŽä¸ºå›¾åƒåˆ†è¾¨çŽ‡ï¼ŒæŽ¥å—ä»»æ„çš„ number*number æ ¼å¼ï¼Œ number ä¸ºä»»æ„éžè´Ÿæ•´æ•°ï¼Œè¿”å›žå€¼å‡ç›¸åŒã€‚return &quot;4/start-image/1080*1776&quot;case .getVersion(let version)://URL æœ€åŽéƒ¨åˆ†çš„æ•°å­—ä»£è¡¨æ‰€å®‰è£…ã€ŽçŸ¥ä¹Žæ—¥æŠ¥ã€çš„ç‰ˆæœ¬return &quot;4/version/ios/&quot; + versioncase .getThemes:return &quot;4/themes&quot;case .getNewsDetail(let id):return &quot;4/news/\(id)&quot;&#125;&#125;/// The HTTP method used in the request.var method: Moya.Method &#123;return .get&#125;/// The parameters to be incoded in the request.var parameters: [String: Any]? &#123;return nil&#125;/// The method used for parameter encoding.var parameterEncoding: ParameterEncoding &#123;return URLEncoding.default&#125;/// Provides stub data for use in testing.var sampleData: Data &#123;return &quot;&quot;.data(using: String.Encoding.utf8)!&#125;/// The type of HTTP task to be performed.var task: Task &#123;return .request&#125;/// Whether or not to perform Alamofire validation. Defaults to `false`.var validate: Bool &#123;return false&#125;&#125; åœ¨è¿™é‡Œ,å¯ä»¥è®¾ç½®è¯·æ±‚çš„å‚æ•°,ä¾‹å¦‚urlâ€¦â€¦methodâ€¦â€¦paraç­‰. 3.ä½¿ç”¨Moyaçš„ä½¿ç”¨éžå¸¸ç®€å•ï¼Œé€šè¿‡TargetTypeåè®®å®šä¹‰å¥½æ¯ä¸ªtargetä¹‹åŽï¼Œå°±å¯ä»¥ç›´æŽ¥ä½¿ç”¨Moyaå¼€å§‹å‘é€ç½‘ç»œè¯·æ±‚äº†ã€‚å°±åƒè¿™æ ·: 1234let provider = MoyaProvider&lt;APIManager&gt;()provider.request(.getNewsLatest) &#123; result in// do something with result&#125; 3.é…åˆRxSwiftMoyaæœ¬èº«å·²ç»æ˜¯ä¸€ä¸ªä½¿ç”¨èµ·æ¥éžå¸¸æ–¹ä¾¿ï¼Œèƒ½å¤Ÿå†™å‡ºéžå¸¸ç®€æ´ä¼˜é›…çš„ä»£ç çš„ç½‘ç»œå°è£…åº“ï¼Œä½†æ˜¯è®©Moyaå˜å¾—æ›´åŠ å¼ºå¤§çš„åŽŸå› ä¹‹ä¸€è¿˜å› ä¸ºå®ƒå¯¹äºŽFunctional Reactive Programmingçš„æ‰©å±•ï¼Œå…·ä½“è¯´å°±æ˜¯å¯¹äºŽRxSwiftå’ŒReactiveCocoaçš„æ‰©å±•ï¼Œé€šè¿‡ä¸Žè¿™ä¸¤ä¸ªåº“çš„ç»“åˆï¼Œèƒ½è®©Moyaå˜å¾—æ›´åŠ å¼ºå¤§ã€‚æˆ‘é€‰æ‹©RxSwiftçš„åŽŸå› æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯RxSwiftçš„åº“ç›¸å¯¹æ¥è¯´æ¯”è¾ƒè½»é‡çº§ï¼Œè¯­æ³•æ›´æ–°ç›¸å¯¹æ¥è¯´æ¯”è¾ƒå°‘ï¼Œæˆ‘ä¹‹å‰ç”¨è¿‡ReactiveCocoaï¼Œä¸€äº›å¤§ç‰ˆæœ¬çš„æ›´æ–°éœ€æ±‚é‡å†™å¾ˆå¤šä»£ç ï¼Œç¬¬äºŒä¸ªæ›´é‡è¦çš„åŽŸå› æ˜¯å› ä¸ºRxSwiftèƒŒåŽæœ‰æ•´ä¸ªReactiveXçš„æ”¯æŒï¼Œé‡Œé¢åŒ…æ‹¬Javaï¼ŒJSï¼Œ.Net, Swiftï¼ŒScalaï¼Œå®ƒä»¬å†…éƒ¨éƒ½ç”¨äº†ReactiveXçš„é€»è¾‘æ€æƒ³ï¼Œè¿™æ„å‘³ç€ä½ ä¸€æ—¦å­¦ä¼šäº†å…¶ä¸­çš„ä¸€ä¸ªï¼Œä»¥åŽå¯ä»¥å¾ˆå¿«çš„ä¸Šæ‰‹ReactiveXä¸­çš„å…¶ä»–è¯­è¨€ã€‚ Moyaæä¾›äº†éžå¸¸æ–¹é¢çš„RxSwiftæ‰©å±•ï¼š 123456789let provider = RxMoyaProvider&lt;APIManager&gt;()provider.request(.getNewsLatest).filterSuccessfulStatusCodes().mapJSON().subscribe(onNext: &#123; (json) in//do something with postsprint(json)&#125;).addDisposableTo(disposeBag) è§£é‡Šä¸€ä¸‹: RxMoyaProvideræ˜¯MoyaProviderçš„å­ç±»ï¼Œæ˜¯å¯¹RxSwiftçš„æ‰©å±• filterSuccessfulStatusCodes()æ˜¯Moyaä¸ºRxSwiftæä¾›çš„æ‰©å±•æ–¹æ³•ï¼Œé¡¾åæ€ä¹‰ï¼Œå¯ä»¥å¾—åˆ°æˆåŠŸåœ°ç½‘ç»œè¯·æ±‚ï¼Œå¿½ç•¥å…¶ä»–çš„ mapJSON()ä¹Ÿæ˜¯Moya RxSwiftçš„æ‰©å±•æ–¹æ³•ï¼Œå¯ä»¥æŠŠè¿”å›žçš„æ•°æ®è§£æžæˆ JSON æ ¼å¼ subscribe æ˜¯ä¸€ä¸ªRxSwiftçš„æ–¹æ³•ï¼Œå¯¹ç»è¿‡ä¸€å±‚ä¸€å±‚å¤„ç†çš„ Observable è®¢é˜…ä¸€ä¸ª onNext çš„ observerï¼Œä¸€æ—¦å¾—åˆ° JSON æ ¼å¼çš„æ•°æ®ï¼Œå°±ä¼šç»è¡Œç›¸åº”çš„å¤„ç† addDisposableTo(disposeBag) æ˜¯ RxSwift çš„ä¸€ä¸ªè‡ªåŠ¨å†…å­˜å¤„ç†æœºåˆ¶ï¼Œè·ŸARCæœ‰ç‚¹ç±»ä¼¼ï¼Œä¼šè‡ªåŠ¨æ¸…ç†ä¸éœ€è¦çš„å¯¹è±¡ã€‚ 4.é…åˆHandyJSONåœ¨å®žé™…åº”ç”¨è¿‡ç¨‹ä¸­ç½‘ç»œè¯·æ±‚å¾€å¾€ç´§å¯†è¿žæŽ¥ç€æ•°æ®å±‚ï¼ˆModelï¼‰ï¼Œå…·ä½“åœ°è¯´ï¼Œåœ¨æˆ‘ä»¬çš„è¿™ä¸ªä¾‹å­ä¸­ï¼Œä¸€èˆ¬æˆ‘ä»¬éœ€è¦å»ºç«‹ä¸€ä¸ªç±»ç”¨æ¥ç»Ÿä¸€ç®¡ç†æ•°æ®ï¼Œç„¶åŽæŠŠå¾—åˆ°çš„ JSON æ•°æ®æ˜ å°„åˆ°æ•°æ®å±‚ï¼ˆModelï¼‰ã€‚ 12345678910111213struct MenuModel: HandyJSON &#123;var others: [ThemeModel]?&#125;struct ThemeModel: HandyJSON &#123;var color: String?var thumbnail: String?var id: Int?var description: String?var name: String?&#125; ç„¶åŽåˆ›å»ºViewModelç±»,åˆ›å»ºå…·ä½“è¯·æ±‚æ–¹æ³•: 1234567891011121314151617181920class MenuViewModel &#123;private let provider = RxMoyaProvider&lt;APIManager&gt;()var dispose = DisposeBag()func getThemes(completed: @escaping (_ menuModel: MenuModel) -&gt; ())&#123;provider.request(.getThemes).mapModel(MenuModel.self).subscribe(onNext: &#123; (model) incompleted(model)&#125;, onError: &#123; (error) in&#125;, onCompleted: nil, onDisposed: nil).addDisposableTo(dispose)&#125;&#125; è¿™é‡Œè§£é‡Šä¸€ä¸‹:æˆ‘è¿™é‡Œæ˜¯å°†è¯·æ±‚çš„æ•°æ®é€šè¿‡é—­åŒ…ä¼ äº†å‡ºåŽ»,å½“ç„¶ä¹Ÿå¯ä»¥ä¸é‚£ä¹ˆåš.ä¸ªäººå–œå¥½é—®é¢˜.. è¿™é‡Œæ˜¯ä¸º RxSwift ä¸­çš„ ObservableTypeå’Œ Responseå†™ä¸€ä¸ªç®€å•çš„æ‰©å±•æ–¹æ³• mapModelï¼Œåˆ©ç”¨æˆ‘ä»¬å†™å¥½çš„Model ç±»ï¼Œä¸€æ­¥å°±æŠŠJSONæ•°æ®æ˜ å°„æˆ modelã€‚1234567891011121314extension ObservableType where E == Response &#123;public func mapModel&lt;T: HandyJSON&gt;(_ type: T.Type) -&gt; Observable&lt;T&gt; &#123;return flatMap &#123; response -&gt; Observable&lt;T&gt; inreturn Observable.just(response.mapModel(T.self))&#125;&#125;&#125;extension Response &#123;func mapModel&lt;T: HandyJSON&gt;(_ type: T.Type) -&gt; T &#123;let jsonString = String.init(data: data, encoding: .utf8)return JSONDeserializer&lt;T&gt;.deserializeFrom(json: jsonString)!&#125;&#125; 5.é…åˆObjectMapperæ¯•ç«Ÿå°†jsonæ•°æ®è½¬æ¢æˆmodelçš„åº“é‚£ä¹ˆå¤š â€¦.,æ‰€ä»¥â€¦â€¦,ç”¨å“ªä¸ªå¾ˆéšæ„â€¦..è¿™é‡Œå†ä»‹ç»ä¸€ä¸‹ObjectMapper 1.åˆ›å»ºmodelç±» 1234567891011121314151617181920212223242526272829303132333435363738class DetailModel: Mappable &#123;var body = String()var image_source: String?var title = String()var image: String?var share_url = String()var js = String()var recommenders = [[String: String]]()var ga_prefix = String()var section: DetailSectionModel?var type = Int()var id = Int()var css = [String]()func mapping(map: Map) &#123;body &lt;- map[&quot;body&quot;]image_source &lt;- map[&quot;image_source&quot;]title &lt;- map[&quot;title&quot;]image &lt;- map[&quot;image&quot;]share_url &lt;- map[&quot;share_url&quot;]js &lt;- map[&quot;js&quot;]recommenders &lt;- map[&quot;recommenders&quot;]ga_prefix &lt;- map[&quot;ga_prefix&quot;]section &lt;- map[&quot;section&quot;]type &lt;- map[&quot;type&quot;]id &lt;- map[&quot;id&quot;]css &lt;- map[&quot;css&quot;]&#125;required init?(map: Map) &#123;&#125;&#125; ä½¿ç”¨ ObjectMapper ï¼Œéœ€è¦è®©è‡ªå·±çš„ Model ç±»ä½¿ç”¨ Mappable åè®®ï¼Œè¿™ä¸ªåè®®åŒ…æ‹¬ä¸¤ä¸ªæ–¹æ³•ï¼š 123required init?(map: Map) &#123;&#125;func mapping(map: Map) &#123;&#125; åœ¨ mapping æ–¹æ³•ä¸­ï¼Œç”¨ &lt;- æ“ä½œç¬¦æ¥å¤„ç†å’Œæ˜ å°„ä½ çš„ JSONæ•°æ®ã€‚ æ•°æ®ç±»å»ºç«‹å¥½ä¹‹åŽï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¸º RxSwift ä¸­çš„ Observable å†™ä¸€ä¸ªç®€å•çš„æ‰©å±•æ–¹æ³• mapObjectï¼Œåˆ©ç”¨æˆ‘ä»¬å†™å¥½çš„model ç±»ï¼Œä¸€æ­¥å°±æŠŠJSON æ•°æ®æ˜ å°„æˆä¸€ä¸ªä¸ª modelã€‚ 123456789101112131415161718192021222324252627282930313233343536extension Observable &#123;func mapObject&lt;T: Mappable&gt;(type: T.Type) -&gt; Observable&lt;T&gt; &#123;return self.map &#123; response in//if response is a dictionary, then use ObjectMapper to map the dictionary//if not throw an errorguard let dict = response as? [String: Any] else &#123;throw RxSwiftMoyaError.ParseJSONError&#125;return Mapper&lt;T&gt;().map(JSON: dict)!&#125;&#125;func mapArray&lt;T: Mappable&gt;(type: T.Type) -&gt; Observable&lt;[T]&gt; &#123;return self.map &#123; response in//if response is an array of dictionaries, then use ObjectMapper to map the dictionary//if not, throw an errorguard let array = response as? [Any] else &#123;throw RxSwiftMoyaError.ParseJSONError&#125;guard let dicts = array as? [[String: Any]] else &#123;throw RxSwiftMoyaError.ParseJSONError&#125;return Mapper&lt;T&gt;().mapArray(JSONArray: dicts)!&#125;&#125;&#125;enum RxSwiftMoyaError: String &#123;case ParseJSONErrorcase OtherError&#125;extension RxSwiftMoyaError: Swift.Error &#123; &#125; mapObject æ–¹æ³•å¤„ç†å•ä¸ªå¯¹è±¡ï¼ŒmapArray æ–¹æ³•å¤„ç†å¯¹è±¡æ•°ç»„ã€‚ å¦‚æžœä¼ è¿›æ¥çš„æ•°æ® response æ˜¯ä¸€ä¸ª dictionaryï¼Œé‚£ä¹ˆå°±åˆ©ç”¨ ObjectMapper çš„ mapæ–¹æ³•æ˜ å°„è¿™äº›æ•°æ®ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šè°ƒç”¨ä½ ä¹‹å‰åœ¨ mappingæ–¹æ³•é‡Œé¢å®šä¹‰çš„é€»è¾‘ã€‚ å¦‚æžœ response ä¸æ˜¯ä¸€ä¸ª dictionaryï¼Œ é‚£ä¹ˆå°±æŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚ åœ¨åº•éƒ¨è‡ªå®šä¹‰äº†ç®€å•çš„Errorï¼Œç»§æ‰¿äº†Swift çš„ Errorç±»ï¼Œåœ¨å®žé™…åº”ç”¨è¿‡ç¨‹ä¸­å¯ä»¥æ ¹æ®éœ€è¦æä¾›è‡ªå·±æƒ³è¦çš„ Errorã€‚ ç„¶åŽè¿è¡Œè¯·æ±‚æ–¹æ³•: 1234567891011121314class DetailViewModel &#123;private let provider = RxMoyaProvider&lt;APIManager&gt;()func getNewsDetail(id: Int) -&gt; Observable&lt;DetailModel&gt; &#123;return provider.request(.getNewsDetail(id)).filterSuccessfulStatusCodes().mapJSON().mapObject(type: DetailModel.self)&#125;&#125; æœ‰æ²¡æœ‰æ„Ÿè§‰å¾ˆçˆ½å‘¢!â€”â€”â€”â€”æºç åœ°å€,å…±åŒå­¦ä¹ ! æœ‰ä¸å¯¹ä¹‹å¤„,,,,è¿˜æœ›å„è·¯å¤§ç¥žä¸åæŒ‡æ­£!]]></content>
      <categories>
        <category>swiftå­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>moya + RxSwift</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[RxSwiftçš„ç®€å•ä½¿ç”¨]]></title>
    <url>%2F2017%2F03%2F13%2FRxSwift%2F</url>
    <content type="text"><![CDATA[RxSwiftä¸ºReactiveXï¼ˆReactive Extensionsï¼‰æ——ä¸‹çš„Swiftè¯­è¨€åº“ï¼Œæä¾›äº†Swiftå¹³å°ä¸Šè¿›è¡Œå“åº”å¼ç¼–ç¨‹çš„è§£å†³æ–¹æ¡ˆã€‚Rxçš„é‡è¦è§’è‰²ä¸ºObservableï¼ˆè¢«è§‚å¯Ÿè€…ï¼‰å’ŒObserverï¼ˆè§‚å¯Ÿè€…ï¼‰ï¼ŒObservableç±»ä¼¼äºŽReactiveCocoaä¸­çš„Signalï¼Œé‡Œé¢è£…æœ‰äº‹ä»¶æµï¼Œä¾›Observerè®¢é˜…ã€‚äº‹ä»¶æµåœ¨Rxä¸­ä¸ŽReactiveCocoaä¸€æ ·å…·æœ‰ä¸‰ç±»ï¼šNextã€Errorã€Completedï¼Œä»£è¡¨ç€ç»§ç»­äº‹ä»¶ã€é”™è¯¯äº‹ä»¶ã€å®Œæˆäº‹ä»¶ã€‚æˆ‘ä»¬åœ¨ä½¿ç”¨RxSwiftè¿›è¡ŒiOSå¼€å‘æ—¶ï¼Œé€šå¸¸ä¼šå¼•å…¥å¦å¤–ä¸€ä¸ªåº“ï¼šRxCocoaï¼Œè¿™ä¸ªåº“å°†UIKitä»¥åŠFoundationæ¡†æž¶ä¸­è®¸å¤šæˆå‘˜ï¼Œå¦‚è§†å›¾(View)ã€æŽ§åˆ¶äº‹ä»¶(Control Event)ã€é”®å€¼è§‚å¯Ÿï¼ˆKVOï¼‰ã€é€šçŸ¥ï¼ˆNotificationï¼‰ç­‰ç­‰è¿›è¡Œä¸ŽRxSwiftæŽ¥å…¥çš„æ‰©å±•ï¼Œå°†Rxä¸ŽiOS APIæ— ç¼è¿žæŽ¥ã€‚ 1. bindTobindToä¸ºObservableTypeåè®®çš„å‡ ä¸ªé‡è½½æ–¹æ³•ï¼ˆObservableä¹Ÿä¼šå®žçŽ°ObservableTypeåè®®ï¼‰ã€‚é¡¾åæ€ä¹‰ï¼Œå®ƒä¼šå°†æŸä¸ªä¸œä¸œä¸Žä¸€ä¸ªå¯è§‚å¯Ÿè€…è¿›è¡Œç»‘å®šï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå½“è¿™ä¸ªå¯è§‚å¯Ÿè€…çš„äº‹ä»¶æµä¸­æœ‰äº‹ä»¶â€œæµè¿‡â€ï¼ˆæœ‰äº‹ä»¶å…ƒç´ å‘é€ï¼‰ï¼Œè¢«ç»‘å®šçš„è¿™ä¸ªä¸œä¸œå°±ä¼šè¢«åˆºæ¿€åˆ°ï¼Œè¿›è€Œè¿›è¡Œç›¸å…³çš„æ“ä½œã€‚ åœ¨è¿™é‡Œï¼Œæœ‰ä¸€ä¸ªç”¨çš„æ¯”è¾ƒå¤šçš„æ˜¯é‡è½½æ–¹æ³•ä¸ºbindTo&lt;O : ObserverType where O.E == E&gt;(observer: O) -&gt; Disposableï¼Œè¿™ä¸ªæ–¹æ³•æœ‰ä¸€ä¸ªå‚æ•°ï¼Œä»Žæ–¹æ³•æ³›åž‹çš„å£°æ˜Žä¸­å¯ä»¥å¾—çŸ¥ï¼Œå‚æ•°çš„ç±»åž‹ä¸ºä¸€ä¸ªè§‚å¯Ÿè€…ç±»åž‹ï¼Œä¸”è¿™ä¸ªè§‚å¯Ÿè€…èƒ½å¤ŸæŽ¥å—åˆ°çš„äº‹ä»¶æµå…ƒç´ çš„ç±»åž‹è¦è·Ÿè¢«è§‚å¯Ÿè€…çš„ä¸€æ ·(O.E == E)ã€‚è¿™ä¸ªæ–¹æ³•æ„å›¾å°±æ˜¯å°†ä¸€ä¸ªè¢«è§‚å¯Ÿè€…ä¸Žä¸€ä¸ªæŒ‡å®šçš„è§‚å¯Ÿè€…è¿›è¡Œç»‘å®šï¼Œè¢«è§‚å¯Ÿè€…äº‹ä»¶æµä¸­å‘å‡ºçš„æ‰€æœ‰äº‹ä»¶å…ƒç´ éƒ½ä¼šè®©è§‚å¯Ÿè€…æŽ¥æ”¶ã€‚åœ¨MVVMæž¶æž„æ¨¡å¼ä¸­ï¼Œæ­¤æ–¹æ³•ä¸»è¦ç”¨äºŽè§†å›¾ï¼ˆViewï¼‰å±‚è·Ÿè§†å›¾æ¨¡åž‹ï¼ˆViewModelï¼‰å±‚æˆ–è§†å›¾å±‚è·Ÿè§†å›¾å±‚çš„ç»‘å®šï¼Œè¿™é‡Œä¸¾ä¸ªæ —å­ï¼š 123textField.rx_text.bindTo(label.rx_text).addDisposableTo(disposeBag) å…¶ä¸­ï¼ŒUITextFieldçš„rx_textå±žæ€§ä¸ºControlPropertyç±»åž‹ï¼Œå®žçŽ°äº†ControlPropertyTypeï¼Œæ‰€ä»¥ä¸ä»…æ˜¯è§‚å¯Ÿè€…ç±»åž‹ï¼Œè¿˜æ˜¯è¢«è§‚å¯Ÿè€…ç±»åž‹ï¼ŒUILabelä¸­çš„rx_textåªæ˜¯å•çº¯çš„è§‚å¯Ÿè€…ç±»åž‹ã€‚ bindToçš„å¦å¤–ä¸€ä¸ªç”¨å¾—æ¯”è¾ƒå¤šçš„é‡è½½æ–¹æ³•ä¸ºï¼šbindTo(variable: RxSwift.Variable&lt;Self.E&gt;) -&gt; Disposableï¼Œè¿™ä¸ªæ–¹æ³•å°†ä¸€ä¸ªè¢«è§‚å¯Ÿè€…ä¸Žä¸€ä¸ªVariableï¼ˆå˜é‡ï¼‰ç»‘å®šåœ¨ä¸€èµ·ï¼Œè¿™ä¸ªå˜é‡çš„å…ƒç´ ç±»åž‹è·Ÿè¢«è§‚å¯Ÿè€…çš„äº‹ä»¶å…ƒç´ ç±»åž‹ä¸€è‡´ã€‚æ­¤æ–¹æ³•ä½œç”¨å°±æ˜¯æŠŠä»Žè¢«è§‚å¯Ÿè€…äº‹ä»¶æµä¸­å‘å°„å‡ºçš„äº‹ä»¶å…ƒç´ å­˜å…¥å˜é‡ä¸­ï¼Œåœ¨è¿™é‡Œä¸åšæ¼”ç¤ºã€‚å…³äºŽbindToçš„å…¶ä»–é‡è½½æ–¹æ³•åœ¨è¿™é‡Œå°±ä¸å®Œå…¨é˜è¿°äº†ï¼Œå‰©ä¸‹çš„ä¸»è¦æ˜¯ç”¨äºŽå¯¹å‡½æ•°çš„ç»‘å®šã€‚ 2.UIBindingObserverçŽ°åœ¨ä»‹ç»çš„è¿™ä¸ªä¸œä¸œå°±è·Ÿä¸Šé¢è¯´çš„è¢«è§‚å¯Ÿè€…ç±»åž‹çš„bindToæ–¹æ³•å¯†åˆ‡ç›¸å…³äº†ã€‚UIBindingObserverï¼Œåå­—å°±å‘Šè¯‰äº†æˆ‘ä»¬å®ƒæ˜¯ä¸€ä¸ªè§‚å¯Ÿè€…ï¼Œç”¨äºŽå¯¹UIçš„ç»‘å®šï¼Œæˆ‘è¿™é‡Œé€šè¿‡ä¸€ä¸ªä¾‹å­æ¥è®²è§£å®ƒï¼š 1234567891011121314// MARK: - ç»‘å®šæ–¹æ³•func binding() &#123;textField.rx_text.bindTo(label.rx_sayHelloObserver).addDisposableTo(disposeBag)&#125;// MARK: - è§†å›¾æŽ§ä»¶æ‰©å±•private extension UILabel &#123;var rx_sayHelloObserver: AnyObserver&lt;String&gt; &#123;return UIBindingObserver(UIElement: self, binding: &#123; (label, string) inlabel.text = &quot;Hello \(string)&quot;&#125;).asObserver()&#125;&#125; ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘åœ¨è§†å›¾æŽ§åˆ¶å™¨ViewControlleræ‰€åœ¨çš„Swiftæ–‡ä»¶ä¸­åˆ›å»ºäº†ä¸€ä¸ªç§æœ‰çš„UILabelæ‰©å±•ï¼Œå¹¶åœ¨æ‰©å±•ä¸­å®šä¹‰äº†ä¸€ä¸ªåªè¯»è®¡ç®—å±žæ€§ï¼Œå±žæ€§çš„ç±»åž‹ä¸ºAnyObserver&lt;String&gt;ï¼Œä¸ºä¸€ä¸ªäº‹ä»¶å…ƒç´ æ˜¯Stringçš„è§‚å¯Ÿè€…ç±»åž‹ã€‚å½“èŽ·å–è¿™ä¸ªå±žæ€§å€¼çš„æ—¶å€™ï¼Œå°±è¿”å›žäº†ä¸Žç‰¹å®šUIBindingObserverå…³è”çš„è§‚å¯Ÿè€…ã€‚çŽ°åœ¨æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹UIBindingObserverçš„æž„é€ æ–¹æ³•ï¼š 1init(UIElement: UIElementType, binding: (UIElementType, Value) -&gt; Void) æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°å°±æ˜¯ä¼ å…¥ä¸€ä¸ªè¦è¢«ç»‘å®šçš„è§†å›¾çš„å®žä¾‹ï¼Œç”±äºŽçŽ°åœ¨æ˜¯åœ¨UILabelçš„æ‰©å±•ä¸­ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä¼ å…¥äº†selfï¼Œä»£è¡¨UILabelè‡ªå·±ï¼›æž„é€ æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°ä¸ºä¸€ä¸ªæ— è¿”å›žå€¼çš„é—­åŒ…ç±»åž‹ï¼Œé—­åŒ…çš„å‚æ•°å…¶ä¸€å°±æ˜¯è¢«ç»‘å®šäº†çš„è§†å›¾ï¼Œå…¶äºŒå°±æ˜¯ç”±ç»‘å®šçš„è¢«è§‚å¯Ÿè€…ä¸­æ‰€å‘å°„å‡ºæ¥çš„äº‹ä»¶å…ƒç´ ã€‚é€šè¿‡è¿™ä¸ªé—­åŒ…ï¼Œæˆ‘ä»¬èƒ½å¤Ÿå°†è§†å›¾ä¸­çš„æŸäº›å±žæ€§æ ¹æ®ç›¸åº”çš„äº‹ä»¶å…ƒç´ è€Œè¿›è¡Œæ”¹å˜ï¼Œå¦‚ä¾‹å­ä¸­label.text = &quot;Hello \(string)&quot;ã€‚å½“æˆ‘ä»¬æ‰§è¡Œä¾‹å­ä¸­çš„bindingå‡½æ•°è¿›è¡Œç»‘å®šåŽï¼ŒTextFieldä¸­çš„å­—ç¬¦ä¸²æ¯ç»è¿‡ä¿®æ”¹ï¼ŒLabelä¸­çš„æ–‡å­—æ€»ä¼šå®žæ—¶æ›´æ–°ï¼Œå¹¶åœ¨å­—ç¬¦ä¸²å‰é¢åŠ ä¸ŠHelloã€‚ åœ¨RxCocoaæ¡†æž¶ä¸­ï¼ŒæŸäº›åœ°æ–¹ä¹Ÿç”¨åˆ°äº†UIBindingObserverï¼Œå¦‚UILableä¸­çš„rx_textï¼š 12345public var rx_text: AnyObserver&lt;String&gt; &#123;return UIBindingObserver(UIElement: self) &#123; label, text inlabel.text = text&#125;.asObserver()&#125; 3.DriverDriverä»Žåå­—ä¸Šå¯ä»¥ç†è§£ä¸ºé©±åŠ¨ï¼ˆæˆ‘è‡ªå·±ä¼šäº²åˆ‡åœ°æŠŠå®ƒå«åšâ€è€å¸æœºâ€ï¼‰ï¼Œåœ¨åŠŸèƒ½ä¸Šå®ƒç±»ä¼¼è¢«è§‚å¯Ÿè€…ï¼ˆObservableï¼‰ï¼Œè€Œå®ƒæœ¬èº«ä¹Ÿå¯ä»¥ä¸Žè¢«è§‚å¯Ÿè€…ç›¸äº’è½¬æ¢ï¼ˆObservable: asDriver, Driver: asObservableï¼‰ï¼Œå®ƒé©±åŠ¨ç€ä¸€ä¸ªè§‚å¯Ÿè€…ï¼Œå½“å®ƒçš„äº‹ä»¶æµä¸­æœ‰äº‹ä»¶æ¶Œå‡ºæ—¶ï¼Œè¢«å®ƒé©±åŠ¨ç€çš„è§‚å¯Ÿè€…å°±èƒ½è¿›è¡Œç›¸åº”çš„æ“ä½œã€‚ä¸€èˆ¬æˆ‘ä»¬ä¼šå°†ä¸€ä¸ªObservableè¢«è§‚å¯Ÿè€…è½¬æ¢æˆDriveråŽå†è¿›è¡Œé©±åŠ¨æ“ä½œï¼š æˆ‘ä»¬æ²¿ç”¨ä¸Šé¢ä¾‹å­ä¸­çš„UILabelç§æœ‰æ‰©å±•ï¼Œå¹¶ä¿®æ”¹ä¸‹bindingæ–¹æ³•ï¼š 123456func binding() &#123;textField.rx_text.asDriver().drive(label.rx_sayHelloObserver).addDisposableTo(disposeBag)&#125; å¯è§ï¼ŒDriverçš„driveæ–¹æ³•ä¸ŽObservableçš„æ–¹æ³•bindToç”¨æ³•éžå¸¸ç›¸ä¼¼ï¼Œäº‹å®žä¸Šï¼Œå®ƒä»¬çš„ä½œç”¨ä¹Ÿæ˜¯ä¸€æ ·ï¼Œè¯´ç™½äº†å°±æ˜¯è¢«è§‚å¯Ÿè€…ä¸Žè§‚å¯Ÿè€…çš„ç»‘å®šã€‚é‚£ä¸ºä»€ä¹ˆRxSwiftçš„ä½œè€…åˆæžå‡ºDriverè¿™ä¹ˆä¸ªä¸œè¥¿æ¥å‘¢ï¼Ÿå…¶å®žï¼Œæ¯”è¾ƒä¸ŽObservableï¼ŒDriveræœ‰ä»¥ä¸‹çš„ç‰¹æ€§ï¼š å®ƒä¸ä¼šå‘å°„å‡ºé”™è¯¯(Error)äº‹ä»¶ å¯¹å®ƒçš„è§‚å¯Ÿè®¢é˜…æ˜¯å‘ç”Ÿåœ¨ä¸»çº¿ç¨‹(UIçº¿ç¨‹)çš„ è‡ªå¸¦shareReplayLatestWhileConnected ä¸‹é¢å°±å›´ç»•ç€è¿™ä¸‰ä¸ªç‰¹æ€§ä¸€ä¸€ç ”ç©¶ä¸‹ï¼š å½“ä½ å°†ä¸€ä¸ªObservableè½¬æ¢æˆDriveræ—¶ï¼Œç”¨åˆ°çš„asDriveræ–¹æ³•æœ‰ä¸‹é¢å‡ ä¸ªé‡è½½ï¼š 12345asDriver(onErrorJustReturn onErrorJustReturn: Self.E)asDriver(onErrorDriveWith onErrorDriveWith: RxCocoa.Driver&lt;Self.E&gt;)asDriver(onErrorRecover onErrorRecover: (error: ErrorType) -&gt; RxCocoa.Driver&lt;Self.E&gt;) ä»Žè¿™ä¸‰ä¸ªé‡è½½æ–¹æ³•ä¸­å¯çœ‹å‡ºï¼Œå½“æˆ‘ä»¬è¦å°†æœ‰å¯èƒ½ä¼šå‘å‡ºé”™è¯¯äº‹ä»¶çš„Observableè½¬æ¢æˆDriveræ—¶ï¼Œå¿…é¡»è¦å…ˆå°†æ‰€æœ‰å¯èƒ½å‘å‡ºçš„é”™è¯¯äº‹ä»¶æ»¤é™¤æŽ‰ï¼Œä»Žè€Œä½¿å¾—Driverä¸å¯èƒ½ä¼šå‘å°„å‡ºé”™è¯¯çš„äº‹ä»¶ã€‚ åœ¨Observableä¸­å‡å¦‚ä½ è¦è¿›è¡Œé™æµï¼Œä½ è¦ç”¨åˆ°æ–¹æ³•throttle(dueTime: RxSwift.RxTimeInterval, scheduler: SchedulerType)ï¼Œæ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸¤ä¸ªäº‹ä»¶ä¹‹é—´çš„é—´éš”æ—¶é—´ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªçº¿ç¨‹çš„æœ‰å…³ç±»ï¼Œå¦‚æˆ‘è¦åœ¨ä¸»çº¿ç¨‹ä¸­ï¼Œæˆ‘å¯ä»¥ä¼ å…¥MainScheduler.instanceã€‚è€Œåœ¨Driverä¸­æˆ‘ä»¬è¦é™æµï¼Œè°ƒç”¨çš„æ˜¯throttle(dueTime: RxSwift.RxTimeInterval)ï¼Œåªé…ç½®äº‹ä»¶çš„é—´éš”æ—¶é—´ï¼Œè€Œå®ƒé»˜è®¤ä¼šåœ¨ä¸»çº¿ç¨‹ä¸­è¿›è¡Œã€‚ ä¸€èˆ¬æˆ‘ä»¬åœ¨å¯¹Observableè¿›è¡Œmapæ“ä½œåŽï¼Œæˆ‘ä»¬ä¼šåœ¨åŽé¢åŠ ä¸ŠshareReplay(1)æˆ–shareReplayLatestWhileConnectedï¼Œä»¥é˜²æ­¢ä»¥åŽè¢«è§‚å¯Ÿè€…è¢«å¤šæ¬¡è®¢é˜…è§‚å¯ŸåŽï¼Œmapä¸­çš„è¯­å¥ä¼šå¤šæ¬¡è°ƒç”¨ï¼š 123456789let rx_textChange = textField.rx_text.map &#123; return &quot;Good \($0)&quot; &#125;.shareReplay(1)rx_textChange.subscribeNext &#123; print(&quot;1 -- \($0)&quot;) &#125;.addDisposableTo(disposeBag)rx_textChange.subscribeNext &#123; print(&quot;2 -- \($0)&quot;) &#125;.addDisposableTo(disposeBag) åœ¨Driverä¸­ï¼Œæ¡†æž¶å·²ç»é»˜è®¤å¸®æˆ‘ä»¬åŠ ä¸Šäº†shareReplayLatestWhileConnectedï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿæ²¡å¿…è¦å†åŠ ä¸Š&quot;replay&quot;ç›¸å…³çš„è¯­å¥äº†ã€‚ ä»Žè¿™äº›ç‰¹æ€§å¯ä»¥çœ‹å‡ºï¼ŒDriveræ˜¯ä¸€ä¸ªä¸“é—¨é’ˆå¯¹äºŽUIçš„ç‰¹å®šå¯è§‚å¯Ÿè€…ç±»ã€‚å¹¶ä¸æ˜¯è¯´å¯¹UIè¿›è¡Œç›¸åº”ç»‘å®šæ“ä½œä¸èƒ½ä½¿ç”¨çº¯ç²¹çš„Observableï¼Œä½†æ˜¯ï¼ŒDriverå·²ç»å¸®æˆ‘ä»¬çœåŽ»äº†å¥½å¤šçš„æ“ä½œï¼Œè®©æˆ‘ä»¬å¯¹UIçš„ç»‘å®šæ›´åŠ çš„é«˜æ•ˆä¾¿æ·ã€‚æ‰€ä»¥ï¼Œå¯¹UIè§†å›¾çš„ç»‘å®šæ“ä½œï¼Œæˆ‘ä»¬é¦–é€‰â€œè€å¸æœºâ€Driverã€‚ 4.DisposeBagå½“ä¸€ä¸ªObservableï¼ˆè¢«è§‚å¯Ÿè€…ï¼‰è¢«è§‚å¯Ÿè®¢é˜…åŽï¼Œå°±ä¼šäº§ç”Ÿä¸€ä¸ªDisposableå®žä¾‹ï¼Œé€šè¿‡è¿™ä¸ªå®žä¾‹ï¼Œæˆ‘ä»¬å°±èƒ½è¿›è¡Œèµ„æºçš„é‡Šæ”¾äº†ã€‚å¯¹äºŽRxSwiftä¸­èµ„æºçš„é‡Šæ”¾ï¼Œä¹Ÿå°±æ˜¯è§£é™¤ç»‘å®šã€é‡Šæ”¾ç©ºé—´ï¼Œæœ‰ä¸¤ç§æ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯æ˜¾å¼é‡Šæ”¾ä»¥åŠéšå¼é‡Šæ”¾ï¼š æ˜¾å¼é‡Šæ”¾ å¯ä»¥è®©æˆ‘ä»¬åœ¨ä»£ç ä¸­ç›´æŽ¥è°ƒç”¨é‡Šæ”¾æ–¹æ³•è¿›è¡Œèµ„æºçš„é‡Šæ”¾ï¼Œå¦‚ä¸‹é¢çš„å®žä¾‹ï¼š 123let dispose = textField.rx_text.bindTo(label.rx_sayHelloObserver)dispose.dispose() è¿™ä¸ªä¾‹å­åªæ˜¯ä¸ºäº†æ›´æ˜Žæœ—åœ°è¯´æ˜Žæ˜¾å¼é‡Šæ”¾æ–¹æ³•è€Œå·²ï¼Œå®žé™…ä¸Šå¹¶ä¸ä¼šè¿™æ ·å†™ã€‚ éšå¼é‡Šæ”¾ åˆ™é€šè¿‡DisposeBagæ¥è¿›è¡Œï¼Œå®ƒç±»ä¼¼äºŽObjective-C ARCä¸­çš„è‡ªåŠ¨é‡Šæ”¾æ± æœºåˆ¶ï¼Œå½“æˆ‘ä»¬åˆ›å»ºäº†æŸä¸ªå®žä¾‹åŽï¼Œä¼šè¢«æ·»åŠ åˆ°æ‰€åœ¨çº¿ç¨‹çš„è‡ªåŠ¨é‡Šæ”¾æ± ä¸­ï¼Œè€Œè‡ªåŠ¨é‡Šæ”¾æ± ä¼šåœ¨ä¸€ä¸ªRunLoopå‘¨æœŸåŽè¿›è¡Œæ± å­çš„é‡Šæ”¾ä¸Žé‡å»ºï¼›DisposeBagå¯¹äºŽRxSwiftå°±åƒè‡ªåŠ¨é‡Šæ”¾æ± ä¸€æ ·ï¼Œæˆ‘ä»¬æŠŠèµ„æºæ·»åŠ åˆ°DisposeBagä¸­ï¼Œè®©èµ„æºéšç€DisposeBagä¸€èµ·é‡Šæ”¾ã€‚å¦‚ä¸‹å®žä¾‹ï¼š 123456let disposeBag = DisposeBag()func binding() &#123;textField.rx_text.bindTo(label.rx_sayHelloObserver).addDisposableTo(self.disposeBag)&#125; æ–¹æ³•addDisposableToä¼šå¯¹DisposeBagè¿›è¡Œå¼±å¼•ç”¨ï¼Œæ‰€ä»¥è¿™ä¸ªDisposeBagè¦è¢«å®žä¾‹å¼•ç”¨ç€ï¼Œä¸€èˆ¬å¯ä½œä¸ºå®žä¾‹çš„æˆå‘˜å˜é‡ï¼Œå½“å®žä¾‹è¢«é”€æ¯äº†ï¼Œæˆå‘˜DisposeBagä¼šè·Ÿç€é”€æ¯ï¼Œä»Žè€Œä½¿å¾—RxSwiftåœ¨æ­¤å®žä¾‹ä¸Šç»‘å®šçš„èµ„æºå¾—åˆ°é‡Šæ”¾ã€‚ å¯¹äºŽUITableViewCellè·ŸUICollectionViewCellæ¥è¯´ï¼ŒDisposeBagä¹Ÿèƒ½è®©cellåœ¨é‡ç”¨å‰é‡Šæ”¾æŽ‰ä¹‹å‰è¢«ç»‘å®šçš„èµ„æºï¼š 1234567891011121314151617class TanTableViewCell: UITableViewCell &#123;var disposeBag: DisposeBag?var viewModel: TanCellViewModel? &#123;didSet &#123;let disposeBag = DisposeBag()viewModel?.title.drive(self.textLabel!.rx_text).addDisposableTo(disposeBag)self.disposeBag = disposeBag&#125;&#125;override func prepareForReuse() &#123;super.prepareForReuse()self.disposeBag = nil&#125;&#125; 5.DataSourceè¿™é‡Œä¸»è¦è®²è§£çš„æ˜¯RxCocoaæ¡†æž¶ä¸­å¸¦æœ‰çš„å¯¹äºŽUITableViewä»¥åŠUICollectionViewæ•°æ®æºçš„è§£å†³æ–¹æ¡ˆï¼Œåœ¨GitHubä¸­ä¹Ÿæœ‰ä¸€ä¸ªå¼€æºå°åº“RxDataSourceï¼Œåœ¨è¿™é‡Œæˆ‘å°±ä¸å†ç ”ç©¶äº†ï¼Œæœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥åŽ»çœ‹çœ‹ï¼šGitHub RxDataSourceã€‚æˆ‘è¿™é‡Œç”¨ä¸€ä¸ªä¾‹å­æ¥å±•ç¤ºä¸‹RxCocoaä¸­çš„ç®€å•UITableViewæ•°æ®æºï¼š 12345678910111213141516171819202122232425262728293031class TanViewController: UIViewController &#123;var disposeBag = DisposeBag()let data = [TanCellViewModel(title: &quot;One&quot;), TanCellViewModel(title: &quot;Two&quot;), TanCellViewModel(title: &quot;Three&quot;)]override func viewDidLoad() &#123;super.viewDidLoad()self.view.addSubview(self.tableView)self.tableView.frame = self.view.boundsself.binging()&#125;private func binging() &#123;Observable.just(self.data).asDriver(onErrorJustReturn: []).drive(self.tableView.rx_itemsWithCellIdentifier(TanTableViewCell.CELL_IDENTIFIER, cellType: TanTableViewCell.self)) &#123; (_, viewModel, cell) incell.viewModel = viewModel&#125;.addDisposableTo(self.disposeBag)&#125;// MARK: - Lazyprivate var tableView: UITableView = &#123;let tableView = UITableView(frame: CGRectZero, style: .Plain)tableView.registerClass(TanTableViewCell.self, forCellReuseIdentifier: TanTableViewCell.CELL_IDENTIFIER)return tableView&#125;()&#125; å¦‚ä¸Šï¼Œæˆ‘ä»¬èƒ½å¤Ÿå°†æ•°æ®å°è£…åœ¨Observableä¸­ï¼Œç„¶åŽæŠŠObservableç»‘å®šåˆ°UITableViewä¸­ï¼Œé€šè¿‡UITableViewçš„æ–¹æ³•rx_itemsWithCellIdentifierï¼Œæˆ‘ä»¬å°±èƒ½å¤Ÿè¿›è¡Œæ•°æ®è·ŸCellçš„ä¸€ä¸€å¯¹åº”é…ç½®ã€‚åˆ°æ­¤ï¼ŒUITableViewçš„æ•°æ®æºå°±è®¾ç½®å¥½äº†ã€‚UICollectionViewçš„æ•°æ®æºè®¾ç½®è·ŸUITableViewå·®ä¸å¤šï¼Œåœ¨è¿™é‡Œå°±ä¸å†ä½œä¾‹å­äº†ã€‚ 6.é¡¹ç›®å®žæˆ˜ä¸‹é¢å°±æ˜¯é‡å¤´æˆäº†ï¼Œæˆ‘å°†é€šè¿‡æŠ˜è…¾å‡ºä¸€ä¸ªå°é¡¹ç›®æ¥æ¼”ç¤ºRxSwiftçš„ä½¿ç”¨ï¼ŒåŒ…æ‹¬åŸºç¡€ä»¥åŠè¿›é˜¶çš„å†…å®¹ï¼Œé¦–å…ˆæ¥è®¾å®šä¸‹è¿™ä¸ªé¡¹ç›®ï¼šè¯´ç®€å•ç‚¹ï¼Œå°±æ˜¯åšä¸€ä¸ªç™»å½•ç•Œé¢ï¼ˆä¸‡èƒ½Demoï¼‰ï¼Œè¾“å…¥ç”¨æˆ·å·ç è·Ÿå¯†ç ï¼Œç‚¹å‡»ç™»å½•æŒ‰é’®ï¼Œå³å¯ç™»å½•èŽ·å–æ•°æ®ã€‚è¯´å¤æ‚ç‚¹ï¼Œæˆ‘ä»¬è¦å®Œæˆä¸‹é¢çš„è¦æ±‚ï¼š ç”¨æˆ·å·ç è¾“å…¥æ¡†è¦åˆ¤æ–­ç”¨æˆ·è¾“å…¥çš„æ˜¯å¦å…¨æ˜¯æ•°å­—ï¼Œè‹¥æ ¼å¼ä¸æ­£ç¡®ï¼Œæç¤ºç”¨æˆ·æ ¼å¼é”™è¯¯ã€‚ å·ç è¾“å…¥æ¡†è¾“å…¥çš„æ•°å­—æœ€å°‘è¦æœ‰11ä½ï¼Œå¯†ç è¾“å…¥æ¡†è¾“å…¥çš„å­—ç¬¦ä¸²é•¿åº¦æœ€å°‘è¦æœ‰6ä½ã€‚ è¦æ»¡è¶³ä¸Šé¢çš„ä¸¤æ¡è¦æ±‚ï¼Œç™»å½•æŒ‰é’®æ‰å¯ä»¥ç‚¹å‡»ã€‚ ç™»å½•æŒ‰é’®ç‚¹å‡»åŽè¿›è¡Œç™»å½•ï¼Œç•Œé¢æ˜¾ç¤ºæ­£åœ¨è½¬åŠ¨çš„ç­‰å¾…è§†å›¾ï¼Œå½“æŽ¥æ”¶åˆ°åŽå°æ•°æ®æ—¶ï¼Œç­‰å¾…è§†å›¾æ¶ˆå¤±ã€‚ è§£æžåŽå°è¿”å›žçš„æ•°æ®ï¼Œå¹¶æŠŠæ•°æ®å‘ˆçŽ°åˆ°ç•Œé¢ä¸­ã€‚ åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘è¿˜æ˜¯ä½¿ç”¨ç†Ÿæ‚‰çš„MVVMæž¶æž„æ¨¡å¼ã€‚åœ¨å¼€å¹²ä¹‹å‰æˆ‘é¦–å…ˆè¦è¯´å‡ ç‚¹ï¼š RxSwiftä¸­çš„ViewModelæ˜¯æ²¡æœ‰ä»€ä¹ˆæ˜Žç¡®çš„çŠ¶æ€çš„ï¼Œå®ƒçš„è¾“å‡ºç”±è¾“å…¥å†³å®šï¼Œå¯ä»¥è¿™ä¹ˆè¯´ï¼Œæˆ‘ä»¬è¦ä½¿ç”¨RxSwiftå°†ViewModelä¸­çš„å¤–ç•Œè¾“å…¥ï¼ˆUIè§¦å‘ã€å¤–ç•Œäº‹ä»¶ï¼‰è½¬æ¢æˆè¾“å‡ºï¼Œå†ç”±è¿™äº›è¾“å‡ºåŽ»é©±åŠ¨UIç•Œé¢ï¼Œå¹¶ä¸”ï¼ŒViewModelåšçš„æ˜¯è½¬æ¢ï¼Œæˆ‘ä»¬ä¸èƒ½å¤Ÿåœ¨å…¶ä¸­å¯¹æŸä¸ªObservableè¿›è¡Œè®¢é˜…æ“ä½œï¼Œæ‰€ä»¥ï¼Œåœ¨ViewModelä¸­æˆ‘ä»¬æ˜¯çœ‹ä¸åˆ°addDisposableToçš„ã€‚ æˆ‘å¯¹æ¯”äº†ä¸€ä¸‹ç”±ReactiveCocoaä¸ŽRxSwiftå®žçŽ°çš„ViewModelï¼Œå‘çŽ°ä½¿ç”¨ReactiveCocoaå®žçŽ°çš„ViewModelä¸­ä¼šæœ‰æ¯”è¾ƒå¤šçš„æ˜Žç¡®çŠ¶æ€å˜é‡ï¼Œæ¯”å¦‚è¯´çŽ°åœ¨å®žçŽ°çš„æ˜¯ç™»å½•çš„ç•Œé¢ï¼Œåœ¨ReactiveCocoaçš„ViewModelä¸­æˆ‘ä»¬ä¼šçœ‹åˆ°æœ‰&quot;userName&quot;ã€&quot;passWordâ€œç­‰ç­‰ä¹‹ç±»çš„çŠ¶æ€å˜é‡ï¼Œå®ƒæ˜¯ç”±ReactiveCocoaå°†å…¶ä¸ŽUIè§†å›¾å±žæ€§ç›¸ç»‘å®šçš„ï¼šRAC(self.viewModel, userName) = userNameTextField.rac_textSignal;ï¼Œè€Œåœ¨RxSwiftå®žçŽ°çš„ViewModelï¼Œå°±ä¸ä¼šçœ‹åˆ°è¿™äº›çŠ¶æ€å˜é‡äº†ï¼Œæœ‰çš„æ˜¯é©±åŠ¨å¤–ç•ŒUIçš„è¾“å‡ºDriverï¼Œä¸ªäººè®¤ä¸ºRxSwiftå®žçŽ°ViewModelçš„å®—æ—¨æ˜¯å°†å¤–ç•Œè§†å›¾çš„è¾“å…¥ç»è¿‡è½¬å˜äº§ç”Ÿè¾“å‡ºï¼Œåœ¨è®©è¾“å‡ºåŽ»é©±åŠ¨å›žUIè§†å›¾ï¼Œæ‰€ä»¥æˆ‘åœ¨æž„å»ºViewModelç±»çš„æ—¶å€™ï¼Œä¼šåœ¨å®ƒçš„æž„é€ æ–¹æ³•ä¸­å¼€è®¾ä¸€ä¸ªæŽ¥æ”¶è¾“å…¥çš„å‚æ•°ï¼Œå…¶æ¬¡å°±åœ¨åŽé¢çš„æŽ§åˆ¶å™¨ç»‘å®šä¸­å°†ViewModelçš„è¾“å‡ºè¿›è¡Œè®¢é˜…ï¼Œé©±åŠ¨è§†å›¾å±‚ã€‚ è¿™ä¸ªé¡¹ç›®æˆ‘ä½¿ç”¨çš„ç¬¬ä¸‰æ–¹åº“æœ‰RxSwiftã€RxCocoaã€Moyaã€Argoã€Curryï¼Œå‰é¢ä¸¤ä¸ªåœ¨ä¸Šé¢æœ‰è¯´åˆ°ï¼›Moyaæ˜¯ä¸€æ¬¾Swiftè¯­è¨€çš„ç½‘ç»œè¯·æ±‚æ¡†æž¶ï¼Œå®ƒæ˜¯å¦ä¸€æ¬¾ç½‘ç»œè¯·æ±‚æ¡†æž¶Alamofireçš„å†åº¦å°è£…ï¼Œå®ƒæœ‰åŸºäºŽRxSwiftçš„æ‰©å±•ï¼Œèƒ½ä¸ŽRxSwiftæ— ç¼å¯¹æŽ¥ï¼›Argoæ˜¯ä¸€æ¬¾å°å·§çš„JSONè§£æžåº“ï¼Œå‡½æ•°æŸ¯é‡ŒåŒ–(Currying)åº“Curryé…åˆç€å®ƒä¸€èµ·ä½¿ç”¨ï¼Œè€Œä¸”ï¼ŒArgoçš„è§£æžè¯­æ³•éžå¸¸æ–°é¢–å¥‡ç‰¹ï¼Œç”¨ç€æ„Ÿè§‰éžå¸¸è¿‡ç˜¾ï¼ .ç•Œé¢åœ¨Storyboardä¸­å¸ƒå±€å¥½ç™»å½•ç•Œé¢ï¼Œåˆ†åˆ«æœ‰ç”¨æˆ·ç”µè¯å·ç çš„è¾“å…¥æ¡†ã€ç”¨æˆ·å¯†ç è¾“å…¥æ¡†ã€ç­‰å¾…è§†å›¾ï¼ˆèŠèŠ±ï¼‰ã€æç¤ºè§†å›¾ï¼ˆç”¨äºŽæé†’è¾“å…¥çš„é”™è¯¯ï¼Œä»¥åŠç™»å½•çš„çŠ¶æ€ï¼‰ã€ç™»å½•æŒ‰é’®ï¼š .Entity å®žä½“ä¸‹é¢è¿›è¡Œå®žä½“ç±»(Entity)çš„æž„å»ºï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103import UIKitimport RxSwiftimport RxCocoaimport Argoimport Moyaimport Curry// MARK: - Userstruct User &#123;let name: Stringlet userToken: String&#125;extension User: Decodable &#123;static func decode(json: JSON) -&gt; Decoded&lt;User&gt; &#123;return curry(self.init)&lt;^&gt; json &lt;| &quot;name&quot;&lt;*&gt; json &lt;| &quot;user_token&quot;&#125;&#125;// MARK: - ResponseResultenum ResponseResult &#123;case succeed(user: User)case faild(message: String)var user: User? &#123;switch self &#123;case let .succeed(user):return usercase .faild:return nil&#125;&#125;&#125;extension ResponseResult: Decodable &#123;init(statusCode: Int, message: String, user: User?) &#123;if statusCode == 200 &amp;&amp; user != nil &#123;self = .succeed(user: user!)&#125;else&#123;self = .faild(message: message)&#125;&#125;static func decode(json: JSON) -&gt; Decoded&lt;ResponseResult&gt; &#123;return curry(self.init)&lt;^&gt; json &lt;| &quot;status_code&quot;&lt;*&gt; json &lt;| &quot;message&quot;&lt;*&gt; json &lt;|? &quot;user&quot;&#125;&#125;// MARK: - ValidateResultenum ValidateResult &#123;case succeedcase faild(message: String)case empty&#125;infix operator ^-^ &#123;&#125;func ^-^ (lhs: ValidateResult, rhs: ValidateResult) -&gt; Bool &#123;switch (lhs, rhs) &#123;case (.succeed, .succeed):return truedefault:return false&#125;&#125;// MARK: - RequestTargetenum RequestTarget &#123;case login(telNum: String, password: String)&#125;extension RequestTarget: TargetType &#123;var baseURL: NSURL &#123;return NSURL(string: &quot;&quot;)!&#125;var path: String &#123;return &quot;/login&quot;&#125;var method: Moya.Method &#123;return .POST&#125;var parameters: [String: AnyObject]? &#123;switch self &#123;case let .login(telNum, password):return [&quot;tel_num&quot;: telNum, &quot;password&quot;: password]default:()&#125;&#125;var sampleData: NSData &#123;let jsonString = &quot;&#123;\&quot;status_code\&quot;:200, \&quot;message\&quot;:\&quot;ç™»å½•æˆåŠŸ\&quot;, \&quot;user\&quot;:&#123;\&quot;name\&quot;:\&quot;Tangent\&quot;,\&quot;user_token\&quot;:\&quot;abcdefg123456\&quot;&#125;&#125;&quot;return jsonString.dataUsingEncoding(NSUTF8StringEncoding)!&#125;&#125; User ç”¨æˆ·ç±»ï¼Œç™»å½•æˆåŠŸåŽï¼ŒåŽå°ä¼šè¿”å›žç”¨æˆ·çš„ä¸ªäººä¿¡æ¯ï¼ŒåŒ…æ‹¬ç”¨æˆ·åç§°ä»¥åŠç”¨æˆ·çš„ç™»å½•ä»¤ç‰Œã€‚ ResponseResultç½‘ç»œè¯·æ±‚è¿”å›žç±»ï¼Œæžšä¸¾ç±»åž‹ï¼ŒæˆåŠŸçš„è¯å®ƒçš„å…³è”å€¼æ˜¯ä¸€ä¸ªç”¨æˆ·ç±»åž‹ï¼Œå¤±è´¥çš„è¯å®ƒå°±ä¼šæœ‰ä¿¡æ¯å­—ç¬¦ä¸²å…³è”ã€‚å®ƒçš„æž„é€ ä¸­é çš„æ˜¯çŠ¶æ€ç æ¥å®Œæˆï¼Œè‹¥åŽå°è¿”å›žçš„çŠ¶æ€ç ä¸º200ï¼Œè¡¨ç¤ºç™»å½•æˆåŠŸï¼Œè¿”å›žç”¨æˆ·ï¼Œè‹¥ä¸ºå…¶ä»–ï¼Œè¡¨æ˜Žç™»å½•å¤±è´¥ï¼Œå¹¶è¿”å›žé”™è¯¯ä¿¡æ¯ã€‚è¿™é‡Œçš„decodeæ–¹æ³•ä¸ºArgoè§£æžæ‰€éœ€å®žçŽ°çš„ã€‚ ValidateResult éªŒè¯ç±»ï¼Œå¦‚éªŒè¯ç”µè¯å·ç æ˜¯å¦æ ¼å¼æ­£ç¡®ï¼Œå·ç æˆ–å¯†ç çš„é•¿åº¦æ˜¯å¦è¾¾åˆ°è¦æ±‚ç­‰ç­‰ï¼Œå¤±è´¥çš„æ—¶å€™ä¼šæœ‰é”™è¯¯ä¿¡æ¯ç›¸å…³è”ã€‚ RequestTarget è¯·æ±‚ç›®æ ‡ï¼Œä¸ºMoyaæ¡†æž¶å®šåˆ¶çš„ç½‘ç»œè¯·æ±‚ç±»ã€‚ .ViewModelServer æœåŠ¡1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950import UIKitimport RxCocoaimport RxSwiftimport Moyaimport Argo// MARK: - ValidateServerclass ValidateServer &#123;static let instance = ValidateServer()class func shareInstance() -&gt; ValidateServer &#123;return self.instance&#125;let minTelNumCount = 11let minPasswordCount = 6func validateTelNum(telNum: String) -&gt; ValidateResult &#123;guard let _ = Int(telNum) else &#123; return .faild(message: &quot;å·ç æ ¼å¼é”™è¯¯&quot;) &#125;return telNum.characters.count &gt;= self.minTelNumCount ? .succeed : .faild(message: &quot;å·ç é•¿åº¦ä¸è¶³&quot;)&#125;func validatePassword(password: String) -&gt; ValidateResult &#123;return password.characters.count &gt;= self.minPasswordCount ? .succeed : .faild(message: &quot;å¯†ç é•¿åº¦ä¸è¶³&quot;)&#125;&#125;// MARK: - NetworkServerclass NetworkServer &#123;static let instance = NetworkServer()class func shareInstace() -&gt; NetworkServer &#123;return self.instance&#125;// Lazyprivate lazy var provider: RxMoyaProvider = &#123;return RxMoyaProvider&lt;RequestTarget&gt;(stubClosure: MoyaProvider.ImmediatelyStub)&#125;()func loginWork(telNum: String, password: String) -&gt; Driver&lt;ResponseResult&gt; &#123;return self.provider.request(.login(telNum: telNum, password: password)).mapJSON().map &#123; jsonObject -&gt; ResponseResult inlet decodeResult: Decoded&lt;ResponseResult&gt; = decode(jsonObject)return try decodeResult.dematerialize()&#125;.asDriver(onErrorJustReturn: .faild(message: &quot;ç½‘ç»œæˆ–æ•°æ®è§£æžé”™è¯¯ï¼&quot;))&#125;&#125; åœ¨è¿™é‡Œæœ‰ä¸¤ä¸ªæœåŠ¡ç±»ï¼Œç¬¬ä¸€ä¸ªä¸ºéªŒè¯æœåŠ¡ç±»ï¼Œç”¨äºŽéªŒè¯ç”¨æˆ·å·ç æ ¼å¼ä»¥åŠå·ç æˆ–å¯†ç çš„é•¿åº¦æ˜¯å¦è¾¾åˆ°è¦æ±‚ï¼Œç¬¬äºŒä¸ªä¸ºç½‘ç»œè¯·æ±‚ç±»ï¼Œç”¨äºŽå‘åŽå°è¯·æ±‚ç™»å½•ï¼Œè¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼ŒRxMoyaProviderä¸€å®šè¦è¢«ç±»å¼•ç”¨ï¼Œå¦åˆ™è‹¥æŠŠå®ƒè®¾ç½®ä¸ºå±€éƒ¨å˜é‡ï¼Œè¯·æ±‚å°±ä¸èƒ½å®Œæˆã€‚åœ¨æž„å»ºRxMoyaProviderçš„æ—¶å€™ï¼Œæˆ‘åœ¨æž„é€ æ–¹æ³•ä¸­ä¼ å…¥äº†MoyaProvider.ImmediatelyStubè¿™ä¸ªstubClosureå‚æ•°ï¼Œä¸ºçš„æ˜¯æµ‹è¯•ï¼Œè¿™æ ·å­ç³»ç»Ÿå°±ä¸ä¼šè¯·æ±‚ç½‘ç»œï¼Œè€Œæ˜¯ç›´æŽ¥é€šè¿‡èŽ·å–Targetçš„sampleDataå±žæ€§ã€‚ .ViewModel è§†å›¾æ¨¡åž‹123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960import UIKitimport RxSwiftimport RxCocoaclass ViewModel &#123;// MARK: - Outputlet juhuaShow: Driver&lt;Bool&gt;let loginEnable: Driver&lt;Bool&gt;let tipString: Driver&lt;String&gt;init(input: (telNum: Driver&lt;String&gt;, password: Driver&lt;String&gt;, loginTap: Driver&lt;Void&gt;),dependency: (validateServer: ValidateServer, networkServer: NetworkServer)) &#123;let telNumValidate = input.telNum.distinctUntilChanged().map &#123; return dependency.validateServer.validateTelNum($0) &#125;let passwordValidate = input.password.distinctUntilChanged().map &#123; return dependency.validateServer.validatePassword($0) &#125;let validateString = [telNumValidate, passwordValidate].combineLatest &#123; result -&gt; String invar validateString = &quot;&quot;if case let .faild(message) = result[0] &#123;validateString = &quot;\(message)&quot;&#125;if case let .faild(message) = result[1] &#123;validateString = &quot;\(validateString) \(message)&quot;&#125;return validateString&#125;let telNumAndPassWord = Driver.combineLatest(input.telNum, input.password) &#123; ($0, $1) &#125;let loginString = input.loginTap.withLatestFrom(telNumAndPassWord).flatMapLatest &#123;return dependency.networkServer.loginWork($0.0, password: $0.1)&#125;.map &#123; result -&gt; String inswitch result &#123;case let .faild(message):return &quot;ç™»å½•å¤±è´¥ \(message)&quot;case let .succeed(user):return &quot;ç™»å½•æˆåŠŸï¼Œç”¨æˆ·å:\(user.name)ï¼Œæ ‡è¯†ç¬¦:\(user.userToken)&quot;&#125;&#125;self.loginEnable = [telNumValidate, passwordValidate].combineLatest &#123; result -&gt; Bool inreturn result[0] ^-^ result[1]&#125;self.juhuaShow = Driver.of(loginString.map&#123;_ in false&#125;, input.loginTap.map&#123;_ in true&#125;).merge()self.tipString = Driver.of(validateString, loginString).merge()&#125;&#125; ViewModelç›¸å¯¹æ¥è¯´æ¯”è¾ƒéš¾æžï¼Œæ¯•ç«Ÿæˆ‘ä»¬è¦å¤„ç†å¥½æ¯ä¸€ä¸ªè¾“å…¥è¾“å‡ºçš„å…³ç³»ï¼Œçµæ´»è¿›è¡Œè½¬å˜ã€‚åœ¨è¿™é‡Œï¼Œæ²¡æœ‰æ˜¾å¼çš„çŠ¶æ€å˜é‡ï¼Œåªæœ‰å¯¹å¤–çš„è¾“å‡ºä»¥åŠæž„é€ æ—¶å¯¹å†…çš„è¾“å…¥ï¼Œæ€æƒ³å°±æ˜¯å°†è¾“å…¥æµè¿›è¡ŒåŠ å·¥è½¬å˜æˆè¾“å‡ºæµï¼Œæ•°æ®åœ¨ä¼ è¾“ä¸­èƒ½å¤Ÿå•å‘ä¼ é€’ã€‚ .ViewController è§†å›¾æŽ§åˆ¶å™¨123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354import UIKitimport RxSwiftimport RxCocoaclass ViewController: UIViewController &#123;@IBOutlet weak var telNumTF: UITextField!@IBOutlet weak var passWordTF: UITextField!@IBOutlet weak var juhuaView: UIActivityIndicatorView!@IBOutlet weak var loginBtn: UIButton!@IBOutlet weak var tipLb: UILabel!private var viewModel: ViewModel?private var disposeBag = DisposeBag()override func viewDidLoad() &#123;super.viewDidLoad()self.viewModel = ViewModel(input: (self.telNumTF.rx_text.asDriver(),self.passWordTF.rx_text.asDriver(),self.loginBtn.rx_tap.asDriver()),dependency: (ValidateServer.shareInstance(),NetworkServer.shareInstace()))// Bindingself.viewModel!.juhuaShow.drive(self.juhuaView.rx_animating).addDisposableTo(self.disposeBag)self.viewModel!.loginEnable.drive(self.loginBtn.rx_loginEnable).addDisposableTo(self.disposeBag)self.viewModel!.tipString.drive(self.tipLb.rx_text).addDisposableTo(self.disposeBag)&#125;&#125;private extension UIButton &#123;var rx_loginEnable: AnyObserver&lt;Bool&gt; &#123;return UIBindingObserver(UIElement: self, binding: &#123; (button, bool) inself.enabled = boolif bool &#123;button.backgroundColor = UIColor.greenColor()&#125;else&#123;button.backgroundColor = UIColor.redColor()&#125;&#125;).asObserver()&#125;&#125; åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æž„å»ºå¥½ViewModelï¼Œå°†è¾“å…¥ä»¥åŠè§†å›¾æ¨¡åž‹ä¾èµ–çš„æœåŠ¡ä¼ å…¥ViewModelæž„é€ æ–¹æ³•ä¸­ï¼Œå¹¶åœ¨ä¸‹é¢æŠŠViewModelçš„è¾“å…¥åŽ»é©±åŠ¨UIè§†å›¾ã€‚ æºç åœ°å€]]></content>
      <categories>
        <category>swiftå­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>RxSwift</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[swift ä¹‹å¾ªçŽ¯è¯­å¥å’Œé—­åŒ…]]></title>
    <url>%2F2017%2F03%2F08%2Fswift-closure%2F</url>
    <content type="text"><![CDATA[swiftç®€ä»‹: è‹¹æžœäºŽ2014å¹´WWDCï¼ˆè‹¹æžœå¼€å‘è€…å¤§ä¼šï¼‰å‘å¸ƒçš„æ–°å¼€å‘è¯­è¨€ï¼Œå¯ä¸ŽObjective-Cå…±åŒè¿è¡ŒäºŽMac OSå’ŒiOSå¹³å°ï¼Œç”¨äºŽæ­å»ºåŸºäºŽè‹¹æžœå¹³å°çš„åº”ç”¨ç¨‹åºã€‚2015å¹´12æœˆ4æ—¥ï¼Œè‹¹æžœå…¬å¸å®£å¸ƒå…¶Swiftç¼–ç¨‹è¯­è¨€çŽ°åœ¨å¼€æ”¾æºä»£ç ã€‚ 1.æµç¨‹æŽ§åˆ¶swiftä½¿ç”¨ä¸‰ç§è¯­å¥æŽ§åˆ¶æµç¨‹ï¼šfor-inã€forã€switch-caseã€whileå’Œrepeat-whileï¼Œä¸”åˆ¤æ–­æ¡ä»¶çš„æ‹¬å·å¯ä»¥çœç•¥ for-in å¾ªçŽ¯ 12345678let names = [&quot;Jack&quot;, &quot;Rose&quot;, &quot;Mike&quot;, &quot;Puppy&quot;]for name in names &#123;print(&quot;Hello, \(name)!&quot;)&#125;//å¦‚æžœä¸éœ€è¦ä½¿ç”¨åˆ°è¿­ä»£çš„å€¼ï¼Œä½¿ç”¨ä¸‹åˆ’çº¿`_`å¿½ç•¥è¯¥å€¼for _ in 1...10print(&quot;hello&quot;) if è¯­å¥ åŽŸæ¥åœ¨ocä¸­,ifåŽçš„æ¡ä»¶è¯­å¥å¯ä»¥æ˜¯è¿™æ ·: 1234å‡è®¾judgeæ˜¯ä¸€ä¸ªBOOLåž‹æˆ–NSStringæˆ–NSArrayæˆ–NSDictionaryç­‰ç±»åž‹if (judge)&#123;//write code...&#125; ä½†åœ¨swiftä¸­,ifåŽçš„æ¡ä»¶è¿”å›žå€¼å¿…é¡»æ˜¯Boolåž‹,åœ¨å†™æˆä¸Šé¢çš„é‚£ç§æƒ…å½¢å°±ä¼šæŠ¥é”™â€¦. æ‰€ä»¥åœ¨swiftä¸­è¿™æ ·å†™: 123if judge == true &#123;//write code...&#125; åœ¨Swift2.0ä»¥åŽï¼Œä¸æ”¯æŒdo-whileè¯­å¥ï¼Œä½¿ç”¨repeat-whileä»£æ›¿ï¼Œç”¨æ³•ä¸Ždo-whileä¸€æ ·: 1234repeat &#123; print(&quot;repeat while : \(j)&quot;) j++ &#125; while j &lt; 3 guard-else ä¿é•–æ¨¡å¼ åœ¨æ‰§è¡Œæ“ä½œå‰ï¼Œè¿›è¡Œæ£€æŸ¥ï¼Œå¦‚æžœä¸ç¬¦åˆï¼Œåˆ™æ‹¦æˆªï¼Œä½¿ç”¨æ–¹å¼ä¸Žifæœ‰äº›ç±»ä¼¼ï¼Œå¦‚æžœä¸Žletç»“åˆä½¿ç”¨ï¼Œå¯ä»¥å¯¹å¯é€‰ç±»åž‹è§£åŒ…ï¼Œå…ˆçœ‹çœ‹æ™®é€šçš„if-elseæ¨¡å¼: 12345678func test(i: Int?) &#123;if let i = i where i &gt; 0 &#123;// ç¬¦åˆæ¡ä»¶çš„å¤„ç†return&#125;// ä¸ç¬¦åˆæ¡ä»¶çš„å¤„ç†&#125; ä¸Šé¢çš„å¤„ç†æŠŠæ¡ä»¶æ”¾åœ¨äº†æ¡ä»¶åˆ¤æ–­å†…éƒ¨ï¼Œä½¿ç”¨guardä¸Žä¹‹ç›¸åï¼ŒæŠŠæ­£ç¡®çš„æƒ…å†µæ”¾åœ¨æœ€å¤–éƒ¨ï¼Œè€Œå¼‚å¸¸æƒ…å†µæ”¾åœ¨æ¡ä»¶åˆ¤æ–­å†…éƒ¨: 123456789func test(i: Int?) &#123;guard let i = i where i &gt; 0 else &#123;// åœ¨è¿™é‡Œæ‹¦æˆªï¼Œå¤„ç†ä¸ç¬¦åˆæ¡ä»¶çš„æƒ…å†µreturn&#125;// ç¬¦åˆæ¡ä»¶çš„å¤„ç†ï¼Œè¿™ä¸ªæ—¶å€™å·²ç»å¯¹iè¿›è¡Œäº†æ‹†åŒ…ï¼Œiæ˜¯éžå¯é€‰ç±»åž‹ï¼Œå¯ä»¥ç›´æŽ¥ä½¿ç”¨print(i)&#125; ä¿é•–æ¨¡å¼å¯ä»¥é¿å…ä»£ç ä¸­è¿‡å¤šçš„æµç¨‹åˆ¤æ–­ä»£ç å¯¼è‡´è¿‡å¤šçš„ä»£ç å—åµŒå¥—ï¼Œå¢žå¼ºå¯è¯»æ€§!!! ä¿é•–æ¨¡å¼guard-elseå†…çš„ä»£ç å—å¿…é¡»åŒ…å«break, returnç­‰è·³å‡ºä»£ç å—çš„å…³é”®å­— switch-case swiftä¸­çš„switchè¯­å¥æœ€æ˜Žæ˜¾çš„åŒºåˆ«äºŽocçš„åœ°æ–¹åœ¨äºŽ,ä¸éœ€è¦break 2. å‡½æ•°(æ–¹æ³•)1.åŸºæœ¬å½¢å¼1234567891011121314151617///å•ä¸ªè¿”å›žå€¼func å‡½æ•°åç§°(å‚æ•°1: å‚æ•°1ç±»åž‹, å‚æ•°2: å‚æ•°2ç±»åž‹) -&gt; è¿”å›žå€¼ &#123;//å‡½æ•°ä½“&#125;///å¤šä¸ªè¿”å›žå€¼(å…ƒç»„)func å‡½æ•°åç§°(å‚æ•°1: å‚æ•°1ç±»åž‹, å‚æ•°2: å‚æ•°2ç±»åž‹) -&gt; (x: String, y: Int) &#123;//å‡½æ•°ä½“return (&quot;abc&quot;, 3)&#125;///æ— è¿”å›žå€¼func å‡½æ•°å &#123;&#125; è¿˜æœ‰ä¸€ç§ç›¸å½“äºŽocä¸­çš„åŠ å·æ–¹æ³•: 123class func å‡½æ•°å(å‚æ•°: å‚æ•°ç±»åž‹) -&gt; è¿”å›žå€¼ç±»åž‹ &#123;&#125; 2.é—­åŒ…1234///é—­åŒ…å‡½æ•°å£°æ˜Žå½¢å¼:&#123; (parameters) -&gt; returnType instatements // å¯ä»¥æœ‰å¤šè¡Œ&#125; é—­åŒ…å‡½æ•° 1234567891011121314151617181920//å®šä¹‰ä¸€ä¸ªå‡½æ•°å˜é‡var addfunc: (Int, Int) -&gt; Int//é—­åŒ…çš„å†™æ³•// 1. å®Œæ•´å†™æ³•addfunc = &#123;(a: Int, b: Int) -&gt; (Int) in//var c = a + 1 //å‡½æ•°ä½“å¯ä»¥æœ‰å¤šæ¡è¯­å¥ï¼Œå¦‚æžœåœ¨åŒä¸€è¡Œï¼Œéœ€è¦ç”¨åˆ†å·éš”å¼€ï¼Œå‡½æ•°ä½“ä¸éœ€è¦å¤§æ‹¬å·return a + b&#125;// 2. å‰é¢çš„addfuncå˜é‡å¯ä»¥æŽ¨æ–­å‡ºåŽé¢å‡½æ•°çš„å‚æ•°ç±»åž‹å’Œè¿”å›žå€¼ç±»åž‹ï¼Œæ•…å¯ä»¥çœç•¥addfunc = &#123;(a, b) in return a + b&#125;// 3. å‚æ•°åˆ—è¡¨æ‹¬å·å¯ä»¥çœåŽ»ï¼Œå‡½æ•°åªæœ‰ä¸€æ¡è¯­å¥æ—¶ï¼Œreturnå¯ä»¥çœç•¥addfunc = &#123;a, b in a + b&#125;// 4. å‚æ•°å’Œinå¯ä»¥çœåŽ»ï¼Œé€šè¿‡$å’Œç´¢å¼•å–å¾—å‚æ•°addfunc = &#123;$0 + $1&#125;// æ“ä½œç¬¦éœ€è¦çš„å‚æ•°ä¸Žå‡½æ•°å‚æ•°ä¸€è‡´ï¼Œå¯ä»¥çœåŽ»å‚æ•°ï¼Œå¹¶ä½¿ç”¨æ‹¬å·æ‹¬èµ·æ¥ï¼Œä½œä¸ºå‚æ•°æ—¶ï¼Œå¯ä¸ç”¨æ‹¬å·addfunc = (+) 3.Trailing(å°¾è¡Œ)é—­åŒ…å¦‚æžœå‡½æ•°ä½œä¸ºå¦ä¸€ä¸ªå‡½æ•°çš„å‚æ•°ï¼Œå¹¶ä¸”æ˜¯æœ€åŽä¸€ä¸ªå‚æ•°æ—¶ï¼Œå¯ä»¥é€šè¿‡Trainlingé—­åŒ…æ¥å¢žå¼ºå‡½æ•°çš„å¯è¯»æ€§ 123456789101112131415161718func someFunctionThatTakesAClosure(a: Int, closure: () -&gt; ()) &#123;// å‡½æ•°ä½“éƒ¨åˆ†&#125;// 1. ä¸€èˆ¬å½¢å¼someFunctionThatTakesAClosure(10, closure: &#123;// é—­åŒ…ä¸»ä½“éƒ¨åˆ†&#125;)// 2. Trainlingé—­åŒ…çš„æ–¹å¼someFunctionThatTakesAClosure(10) &#123;// é—­åŒ…ä¸»ä½“éƒ¨åˆ†&#125;// 3. å¦‚æžœæ²¡æœ‰å…¶ä»–å‚æ•°æ—¶ï¼Œå¯ä»¥çœç•¥æ‹¬å·someFunctionThatTakesAClosure &#123;// é—­åŒ…ä¸»ä½“éƒ¨åˆ†&#125; 4.Escapingï¼ˆé€ƒé€¸ï¼‰é—­åŒ…å¦‚æžœä¸€ä¸ªé—­åŒ…/å‡½æ•°ä½œä¸ºå‚æ•°ä¼ ç»™å¦å¤–ä¸€ä¸ªå‡½æ•°ï¼Œä½†è¿™ä¸ªé—­åŒ…åœ¨ä¼ å…¥å‡½æ•°è¿”å›žä¹‹åŽæ‰ä¼šæ‰§è¡Œï¼Œå°±ç§°è¯¥é—­åŒ…åœ¨å‡½æ•°ä¸­â€é€ƒé€¸â€ï¼Œéœ€è¦åœ¨å‡½æ•°å‚æ•°æ·»åŠ @escapingå£°æ˜Žï¼Œæ¥å£°æ˜Žè¯¥é—­åŒ…/å‡½æ•°å…è®¸ä»Žå‡½æ•°ä¸­â€é€ƒé€¸â€ï¼Œå¦‚ä¸‹: 123456var completionHandlers: [() -&gt; Void] = []// ä¼ å…¥çš„é—­åŒ…/å‡½æ•°å¹¶æ²¡æœ‰åœ¨å‡½æ•°å†…æ‰§è¡Œï¼Œéœ€è¦åœ¨å‡½æ•°ç±»åž‹é’±æ·»åŠ @escapingå£°æ˜Žfunc someFunctionWithEscapingClosure(completionHandler: @escaping () -&gt; Void) &#123;completionHandlers.append(completionHandler)&#125; é€ƒé€¸é—­åŒ…åªæ˜¯ä¸€ä¸ªå£°æ˜Žï¼Œä»¥å¢žå¼ºå‡½æ•°çš„æ„å›¾ 5.è‡ªåŠ¨é—­åŒ…å¯¹äºŽæ²¡æœ‰å‚æ•°çš„é—­åŒ…ï¼Œswiftæä¾›äº†ä¸€ç§ç®€å†™çš„æ–¹å¼ï¼Œç›´æŽ¥å†™å‡½æ•°ä½“ï¼Œä¸éœ€è¦å‡½æ•°å½¢å¼ï¼ˆè¿”å›žå€¼å’Œå‚æ•°åˆ—è¡¨ï¼‰ï¼Œå¦‚ä¸‹: 12345// å£°æ˜Žä¸€ä¸ªè‡ªåŠ¨é—­åŒ…ï¼ˆæ— å‚æ•°ï¼Œå¯ä»¥æœ‰è¿”å›žå€¼ï¼Œè¿”å›žå€¼ç±»åž‹swiftå¯ä»¥è‡ªåŠ¨è¯†åˆ«ï¼‰let sayHello = &#123; print(&quot;hello world&quot;) &#125;//è°ƒç”¨é—­åŒ…å‡½æ•°sayHello() è‡ªåŠ¨é—­åŒ…åªæ˜¯é—­åŒ…çš„ä¸€ç§ç®€å†™æ–¹å¼ å¦‚æžœä¸€ä¸ªå‡½æ•°æŽ¥å—ä¸€ä¸ªä¸å¸¦å‚æ•°çš„é—­åŒ…: 12345func logIfTrue(predicate: () -&gt; Bool) &#123;if predicate() &#123;print(&quot;True&quot;)&#125;&#125; è°ƒç”¨: 1234logIfTrue(predicate: &#123; return 1 &lt; 2 &#125;)// å¯ä»¥ç®€åŒ–returnlogIfTrue(predicate: &#123; 1 &lt; 2 &#125;) ä¸Šé¢ä»£ç çœ‹èµ·æ¥å¯è¯»æ€§ä¸æ˜¯å¾ˆå¥½ï¼Œswiftå¼•å…¥äº†ä¸€ä¸ªå…³é”®å­—@autoclosureï¼Œç®€åŒ–è‡ªåŠ¨é—­åŒ…çš„å¤§æ‹¬å·ï¼Œåœ¨é—­åŒ…ç±»åž‹å‰é¢æ·»åŠ è¯¥å…³é”®å­—å£°æ˜Ž: 12345678func logIfTrue(predicate: @autoclosure () -&gt; Bool) &#123;if predicate() &#123;print(&quot;True&quot;)&#125;&#125;// è°ƒç”¨logIfTrue(predicate:1 &lt; 2) @autoclosure å…³é”®å­—æ˜¯ä¸ºäº†ç®€åŒ–é—­åŒ…çš„å†™æ³•ï¼Œå¢žå¼ºå¯è¯»æ€§ï¼Œè¿™é‡Œçš„ä¾‹å­æ¯”è¾ƒç®€å•ï¼Œå¯ä»¥å‚è€ƒï¼šäº†è§£æ›´å¤šç‚¹å‡»è¿™é‡Œ]]></content>
      <categories>
        <category>swiftå­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>closure</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[iOSä¹‹WiFiç›¸å…³åŠŸèƒ½æ€»ç»“]]></title>
    <url>%2F2017%2F03%2F08%2FWiFi%2F</url>
    <content type="text"><![CDATA[iOS å¼€å‘ä¸­éš¾å…ä¼šé‡åˆ°å¾ˆå¤šä¸Žç½‘ç»œæ–¹é¢çš„åˆ¤æ–­ï¼Œè¿™é‡Œåšä¸ªæ±‡æ€»ï¼Œå¤§å¤šå¯èƒ½æ˜¯ä¸ŽWiFiç›¸å…³çš„ã€‚ 1.PingåŸŸåã€PingæŸIPæœ‰æ—¶å€™å¯èƒ½ä¼šé‡åˆ°ping æŸä¸ªåŸŸåæˆ–è€…ipé€šä¸é€šï¼Œå†åšä¸‹ä¸€æ­¥æ“ä½œã€‚è¿™é‡Œçš„pingä¸Žä¼ ç»Ÿçš„åšgetæˆ–è€…postè¯·æ±‚è¿˜æ˜¯æœ‰å¾ˆå¤§åŒºåˆ«çš„ã€‚æ¯”å¦‚æˆ‘ä»¬è¿žæŽ¥äº†æŸä¸ªWiFiï¼Œæµ‹è¯•ping www.baidu.comï¼Œå¦‚æžœèƒ½ping é€šï¼ŒåŸºæœ¬å¯ä»¥æ–­å®šå¯ä»¥ä¸Šç½‘äº†ï¼Œä½†æ˜¯å¦‚æžœæˆ‘ä»¬åšäº†ä¸€ä¸ªget è¯·æ±‚ï¼ˆurl æ˜¯www.baidu.comï¼‰,è·¯ç”±å™¨å¯èƒ½é‡å®šå‘è¿™ä¸ªWiFiå†…çš„æŸç½‘é¡µäº†ï¼Œä¾ç„¶æ²¡æœ‰é”™è¯¯è¿”å›žï¼Œå°±ä¼šè¯¯è®¤ä¸ºå¯ä»¥æ­£å¸¸ä¸Šç½‘ã€‚ è¿™é‡Œæœ‰å…³äºŽpingå‘½ä»¤çš„è¯¦ç»†è§£é‡Šï¼šç™¾åº¦ç™¾ç§‘ping iOSä¸­æƒ³è¦pingåŸŸåæˆ–è€…ipï¼Œè‹¹æžœæä¾›äº†ä¸€ä¸ªå®˜æ–¹ä¾‹å­:SimplePing åœ¨ä¾‹å­ä¸­ï¼Œæœ‰ä¸€ä¸ªè‹¹æžœå·²ç»å°è£…è¿‡çš„ç±»ã€SimplePing.hã€‘å’Œã€SimplePing.mã€‘ ä½¿ç”¨èµ·æ¥ä¹Ÿç›¸å½“çš„ç®€å•ï¼š a.é¦–å…ˆåˆ›å»ºä¸€ä¸ªPingå¯¹è±¡ï¼š123456789SimplePing *pinger = [[SimplePing alloc] initWithHostName:self.hostName];self.pinger = pinger;pinger.delegate = self;pinger.addressStyle = SimplePingAddressStyleICMPv4;[pinger start]; b.ç„¶åŽåœ¨startæˆåŠŸçš„ä»£ç†æ–¹æ³•ä¸­ï¼Œå‘é€æ•°æ®æŠ¥æ–‡ï¼š1234567891011121314/*** startæˆåŠŸï¼Œä¹Ÿå°±æ˜¯å‡†å¤‡å·¥ä½œåšå®ŒåŽçš„å›žè°ƒ*/- (void)simplePing:(SimplePing *)pinger didStartWithAddress:(NSData *)address&#123;// å‘é€æµ‹è¯•æŠ¥æ–‡æ•°æ®[self.pinger sendPingWithData:nil];&#125;- (void)simplePing:(SimplePing *)pinger didFailWithError:(NSError *)error&#123;NSLog(@&quot;didFailWithError&quot;);[self.pinger stop];&#125; c.å…¶ä»–å‡ ä¸ªä»£ç†æ–¹æ³•ä¹Ÿéžå¸¸ç®€å•ï¼Œå°±ç®€å•è®°å½•ä¸€ä¸‹:12345678910111213141516171819202122// å‘é€æµ‹è¯•æŠ¥æ–‡æˆåŠŸçš„å›žè°ƒæ–¹æ³•- (void)simplePing:(SimplePing *)pinger didSendPacket:(NSData *)packet sequenceNumber:(uint16_t)sequenceNumber&#123;NSLog(@&quot;#%u sent&quot;, sequenceNumber);&#125;//å‘é€æµ‹è¯•æŠ¥æ–‡å¤±è´¥çš„å›žè°ƒæ–¹æ³•- (void)simplePing:(SimplePing *)pinger didFailToSendPacket:(NSData *)packet sequenceNumber:(uint16_t)sequenceNumber error:(NSError *)error&#123;NSLog(@&quot;#%u send failed: %@&quot;, sequenceNumber, error);&#125;// æŽ¥æ”¶åˆ°pingçš„åœ°å€æ‰€è¿”å›žçš„æ•°æ®æŠ¥æ–‡å›žè°ƒæ–¹æ³•- (void)simplePing:(SimplePing *)pinger didReceivePingResponsePacket:(NSData *)packet sequenceNumber:(uint16_t)sequenceNumber&#123;NSLog(@&quot;#%u received, size=%zu&quot;, sequenceNumber, packet.length);&#125;- (void)simplePing:(SimplePing *)pinger didReceiveUnexpectedPacket:(NSData *)packet&#123;NSLog(@&quot;#%s&quot;,__func__);&#125; *æ³¨æ„ç‚¹ï¼šiOS ä¸­ pingå¤±è´¥åŽï¼ˆå³å‘é€æµ‹è¯•æŠ¥æ–‡æˆåŠŸåŽï¼Œä¸€ç›´æ²¡åŽæ”¶åˆ°å“åº”çš„æŠ¥æ–‡ï¼‰,ä¸ä¼šæœ‰ä»»ä½•å›žè°ƒæ–¹æ³•å‘ŠçŸ¥æˆ‘ä»¬ã€‚è€Œä¸€èˆ¬ping ä¸€æ¬¡çš„ç»“æžœä¹Ÿä¸å¤ªå‡†ç¡®ï¼Œping èŠ±è´¹çš„æ—¶é—´ä¹Ÿéžå¸¸çŸ­ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬ä¼špingå¤šæ¬¡ï¼Œå‘é€ä¸€æ¬¡ping æµ‹è¯•æŠ¥æ–‡0.5såŽæ£€æµ‹ä¸€ä¸‹è¿™ä¸€æ¬¡pingæ˜¯å¦å·²ç»æ”¶åˆ°å“åº”ã€‚0.5såŽæ£€æµ‹æ—¶ï¼Œå¦‚æžœå·²ç»æ”¶åˆ°å“åº”ï¼Œåˆ™å¯ä»¥ping é€šï¼›å¦‚æžœæ²¡æœ‰æ”¶åˆ°å“åº”ï¼Œåˆ™è§†ä¸ºè¶…æ—¶ã€‚ åšæ³•ä¹Ÿæœ‰å¾ˆå¤šç§ï¼Œå¯ä»¥ç”¨NSTimeræˆ–è€… {- (void)performSelector: withObject:afterDelay:} è¿™é‡Œæœ‰ä¸€ä¸ªåˆ«äººå†™çš„å·¥ç¨‹ï¼šhttps://github.com/lovesunstar/STPingTest 2.èŽ·å–WiFiä¿¡æ¯ä»¥å‰ç‰©è”ç½‘åˆšç«çš„æ—¶å€™ï¼Œå‡ºçŽ°è¿‡å¾ˆå¤šä¸€ä½“å¼æ— çº¿è·¯ç”±ï¼Œæ‰€ä»¥Appé‡Œéš¾å…ä¼šé‡åˆ°è¦åˆ¤æ–­å½“å‰æ‰€è¿žæŽ¥çš„WiFiï¼Œä»¥åŠèŽ·å–WiFiä¿¡æ¯çš„åŠŸèƒ½ã€‚ éœ€è¦å¯¼å…¥import SystemConfiguration.CaptiveNetwork 123456789101112131415161718192021222324252627282930313233343536//èŽ·å–WiFi ä¿¡æ¯ï¼Œè¿”å›žçš„å­—å…¸ä¸­åŒ…å«äº†WiFiçš„åç§°ã€è·¯ç”±å™¨çš„Macåœ°å€ã€è¿˜æœ‰ä¸€ä¸ªData(è½¬æ¢æˆå­—ç¬¦ä¸²æ‰“å°å‡ºæ¥æ˜¯wifiåç§°)- (NSDictionary *)fetchSSIDInfo &#123;NSArray *ifs = (__bridge_transfer NSArray *)CNCopySupportedInterfaces();if (!ifs) &#123;return nil;&#125;NSDictionary *info = nil;for (NSString *ifnam in ifs) &#123;info = (__bridge_transfer NSDictionary *)CNCopyCurrentNetworkInfo((__bridge CFStringRef)ifnam);if (info &amp;&amp; [info count]) &#123; break; &#125;&#125;return info;&#125;//æ‰“å°å‡ºæ¥çš„ç»“æžœï¼š2017-03-02 15:28:51.674 SimplePing[18883:6790207] WIFI_INFO:&#123;BSSID = &quot;a4:2b:8c:c:7f:bd&quot;;SSID = bdmy06;SSIDDATA = ;&#125; 3.èŽ·å–WiFiåç§°æœ‰äº†ä¸Šä¸€æ­¥ï¼ŒèŽ·å–WiFiåç§°å°±éžå¸¸ç®€å•äº†ã€‚ 123456NSString *WiFiName = info[@&quot;SSID&quot;];//æ‰“å°ç»“æžœï¼š2017-03-02 15:35:13.059 SimplePing[18887:6791418] bdmy06 å®Œæ•´çš„ï¼š 1234567891011121314151617181920212223242526272829303132333435- (NSString *)fetchWiFiName &#123;NSArray *ifs = (__bridge_transfer NSArray *)CNCopySupportedInterfaces();if (!ifs) &#123;return nil;&#125;NSString *WiFiName = nil;for (NSString *ifnam in ifs) &#123;NSDictionary *info = (__bridge_transfer NSDictionary *)CNCopyCurrentNetworkInfo((__bridge CFStringRef)ifnam);if (info &amp;&amp; [info count]) &#123;// è¿™é‡Œå…¶å®žå¯¹åº”çš„æœ‰ä¸‰ä¸ªkey:kCNNetworkInfoKeySSIDã€kCNNetworkInfoKeyBSSIDã€kCNNetworkInfoKeySSIDDataï¼Œ// ä¸è¿‡å®ƒä»¬éƒ½æ˜¯CFStringRefç±»åž‹çš„WiFiName = [info objectForKey:(__bridge NSString *)kCNNetworkInfoKeySSID];// WiFiName = [info objectForKey:@&quot;SSID&quot;];break;&#125;&#125;return WiFiName;&#125; 4.èŽ·å–å½“å‰æ‰€è¿žæŽ¥WiFiçš„ç½‘å…³åœ°å€12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091- (NSString *)getGatewayIpForCurrentWiFi &#123;NSString *address = @&quot;error&quot;;struct ifaddrs *interfaces = NULL;struct ifaddrs *temp_addr = NULL;int success = 0;// retrieve the current interfaces - returns 0 on successsuccess = getifaddrs(&amp;interfaces);if (success == 0) &#123;// Loop through linked list of interfacestemp_addr = interfaces;//*/while(temp_addr != NULL) &#123;/*/int i=255;while((i--)&gt;0)//*/if(temp_addr-&gt;ifa_addr-&gt;sa_family == AF_INET) &#123;// Check if interface is en0 which is the wifi connection on the iPhoneif([[NSString stringWithUTF8String:temp_addr-&gt;ifa_name] isEqualToString:@&quot;en0&quot;])&#123;// Get NSString from C String //ifa_addr//ifa-&gt;ifa_dstaddr is the broadcast address, which explains the &quot;255&apos;s&quot;// address = [NSString stringWithUTF8String:inet_ntoa(((struct sockaddr_in *)temp_addr-&gt;ifa_dstaddr)-&gt;sin_addr)];address = [NSString stringWithUTF8String:inet_ntoa(((struct sockaddr_in *)temp_addr-&gt;ifa_addr)-&gt;sin_addr)];//routerIP----192.168.1.255 å¹¿æ’­åœ°å€NSLog(@&quot;broadcast address--%@&quot;,[NSString stringWithUTF8String:inet_ntoa(((struct sockaddr_in *)temp_addr-&gt;ifa_dstaddr)-&gt;sin_addr)]);//--192.168.1.106 æœ¬æœºåœ°å€NSLog(@&quot;local device ip--%@&quot;,[NSString stringWithUTF8String:inet_ntoa(((struct sockaddr_in *)temp_addr-&gt;ifa_addr)-&gt;sin_addr)]);//--255.255.255.0 å­ç½‘æŽ©ç åœ°å€NSLog(@&quot;netmask--%@&quot;,[NSString stringWithUTF8String:inet_ntoa(((struct sockaddr_in *)temp_addr-&gt;ifa_netmask)-&gt;sin_addr)]);//--en0 ç«¯å£åœ°å€NSLog(@&quot;interface--%@&quot;,[NSString stringWithUTF8String:temp_addr-&gt;ifa_name]);&#125;&#125;temp_addr = temp_addr-&gt;ifa_next;&#125;&#125;// Free memoryfreeifaddrs(interfaces);in_addr_t i = inet_addr([address cStringUsingEncoding:NSUTF8StringEncoding]);in_addr_t* x = &amp;i;unsigned char *s = getdefaultgateway(x);NSString *ip=[NSString stringWithFormat:@&quot;%d.%d.%d.%d&quot;,s[0],s[1],s[2],s[3]];free(s);return ip;&#125; 5.èŽ·å–æœ¬æœºåœ¨WiFiçŽ¯å¢ƒä¸‹çš„IPåœ°å€12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849- (NSString *)getLocalIPAddressForCurrentWiFi&#123;NSString *address = nil;struct ifaddrs *interfaces = NULL;struct ifaddrs *temp_addr = NULL;int success = 0;// retrieve the current interfaces - returns 0 on successsuccess = getifaddrs(&amp;interfaces);if (success == 0) &#123;// Loop through linked list of interfacestemp_addr = interfaces;while(temp_addr != NULL) &#123;if(temp_addr-&gt;ifa_addr-&gt;sa_family == AF_INET) &#123;// Check if interface is en0 which is the wifi connection on the iPhoneif([[NSString stringWithUTF8String:temp_addr-&gt;ifa_name] isEqualToString:@&quot;en0&quot;]) &#123;address = [NSString stringWithUTF8String:inet_ntoa(((struct sockaddr_in *)temp_addr-&gt;ifa_addr)-&gt;sin_addr)];return address;&#125;&#125;temp_addr = temp_addr-&gt;ifa_next;&#125;freeifaddrs(interfaces);&#125;return nil;&#125; 6.èŽ·å–å¹¿æ’­åœ°å€ã€å­ç½‘æŽ©ç ã€ç«¯å£ç­‰12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697- (NSMutableDictionary *)getLocalInfoForCurrentWiFi &#123;NSMutableDictionary *dict = [NSMutableDictionary dictionary];struct ifaddrs *interfaces = NULL;struct ifaddrs *temp_addr = NULL;int success = 0;// retrieve the current interfaces - returns 0 on successsuccess = getifaddrs(&amp;interfaces);if (success == 0) &#123;// Loop through linked list of interfacestemp_addr = interfaces;//*/while(temp_addr != NULL) &#123;if(temp_addr-&gt;ifa_addr-&gt;sa_family == AF_INET) &#123;// Check if interface is en0 which is the wifi connection on the iPhoneif([[NSString stringWithUTF8String:temp_addr-&gt;ifa_name] isEqualToString:@&quot;en0&quot;]) &#123;//----192.168.1.255 å¹¿æ’­åœ°å€NSString *broadcast = [NSString stringWithUTF8String:inet_ntoa(((struct sockaddr_in *)temp_addr-&gt;ifa_dstaddr)-&gt;sin_addr)];if (broadcast) &#123;[dict setObject:broadcast forKey:@&quot;broadcast&quot;];&#125;NSLog(@&quot;broadcast address--%@&quot;,broadcast);//--192.168.1.106 æœ¬æœºåœ°å€NSString *localIp = [NSString stringWithUTF8String:inet_ntoa(((struct sockaddr_in *)temp_addr-&gt;ifa_addr)-&gt;sin_addr)];if (localIp) &#123;[dict setObject:localIp forKey:@&quot;localIp&quot;];&#125;NSLog(@&quot;local device ip--%@&quot;,localIp);//--255.255.255.0 å­ç½‘æŽ©ç åœ°å€NSString *netmask = [NSString stringWithUTF8String:inet_ntoa(((struct sockaddr_in *)temp_addr-&gt;ifa_netmask)-&gt;sin_addr)];if (netmask) &#123;[dict setObject:netmask forKey:@&quot;netmask&quot;];&#125;NSLog(@&quot;netmask--%@&quot;,netmask);//--en0 ç«¯å£åœ°å€NSString *interface = [NSString stringWithUTF8String:temp_addr-&gt;ifa_name];if (interface) &#123;[dict setObject:interface forKey:@&quot;interface&quot;];&#125;NSLog(@&quot;interface--%@&quot;,interface);return dict;&#125;&#125;temp_addr = temp_addr-&gt;ifa_next;&#125;&#125;// Free memoryfreeifaddrs(interfaces);return dict;&#125; æ‰“å°ç»“æžœï¼š 12345678910112017-03-02 17:59:09.257 SimplePing[19141:6830567] wifi:&#123;broadcast = &quot;192.168.1.255&quot;;interface = en0;localIp = &quot;192.168.1.7&quot;;netmask = &quot;255.255.255.0&quot;;&#125;]]></content>
      <categories>
        <category>iOS ç½‘ç»œç›¸å…³</category>
      </categories>
      <tags>
        <tag>WiFi</tag>
      </tags>
  </entry>
</search>
